(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03d9e3ec"],{"184b":function(t,e,a){},3469:function(t,e,a){"use strict";a("4de4"),a("e9f5"),a("910d"),a("d3b7");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-filter-client"},[e("ul",[e("li",{staticClass:"u-client",class:{on:""==t.version},on:{click:function(e){return t.filter("")}}},[t._v(" 双端 ")]),t._l(t.versions,(function(a,i){return e("li",{key:i,staticClass:"u-client",class:{on:t.version==i},on:{click:function(e){return t.filter(i)}}},[t._v(t._s(a))])}))],2)])},n=[],s={name:"versionBy",props:["value"],data:function(){return{version:this.value||""}},computed:{versions:function(){var t={0:"旗舰",1:"无界"};return t}},methods:{filter:function(t){this.version=t,this.$emit("filter",{type:"version",val:t}),this.$forceUpdate()}}},r=s,o=(a("a475"),a("2877")),l=Object(o["a"])(r,i,n,!1,null,null,null);e["a"]=l.exports},6300:function(t,e,a){"use strict";a("184b")},"6afb":function(t,e,a){},a475:function(t,e,a){"use strict";a("6afb")},c363:function(t,e,a){"use strict";a.r(e);a("ac1f"),a("841c"),a("498a");var i=function(){var t=this,e=t._self._c;return e("ListLayout",[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-archive-box"},[e("div",{staticClass:"m-archive-search",attrs:{slot:"search-before"},slot:"search-before"},[e("a",{staticClass:"u-publish el-button el-button--primary",attrs:{href:t.publish_link}},[t._v("+ 发布作品")]),e("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:t.onSearch},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[e("template",{slot:"prepend"},[e("i",{staticClass:"el-icon-search"}),t._v(" "),e("span",{staticClass:"u-search"},[t._v("关键词")])]),e("el-button",{staticClass:"u-btn",attrs:{slot:"append",icon:"el-icon-position"},on:{click:t.onSearch},slot:"append"})],2)],1),e("div",{staticClass:"m-archive-filter"},[e("div",{staticClass:"m-filter--left"},[e("clientBy",{attrs:{type:t.client,showWujie:!1},on:{filter:t.filterImperceptibly}}),e("markBy",{attrs:{marks:t.pv_types,type:"tag",placeholder:"类型"},on:{filter:t.filterMeta}}),e("markBy",{on:{filter:t.filterMeta}}),e("zlpBy",{attrs:{type:"zlp",client:t.client},on:{filter:t.filterMeta}}),e("topicBy",{attrs:{topics:t.topics},model:{value:t.topic,callback:function(e){t.topic=e},expression:"topic"}}),"std"==t.client?e("versionBy",{staticStyle:{"margin-left":"10px"},attrs:{value:t.is_wujie},on:{filter:t.filterIsWujie}}):t._e()],1),e("div",{staticClass:"m-filter--right"},[e("orderBy",{on:{filter:t.filterMeta}})],1)]),t.data&&t.data.length?e("div",{staticClass:"m-archive-list"},[e("ul",{staticClass:"u-list"},[t.isMiniprogram?t._l(t.data,(function(a){return e("list-item-miniprogram",{key:a.ID,attrs:{item:a,order:t.order,caller:"bps_index_click"}})})):t._l(t.data,(function(a){return e("list-item",{key:a.ID,attrs:{item:a,order:t.order,caller:"bps_index_click"}})}))],2)]):e("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasNextPage,expression:"hasNextPage"}],staticClass:"m-archive-more",attrs:{type:"primary",loading:t.loading,icon:"el-icon-arrow-down"},on:{click:t.appendPage}},[t._v("加载更多")]),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next, jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}})],1),e("design-task",{attrs:{post:t.currentPost},model:{value:t.showDesignTask,callback:function(e){t.showDesignTask=e},expression:"showDesignTask"}})],1)},n=[],s=a("ade3"),r=a("c7eb"),o=a("1da1"),l=a("2909"),c=(a("99af"),a("7db0"),a("caad"),a("a15b"),a("d81d"),a("14d9"),a("b0c0"),a("e9f5"),a("f665"),a("ab43"),a("b64b"),a("d3b7"),a("2c3e"),a("6062"),a("1e70"),a("79a4"),a("c1a1"),a("8b00"),a("a4e7"),a("1e5a"),a("72c3"),a("2532"),a("3ca3"),a("ddb0"),a("6a2f")),u=a("6472"),p=a("d4a7"),d=a("c9d2"),h=a("d8ad"),f=a("85e4"),g=a("d8e4"),v=a("24bf"),m=a("16e5"),b=a("41cb"),y=function(t){return Object(b["a"])().get("/api/cms/design/task/log",{params:t})},k=a("7d14"),_=a("3469"),w="bps",j={name:"Index",props:[],data:function(){return{loading:!1,data:[],page:1,per:10,total:1,pages:1,number_queries:["per","page"],subtype:"",order:"update",mark:"",client:this.$store.state.client,search:"",zlp:"",tag:"",topic:"",is_wujie:"",pv_types:{PVE:"PVE",PVP:"PVP"},currentPost:null,showDesignTask:!1,stdClient:"std",isMiniprogram:!1}},computed:{publish_link:function(){return Object(f["r"])(w)},hasNextPage:function(){return this.pages>1&&this.page<this.total},query:function(){var t={subtype:this.subtype,order:this.order,mark:this.mark,client:this.client,zlp:this.zlp,tag:this.tag,topic:this.topic,is_wujie:this.is_wujie};return t},pg_queries:function(){return{page:this.page,per:this.per}},reset_queries:function(){return[this.subtype]},topics:function(t){var e=t.tag;return"PVE"===e?v["bps_pve"]:"PVP"===e?v["bps_pvp"]:Object(l["a"])(new Set([].concat(Object(l["a"])(v["bps_pve"]),Object(l["a"])(v["bps_pvp"]))))},isPhone:function(){return window.innerWidth<768}},methods:{reporterLink:function(t){var e="std"===this.client?"www":"origin";return"".concat(e,":/").concat(w,"/")+t},onSearch:function(){1===this.page?this.loadData():this.page=1},buildQuery:function(t){t&&(this.page+=1,this.replaceRoute({page:this.page},!1));var e={per:this.per,page:this.page};for(var a in this.query)void 0!==this.query[a]&&""!==this.query[a]&&null!==this.query[a]&&("search"==a?e.search=this.query.search.trim():e[a]=this.query[a]);return e.subtype&&(e.sticky=1),this.search&&(e.search=this.search.trim()),e},loadData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.buildQuery(e);return console.log("[cms-list]","<loading data>",a),this.loading=!0,Object(g["e"])(a).then(function(){var a=Object(o["a"])(Object(r["a"])().mark((function a(i){var n,s,o,l,c,u,p,h,f,g,v,b;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.data=e?t.data.concat(null===(p=i.data)||void 0===p||null===(h=p.data)||void 0===h?void 0:h.list):null===(f=i.data)||void 0===f||null===(g=f.data)||void 0===g?void 0:g.list,t.total=null===(n=i.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.total,t.pages=null===(o=i.data)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.pages,Object(m["b"])({caller:"bps_index_load",data:{aggregate:null===(c=i.data)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.list.map((function(e){return t.reporterLink(e.ID)}))}}),!d["a"].hasPermission("push_banner")||t.isPhone){a.next=10;break}return v=t.data.map((function(t){return t.ID})),a.next=8,y({source_type:"bps",ids:v.join(",")}).then((function(t){return t.data.data}));case 8:b=a.sent,t.data=t.data.map((function(e){var a=b.find((function(t){return t.source_id==e.ID}))||null;return t.$set(e,"log",a),e}));case 10:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()).finally((function(){t.loading=!1}))},replaceRoute:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.$router.push({name:this.$route.name,query:Object.assign({},this.$route.query,t)}).then((function(){e&&window.scrollTo(0,0)})).catch((function(t){}))},filterMeta:function(t){this.replaceRoute(Object(s["a"])(Object(s["a"])({},t["type"],t["val"]),"page",1))},filterIsWujie:function(t){var e=t["val"];this.is_wujie=e},filterImperceptibly:function(t){this[t["type"]]=t["val"]},changePage:function(t){this.loadData(),this.replaceRoute({page:t})},appendPage:function(){this.loadData(!0)},onTagInput:function(t){this.tag=t,this.replaceRoute({tag:t,page:1})}},watch:{"$route.query":{deep:!0,immediate:!0,handler:function(t){if(Object.keys(t).length)for(var e in console.log("[cms-list]","<route query change>",t),t)this.number_queries.includes(e)?this[e]=~~t[e]:this[e]=t[e]}},reset_queries:{deep:!0,handler:function(){console.log("[cms-list]","<reset page>"),this.page=1}},query:{deep:!0,immediate:!0,handler:function(t){console.log("[cms-list]","<request query change>",t),this.loadData()}},is_wujie:function(){this.page=1,this.replaceRoute({page:1})}},mounted:function(){var t,e=this;h["a"].on("design-task",(function(t){e.currentPost=t,e.showDesignTask=!0})),this.isMiniprogram=(null===(t=document.getElementsByClassName("v-miniprogram"))||void 0===t?void 0:t.length)>0},components:{listItem:u["a"],ListLayout:c["a"],DesignTask:k["a"],versionBy:_["a"],listItemMiniprogram:p["a"]}},P=j,x=(a("6300"),a("2877")),C=Object(x["a"])(P,i,n,!1,null,null,null);e["default"]=C.exports}}]);