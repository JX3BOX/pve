(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ee41f20"],{"33a5":function(t){t.exports=JSON.parse('{"0":"江湖","1":"天策","2":"万花","3":"纯阳","4":"七秀","5":"少林","6":"藏剑","7":"丐帮","8":"明教","9":"五毒","10":"唐门","18":"苍云","19":"长歌","20":"霸刀","21":"蓬莱","22":"凌雪","23":"衍天","24":"药宗","26":"刀宗","29":"万灵","38":"段氏"}')},"51a0":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-fb-drop"},[e("el-tabs",{attrs:{type:"card"},model:{value:t.mapid,callback:function(e){t.mapid=e},expression:"mapid"}},t._l(t.maplist,(function(i,n){return e("el-tab-pane",{key:n,attrs:{label:i.mode,name:i.map_id}},[e("div",{staticClass:"u-bosslist"},t._l(t.bosslist,(function(i,n){return e("div",{key:n,staticClass:"u-boss",class:{on:i.BOSS==t.boss},on:{click:function(e){return t.changeBoss(i.BOSS)}}},[e("svg",{class:"u-boss-avatar",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"833.7",height:"833.7",viewBox:"0 0 833.7 833.7","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M416.8 0C208.5.1 39.6 169 39.6 377.399V555.2c0 9.399 4.4 18.199 11.9 23.899L213.7 702.2v101.5c0 16.6 13.4 30 30 30h24.1c16.6 0 30-13.4 30-30v-41.2c0-10.5 8.5-19 19-19s19 8.5 19 19v41.2c0 16.6 13.4 30 30 30h1c16.6 0 30-13.4 30-30v-41.2c0-10.5 8.5-19 19-19h2c10.5 0 19 8.5 19 19v41.2c0 16.6 13.4 30 30 30h1c16.6 0 30-13.4 30-30v-41.2c0-10.5 8.5-19 19-19s19 8.5 19 19v41.2c0 16.6 13.4 30 30 30H590c16.6 0 30-13.4 30-30V702.1L782.2 579c7.5-5.7 11.899-14.5 11.899-23.9V377.3C794 169 625.1.1 416.8 0zM259.1 558.1c-57.4 0-104-46.6-104-104 0-57.399 46.6-104 104-104s104 46.601 104 104c0 57.5-46.6 104-104 104zm187.3 76.5h-59.1c-13.7 0-22.4-14.7-15.8-26.7l29.6-53.699c6.8-12.4 24.7-12.4 31.5 0l29.601 53.699c6.5 11.999-2.201 26.7-15.801 26.7zm128.1-76.5c-57.4 0-104-46.6-104-104 0-57.399 46.6-104 104-104 57.399 0 104 46.601 104 104 0 57.5-46.5 104-104 104z"}})]),t._v(" "+t._s(i.BOSS)+" ")])})),0),e("div",{staticClass:"u-schools"},t._l(t.schoolmap,(function(i,n){return e("div",{key:n,staticClass:"u-school",class:{active:n==t.school},on:{click:function(e){return t.filterBySchool(n)}}},[e("img",{staticClass:"u-school-icon",attrs:{src:t._f("showSchoolIcon")(n),alt:i}}),e("span",{staticClass:"u-school-name"},[t._v(t._s(~~n?i:"全部"))])])})),0),e("div",{staticClass:"u-droplist"},[e("div",{staticClass:"u-tabs"},[e("el-tabs",{staticClass:"u-group",attrs:{"tab-position":"left"},model:{value:t.droptype,callback:function(e){t.droptype=e},expression:"droptype"}},[e("el-tab-pane",{attrs:{label:"全部",name:""}}),t._l(t.dropmap,(function(t,i){return e("el-tab-pane",{key:i,attrs:{label:t,name:i}})}))],2)],1),t.droplist&&t.droplist.length?e("div",{staticClass:"u-drops"},t._l(t.droplist,(function(i){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isVisible(i),expression:"isVisible(drop)"}],key:i.id,staticClass:"u-item-wrapper"},[e("el-popover",{attrs:{placement:"right-end","popper-class":"u-drop-popup",width:"auto","visible-arrow":!1,trigger:"hover",transition:"none","close-delay":0}},[e("a",{staticClass:"u-item",attrs:{slot:"reference",href:t.getDropLink(i),target:"_blank"},on:{mouseenter:function(e){return t.viewDrop(i)}},slot:"reference"},[e("i",{staticClass:"u-drop-item-icon u-item-icon",class:"u-item-color-"+i.ItemQuality},[e("img",{attrs:{src:t.iconLink(i.ItemIconID)}})]),e("span",{staticClass:"u-item-name"},[t._v(t._s(i.ItemName))])]),t.focus==i.ItemID?e("jx3-item",{attrs:{item_id:i.jx3_item_id,"jx3-client-type":t.client_id}}):t._e()],1)],1)})),0):e("el-alert",{attrs:{title:"没有相关条目",type:"info","show-icon":""}})],1)])})),1)],1)},s=[],o=i("c7eb"),a=i("b85c"),r=i("1da1"),c=(i("99af"),i("caad"),i("d81d"),i("e9f5"),i("ab43"),i("e9c4"),i("d3b7"),i("2532"),i("41cb")),l=Object(c["e"])();function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"std";return l.get("/fb/boss",{params:{MapID:t,client:e}})}function d(t,e){return l.get("/fb/drop/v2/".concat(t),{params:e})}function p(t,e,i){return l.post("/resource/".concat(e,"/").concat(t),i)}var h=i("65c2"),f=i("c544"),m=i("85e4"),v=i("33a5"),b=i("c7fa"),y={name:"DropV2",props:[],data:function(){return{mapid:"",bosslist:[],boss:"",dropmap:f,droplist:[],droptype:"",focus:"",data:{},loading:!1,school:"0",schoolmap:v}},computed:{fb:function(){return this.$route.query.fb_name||this.$store.state.default_fb},dungeons:function(){return this.$store.getters.dungeons},client:function(){return this.$store.state.client||"std"},maplist:function(){var t,e;return null===(t=this.dungeons)||void 0===t||null===(e=t[this.fb])||void 0===e?void 0:e["maps"]},params:function(){return{client:this.client,BossName:this.boss}},client_id:function(){return"std"==this.client?1:2}},methods:{loadData:function(){var t=this;this.loadBossList().then((function(){t.loadDropList()}))},loadBossList:function(){var t=this;return u(this.mapid,this.client).then((function(e){t.bosslist=(null===e||void 0===e?void 0:e.data)||[],t.boss=t.bosslist[0]["BOSS"]}))},loadDropList:function(){var t=Object(r["a"])(Object(o["a"])().mark((function t(e){var i,n,s,r,c,l,u,h,f,m,v,b,y,g,_,I,w=this;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,d(this.mapid,this.params);case 4:return s=t.sent,s=null===(i=s)||void 0===i?void 0:i.data,r=s.map((function(t){return w.getDropItemID(t)})),t.next=9,p("item_merged",this.client,{ids:r});case 9:c=t.sent,c=null===(n=c)||void 0===n?void 0:n.data,l=Object(a["a"])(s);try{for(l.s();!(u=l.n()).done;)f=u.value,f.schools=null===f||void 0===f||null===(h=f.ApplicableSchoolIDs)||void 0===h?void 0:h.split("|"),f.jx3_item_id=this.getDropItemID(f)}catch(o){l.e(o)}finally{l.f()}m=Object(a["a"])(c);try{for(m.s();!(v=m.n()).done;){b=v.value,y="item-".concat(this.client,"-").concat(b.id),sessionStorage.setItem(y,JSON.stringify(b)),g=Object(a["a"])(s);try{for(g.s();!(_=g.n()).done;)I=_.value,I.jx3_item_id==b.id&&(I.jx3_item=b)}catch(o){g.e(o)}finally{g.f()}}}catch(o){m.e(o)}finally{m.f()}this.droplist=s,t.next=23;break;case 18:t.prev=18,t.t0=t["catch"](0),this.$message.error("数据获取失败，请稍后再试"),this.boss=e,console.log(t.t0);case 23:return t.prev=23,this.loading=!1,t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[0,18,23,26]])})));function e(e){return t.apply(this,arguments)}return e}(),changeBoss:function(t){var e=this.boss;this.boss=t,this.loadDropList(e)},getDropItemID:function(t){return t.ItemExtID?"".concat(t.ItemType,"_").concat(t.ItemID,"_").concat(t.ItemExtID):"".concat(t.ItemType,"_").concat(t.ItemID)},getDropLink:function(t){return Object(m["i"])("item",t.jx3_item_id)},filterBySchool:function(t){this.school=t},isVisible:function(t){var e,i=!~~this.school||(null===(e=t.schools)||void 0===e?void 0:e.includes(this.school)),n=!1;return!!t.jx3_item&&(5==this.droptype?("other"==t.jx3_item.Source&&(n=!0),"trinket"==t.jx3_item.Source&&[5,20,22].includes(~~t.jx3_item.AucGenre)&&(n=!0)):[6,7,8].includes(~~this.droptype)?n=("trinket"!=t.jx3_item.Source||![5,20,22].includes(~~t.jx3_item.AucGenre))&&~~t.ItemType==this.droptype:~~this.droptype||(n=!0),n&&i)},viewDrop:function(t){this.focus=t.ItemID},iconLink:function(t){return Object(m["n"])(t,this.client)}},watch:{fb:{immediate:!0,handler:function(){var t;this.mapid=null===(t=this.maplist)||void 0===t?void 0:t[0]["map_id"],this.loadData()}},mapid:{handler:function(t){t&&this.loadData()}},"$route.query.mapid":{immediate:!0,handler:function(t){t&&(this.mapid=t)}},"$route.query.boss":{immediate:!0,handler:function(t){t&&(this.boss=t)}}},filters:{showSchoolIcon:function(t){return h["__imgPath"]+"image/school/"+t+".png"}},components:{"jx3-item":b["a"]}},g=y,_=(i("e6b6"),i("2877")),I=Object(_["a"])(g,n,s,!1,null,null,null);e["default"]=I.exports},b85c:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));i("a4d3"),i("e01a"),i("d28b"),i("d9e2"),i("d3b7"),i("3ca3"),i("ddb0");var n=i("06c5");function s(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=Object(n["a"])(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var s=0,o=function(){};return{s:o,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,c=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){c=!0,a=t},f:function(){try{r||null==i["return"]||i["return"]()}finally{if(c)throw a}}}}},b8ff:function(t,e,i){},c544:function(t){t.exports=JSON.parse('{"5":"特殊","6":"武器","7":"装备","8":"饰品"}')},e6b6:function(t,e,i){"use strict";i("b8ff")}}]);