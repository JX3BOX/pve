(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8396eeb2"],{1880:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"v-member-list"},[e("div",{staticClass:"m-filter m-title"},[e("el-radio-group",{attrs:{size:"small"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[e("el-radio-button",{attrs:{label:"UserList"}},[t._v("正式团员")]),e("el-radio-button",{attrs:{label:"PendingList"}},[t._v("待处理申请")])],1)],1),e(t.tab,{tag:"component",attrs:{id:t.id}})],1)},i=[],s=(a("e9f5"),a("7d54"),a("d3b7"),a("159b"),a("b0c0"),function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-member-pending"},[t.data&&t.data.length?e("div",{staticClass:"m-team-rolelist"},[e("ul",{staticClass:"u-list"},t._l(t.data,(function(a,n){return e("li",{key:n,staticClass:"u-item"},[e("span",{staticClass:"u-pic"},[e("RoleAvatar",{attrs:{mount:a.role.mount,body_type:a.role.body_type}})],1),e("span",{staticClass:"u-title"},[e("router-link",{staticClass:"u-rolename",attrs:{to:"/role/"+a.role.ID,target:"_blank"}},[t._v(t._s(a.role.name))]),a.role.custom?t._e():e("i",{staticClass:"u-status",attrs:{title:"已认证"}},[e("svg",{attrs:{height:"512",viewBox:"0 0 511.375 511.375",width:"512",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M511.375 255.688l-57.89-64.273 9.064-86.046-84.651-17.92-43.18-75.012-79.03 35.321-10.667 207.93 10.667 207.929 79.031 35.321 43.179-75.011 84.651-17.921-9.064-86.046z",fill:"#0ed678"}}),e("path",{attrs:{d:"M176.656 12.437l-43.179 75.012-84.651 17.921 9.064 86.045L0 255.688l57.89 64.272-9.064 86.046 84.651 17.921 43.18 75.011 79.031-35.321V47.758z",fill:"#04eb84"}}),e("g",[e("path",{attrs:{d:"M362.878 199.702l-22.381-19.977-84.809 95.016-10.667 23.613 10.667 21.439z",fill:"#f7f0eb"}}),e("path",{attrs:{d:"M166.56 233.095l-21.212 21.213 89.185 89.186 21.155-23.701v-45.052l-22.393 25.088z",fill:"#fffbf5"}})])])])],1),e("span",{staticClass:"u-meta"},[e("span",{staticClass:"u-server"},[e("em",[t._v("服务器")]),t._v(" "+t._s(a.role.server)+" ")]),e("span",{staticClass:"u-mount"},[e("em",[t._v("门派")]),e("img",{staticClass:"u-icon",attrs:{src:t._f("showSchoolIcon")(a.role.mount)}}),t._v(" "+t._s(t._f("showSchoolName")(a.role.mount))+" ")]),e("span",{staticClass:"u-body"},[e("em",[t._v("体型")]),t._v(" "+t._s(t._f("showBodyType")(a.role.body_type))+" ")])]),e("div",{staticClass:"u-meta u-misc"},[e("span",{staticClass:"u-team"},[e("i",{staticClass:"el-icon-collection-tag"}),t._v(" 加入团队 : "),e("router-link",{staticClass:"u-team-name",attrs:{target:"_blank",to:"/org/"+a.relation.team_id}},[t._v(" "+t._s(a.team.name||"未知")+" ")])],1),e("span",{staticClass:"u-time"},[e("i",{staticClass:"el-icon-time"}),t._v(" 申请时间 : "+t._s(t._f("showTime")(a.relation.created_at))+" ")])]),e("div",{staticClass:"u-op"},[e("el-button",{staticClass:"u-btn u-pass",attrs:{type:"success",size:"mini",icon:"el-icon-check"},on:{click:function(e){return t.checkRole(a.relation.team_id,a.relation.role_id,n)}}},[t._v("通过")]),e("el-button",{staticClass:"u-btn u-reject",attrs:{type:"info",size:"mini",plain:"",icon:"el-icon-close"},on:{click:function(e){return t.rejectRole(a.relation.team_id,a.relation.role_id,n)}}},[t._v("拒绝")])],1)])})),0),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next,jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}})],1):e("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}})],1)}),o=[],r=(a("a434"),a("85e4")),l=a("0e81"),c=a("d02c9"),u={name:"ListMemberPending",props:["id"],data:function(){return{data:[],per:10,page:1,total:1,loading:!1}},computed:{team_id:function(){return this.id},params:function(){return{pageIndex:this.page,pageSize:this.per}}},filters:{authorLink:r["a"]},methods:{loadData:function(){var t=this;this.loading=!0,Object(l["n"])(this.team_id,this.params).then((function(e){t.data=e.data.data.list||[],t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))},checkRole:function(t,e,a){var n=this;Object(l["c"])(t,e).then((function(){n.data.splice(a,1),n.$notify({title:"操作成功",message:"批准该成员加入",type:"success"})}))},rejectRole:function(t,e,a){var n=this;Object(l["d"])(t,e).then((function(){n.data.splice(a,1),n.$notify({title:"操作成功",message:"拒绝该成员加入",type:"success"})}))},changePage:function(){window.scrollTo(0,0)},init:function(){this.loadData()}},watch:{team_id:function(){this.loadData()},params:{deep:!0,handler:function(){this.loadData()}}},created:function(){this.init()},components:{RoleAvatar:c["a"]}},m=u,d=(a("ab7b"),a("2877")),p=Object(d["a"])(m,s,o,!1,null,null,null),f=p.exports,h=(a("ac1f"),a("841c"),function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-member-roles"},[e("el-input",{staticClass:"m-member-role-search",attrs:{placeholder:"请输入角色名或备注"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[e("template",{slot:"prepend"},[e("i",{staticClass:"el-icon-search"}),t._v(" 搜索")]),e("el-button",{attrs:{slot:"append",icon:"el-icon-position"},slot:"append"})],2),t.data&&t.data.length?e("div",{staticClass:"m-member-list-roles m-team-rolelist"},[e("ul",{staticClass:"u-list"},t._l(t.data,(function(a,n){return e("li",{key:n,staticClass:"u-item"},[e("span",{staticClass:"u-pic"},[e("RoleAvatar",{attrs:{mount:a.role.mount,body_type:a.role.body_type}})],1),e("span",{staticClass:"u-title"},[e("router-link",{staticClass:"u-rolename",attrs:{to:"/role/"+a.role.ID,target:"_blank"}},[t._v(t._s(a.role.name))]),a.role.custom?t._e():e("i",{staticClass:"u-status",attrs:{title:"已认证"}},[e("svg",{attrs:{height:"512",viewBox:"0 0 511.375 511.375",width:"512",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M511.375 255.688l-57.89-64.273 9.064-86.046-84.651-17.92-43.18-75.012-79.03 35.321-10.667 207.93 10.667 207.929 79.031 35.321 43.179-75.011 84.651-17.921-9.064-86.046z",fill:"#0ed678"}}),e("path",{attrs:{d:"M176.656 12.437l-43.179 75.012-84.651 17.921 9.064 86.045L0 255.688l57.89 64.272-9.064 86.046 84.651 17.921 43.18 75.011 79.031-35.321V47.758z",fill:"#04eb84"}}),e("g",[e("path",{attrs:{d:"M362.878 199.702l-22.381-19.977-84.809 95.016-10.667 23.613 10.667 21.439z",fill:"#f7f0eb"}}),e("path",{attrs:{d:"M166.56 233.095l-21.212 21.213 89.185 89.186 21.155-23.701v-45.052l-22.393 25.088z",fill:"#fffbf5"}})])])]),a.relation.role_remark?e("span",{staticClass:"u-note"},[t._v("("+t._s(a.relation.role_remark)+")")]):t._e(),e("span",{staticClass:"u-addnote",on:{click:function(e){return t.noteRole(a)}}},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置备注",placement:"top"}},[e("i",{staticClass:"el-icon-edit-outline"})])],1),e("el-rate",{staticClass:"u-star",on:{change:function(e){return t.starRole(a.relation.team_id,a.relation.role_id,a.relation.star)}},model:{value:a.relation.star,callback:function(e){t.$set(a.relation,"star",t._n(e))},expression:"item.relation.star"}})],1),e("span",{staticClass:"u-meta"},[e("span",{staticClass:"u-server"},[e("em",[t._v("服务器")]),t._v(" "+t._s(a.role.server)+" ")]),e("span",{staticClass:"u-mount"},[e("em",[t._v("门派")]),e("img",{staticClass:"u-icon",attrs:{src:t._f("showSchoolIcon")(a.role.mount)}}),t._v(" "+t._s(t._f("showSchoolName")(a.role.mount))+" ")]),e("span",{staticClass:"u-body"},[e("em",[t._v("体型")]),t._v(" "+t._s(t._f("showBodyType")(a.role.body_type))+" ")])]),e("div",{staticClass:"u-meta u-misc"},[e("span",{staticClass:"u-team"},[e("i",{staticClass:"el-icon-user"}),t._v(" 所属用户 : "),e("a",{staticClass:"u-user-name",attrs:{target:"_blank",href:t._f("authorLink")(a.relation.uid)}},[t._v(t._s(a.user.display_name))])]),e("span",{staticClass:"u-time"},[e("i",{staticClass:"el-icon-time"}),t._v(" 加入时间 : "+t._s(t._f("showTime")(a.relation.created_at))+" ")])]),e("div",{staticClass:"u-op"},[e("el-button",{staticClass:"u-btn u-reject",attrs:{type:"info",size:"mini",plain:"",icon:"el-icon-delete"},on:{click:function(e){return t.removeRole(a.relation.team_id,a.relation.role_id,n)}}},[t._v("移除")])],1)])})),0),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next,jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}})],1):e("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-dialog",{staticClass:"m-team-note-dialog",attrs:{title:"设置备注",visible:t.noteVisible,width:"30%"},on:{"update:visible":function(e){t.noteVisible=e}}},[e("div",[e("el-input",{attrs:{placeholder:"请输入内容",maxlength:20,"show-word-limit":!0},model:{value:t.note,callback:function(e){t.note=e},expression:"note"}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.noteVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.confirmNote}},[t._v("确 定")])],1)])],1)}),g=[],_=a("ade3"),v=Object(_["a"])({name:"RoleList",props:["id"],components:{},data:function(){return{data:[],per:10,page:1,total:1,loading:!1,search:"",noteVisible:!1,currentItem:"",note:""}},computed:{team_id:function(){return this.id},params:function(){return{pageIndex:this.page,pageSize:this.per,search:this.search}}},methods:{loadData:function(){var t=this;this.loading=!0,Object(l["g"])(this.team_id,this.params).then((function(e){t.data=e.data.data.list||[],t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))},removeRole:function(t,e,a){var n=this;this.$alert("确定移除该团员吗？","消息",{confirmButtonText:"确定",callback:function(i){"confirm"==i&&Object(l["d"])(t,e).then((function(t){n.$notify({title:"删除成功",message:"角色删除成功",type:"success"}),n.data.splice(a,1)}))}})},noteRole:function(t){this.noteVisible=!0,this.currentItem=t},confirmNote:function(){var t=this;Object(l["q"])(this.currentItem.relation.team_id,this.currentItem.relation.role_id,this.note).then((function(){t.noteVisible=!1,t.currentItem.relation.role_remark=t.note,t.note="",t.$notify({title:"备注成功",message:"角色备注添加成功",type:"success"})}))},starRole:function(t,e,a){var n=this;Object(l["r"])(t,e,a).then((function(t){n.$notify({title:"标星成功",message:"角色标星添加成功",type:"success"})}))},changePage:function(){window.scrollTo(0,0)},init:function(){this.loadData()}},watch:{team_id:function(){this.loadData()},params:{deep:!0,handler:function(){this.loadData()}}},filters:{authorLink:r["a"]},created:function(){this.init()},mounted:function(){}},"components",{RoleAvatar:c["a"]}),b=v,C=(a("87b3"),Object(d["a"])(b,h,g,!1,null,null,null)),y=C.exports,w=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-member-users"},[t.isPRO?t._e():e("el-alert",{staticClass:"u-admin-pop",attrs:{type:"info","show-icon":""}},[t._t("title",(function(){return[t._v("管理员设置仅"),e("a",{attrs:{href:"/vip/premium/?from=team_member",target:"_blank"}},[t._v("专业版账号")]),t._v("可用，最多只能添加20名管理员")]}))],2),t.data&&t.data.length?e("div",{staticClass:"m-member-list-users m-team-rolelist"},[e("div",{staticClass:"u-list"},t._l(t.data,(function(a,n){return e("div",{key:n,staticClass:"u-list-item"},[e("MemberItem",{attrs:{item:a,id:t.id},on:{remove:t.onRemoveAccount}})],1)})),0),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next,jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}})],1):e("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}})],1)},k=[],j=(a("4de4"),a("910d"),a("51b1")),O=a("c9d2"),x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-member-item"},[e("div",{staticClass:"u-member-item-header"},[e("a",{staticClass:"u-avatar",attrs:{href:t._f("authorLink")(t.item.uid)}},[e("img",{attrs:{src:t._f("showAvatar")(t.item.user_info&&t.item.user_info.avatar)}})]),e("a",{staticClass:"u-name",attrs:{href:t._f("authorLink")(t.item.uid)}},[t._v(" "+t._s(t.item.user_info&&t.item.user_info.display_name||"未注册")+" ")])]),e("div",{staticClass:"u-member-item-content"},[e("el-row",{staticClass:"u-roles"},t._l(t.item.roles,(function(a,n){return e("el-col",{key:a.roleInfo.ID+n,staticClass:"u-own-item",attrs:{span:24}},[a.relation.role_id?e("router-link",{staticClass:"u-own-item-exact u-own-item-link u-role",attrs:{to:"/role/"+a.relation.role_id,target:"_blank",title:a.roleInfo.name}},[e("img",{staticClass:"u-role-pic",attrs:{src:t._f("showSchoolIcon")(a.roleInfo.mount),alt:""}}),e("em",[t._v(t._s(t._f("showBodyType")(a.roleInfo.body_type)))]),e("span",{staticClass:"u-role-name"},[t._v(" "+t._s(a.roleInfo.name)+" ")]),e("i",{staticClass:"el-icon-close u-del",on:{click:function(e){return e.stopPropagation(),function(e){return t.onRemoveRole(e,a)}.apply(null,arguments)}}})]):t._e()],1)})),1)],1),e("div",{staticClass:"u-op"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"移除该账号",placement:"top"}},[t.item.uid?e("el-button",{staticClass:"u-btn u-reject",attrs:{type:"info",size:"mini",plain:"",icon:"el-icon-close"},on:{click:t.removeAccount}}):t._e()],1)],1)])},R=[],I=(a("a9e3"),{name:"MemberItem",props:{item:{type:Object,default:function(){}},id:{type:Number}},data:function(){return{data:[],per:10,page:1,total:1,loading:!1}},computed:{team_id:function(){return this.id},isPRO:function(){return this.$parent.isPRO},setAdminTip:function(){var t="设为管理员";return this.isPRO||(t+=",仅专业版用户可用"),t}},methods:{setAdmin:function(t,e,a){var n=this;this.isPRO?Object(j["a"])(t,e).then((function(t){n.$notify({title:"添加成功",message:"请在权限管理中添加相应权限",type:"success"}),a.isAdmin=!0})):this.$alert('仅专业版会员可用，<a target="_blank" href="/vip/premium/?from=team_userlist">点击开通</a>。',"提醒",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0})},removeAccount:function(){var t=this;this.$confirm("此操作会将该账号下所有角色移除，确定移除该账号？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(j["f"])(t.team_id,t.item.uid).then((function(e){t.$notify({title:"移除成功",message:"已移除该账号",type:"success"}),t.$emit("remove",t.item.uid)}))})).catch((function(){}))},onRemoveRole:function(t,e){var a=this;t.stopPropagation(),t.preventDefault(),this.$confirm("确定移除该角色？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(j["e"])(a.team_id,e.relation.role_id).then((function(t){a.$notify({title:"移除成功",message:"已移除该角色",type:"success"}),a.item.roles=a.item.roles.filter((function(t){return t.relation.role_id!=e.relation.role_id}))}))})).catch((function(){}))}},filters:{showAvatar:function(t){return Object(r["t"])(t,204)},authorLink:r["a"]},mounted:function(){}}),P=I,L=(a("c630"),Object(d["a"])(P,x,R,!1,null,null,null)),z=L.exports,A={name:"UserList",props:["id"],components:{MemberItem:z},data:function(){return{data:[],per:20,page:1,total:1,loading:!1,isPRO:!1}},computed:{team_id:function(){return this.id},params:function(){return{pageIndex:this.page,pageSize:this.per}}},methods:{loadData:function(){var t=this;this.loading=!0,Object(l["h"])(this.team_id,this.params).then((function(e){t.data=e.data.data.list||[],t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))},checkIsPro:function(){var t=this;O["a"].isPRO().then((function(e){t.isPRO=e}))},setAdmin:function(t,e,a){var n=this;Object(j["a"])(t,e).then((function(t){n.$notify({title:"添加成功",message:"请在权限管理中添加相应权限",type:"success"}),a.isAdmin=!0}))},changePage:function(){window.scrollTo(0,0)},init:function(){this.loadData(),this.checkIsPro()},onRemoveAccount:function(t){this.data=this.data.filter((function(e){return e.uid!=t}))}},watch:{team_id:function(){this.loadData()},params:{deep:!0,handler:function(){this.loadData()}}},filters:{showAvatar:function(t){return Object(r["t"])(t,68)},authorLink:r["a"]},created:function(){this.init()},mounted:function(){}},$=A,D=(a("fca8"),Object(d["a"])($,w,k,!1,null,null,null)),T=D.exports,M={props:["id"],data:function(){return{tab:"UserList"}},computed:{pendingList:function(){var t=this.$store.state.pendingList,e={};return t.forEach((function(t){e[t.team_id]=t.pending})),e}},components:{PendingList:f,RoleList:y,UserList:T}},B=M,S=(a("729f"),Object(d["a"])(B,n,i,!1,null,null,null));e["default"]=S.exports},2089:function(t,e,a){},5030:function(t,e,a){},"51b1":function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return o})),a.d(e,"g",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return c})),a.d(e,"f",(function(){return u}));a("99af");var n=a("41cb");function i(t){return Object(n["g"])().get("/api/team/my-team/".concat(t,"/manage/admin"))}function s(t,e){return Object(n["g"])().post("/api/team/my-team/".concat(t,"/manage/admin"),{user_id:e})}function o(t,e){return Object(n["g"])().delete("/api/team/my-team/".concat(t,"/manage/admin/").concat(e))}function r(t,e,a){return Object(n["g"])().put("/api/team/my-team/".concat(t,"/manage/admin/").concat(e),a)}function l(t){return Object(n["g"])().get("/api/team/info/".concat(t,"/managers"))}function c(t,e){return Object(n["g"])().delete("/api/team/relation/".concat(t,"/manage/role/").concat(e))}function u(t,e){return Object(n["g"])().delete("/api/team/relation/".concat(t,"/manage/user/").concat(e))}},6972:function(t,e,a){},"729f":function(t,e,a){"use strict";a("cb76")},"87b3":function(t,e,a){"use strict";a("5030")},9776:function(t,e,a){},ab7b:function(t,e,a){"use strict";a("9776")},c630:function(t,e,a){"use strict";a("2089")},cb76:function(t,e,a){},d02c9:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("img",{attrs:{src:t.showAvatar(t.mount,t.body_type)}})},i=[],s=a("65c2"),o={name:"roleAvatar",props:["mount","body_type"],components:{},data:function(){return{}},computed:{},methods:{showAvatar:function(t,e){return s["__cdn"]+"design/avatar/xisai/"+t+"-"+e+".png"}},filters:{},created:function(){},mounted:function(){}},r=o,l=a("2877"),c=Object(l["a"])(r,n,i,!1,null,null,null);e["a"]=c.exports},fca8:function(t,e,a){"use strict";a("6972")}}]);