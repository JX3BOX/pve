(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ddd40a8"],{"0f09":function(t,e,a){"use strict";a("489d")},"13d5":function(t,e,a){"use strict";var i=a("23e7"),n=a("d58f").left,o=a("a640"),l=a("1212"),s=a("9adc"),r=!s&&l>79&&l<83,c=r||!o("reduce");i({target:"Array",proto:!0,forced:c},{reduce:function(t){var e=arguments.length;return n(this,t,e,e>1?arguments[1]:void 0)}})},"32c3":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"m-rank-relevance-dialog",attrs:{visible:t.modelValue,title:t.title,width:"500px"},on:{close:t.close},scopedSlots:t._u([{key:"footer",fn:function(){return[e("div",{staticClass:"dialog-footer"},[e("el-button",{on:{click:t.close}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(" 确认 ")])],1)]},proxy:!0}])},[e("el-form",{attrs:{"label-position":"right","label-width":"90px"}},[e("el-form-item",{attrs:{label:"战斗统计"}},[e("el-select",{staticClass:"u-select",attrs:{placeholder:"请选择关联的战斗统计",size:"large",clearable:"",filterable:"",remote:"","filter-method":t.loadBattle,"default-first-option":!0},model:{value:t.form.jx3box_battle_id,callback:function(e){t.$set(t.form,"jx3box_battle_id",e)},expression:"form.jx3box_battle_id"}},[t._l(t.battleList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),e("ElSelectLoading",{attrs:{page:t.battleQuery.BattlePage,loading:t.battleQuery.BattleLoading,hasMore:t.battleQuery.BattleHasMore},on:{loadMore:t.loadMoreBattle}})],2)],1),e("el-form-item",{attrs:{label:"日志JCL"}},[e("el-select",{staticClass:"u-select",attrs:{placeholder:"请选择关联的日志分析",size:"large",clearable:"",filterable:"",remote:"","filter-method":t.loadJcl,"default-first-option":!0},model:{value:t.form.jx3box_jcl_id,callback:function(e){t.$set(t.form,"jx3box_jcl_id",e)},expression:"form.jx3box_jcl_id"}},[t._l(t.jclList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),e("ElSelectLoading",{attrs:{page:t.jclQuery.JclPage,loading:t.jclQuery.JclLoading,hasMore:t.jclQuery.JclHasMore},on:{loadMore:t.loadMoreJcl}})],2)],1)],1)],1)},n=[],o=(a("99af"),a("b0c0"),a("d3b7"),a("e356")),l=function(){var t=this,e=t._self._c;return e("el-option",{ref:"el",staticClass:"el-select-loading",attrs:{value:" "}},[t.hasMore?[e("el-icon",{staticClass:"el-select-loading__icon"},[e("Loading")],1),e("span",{staticClass:"el-select-loading__tips"},[t._v(t._s(t.loadingText))])]:[t._v(t._s(t.noMoreText))]],2)},s=[],r=(a("a9e3"),{name:"ElSelectLoading",props:{page:{type:Number,default:1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"加载中..."},hasMore:{type:Boolean,default:!1},noMoreText:{type:String,default:"没有更多了"}},data:function(){return{observer:null}},computed:{el:function(){return this.$refs.el},intersectionOption:function(){var t;return{root:null===(t=this.el.$el.parentElement)||void 0===t?void 0:t.parentElement,rootMargin:"0px 0px 0px 0px"}}},methods:{intersectionObserverCallback:function(t){!this.loading&&this.hasMore&&t[0].isIntersecting&&this.$emit("loadMore",this.page+1)}},mounted:function(){this.observer=new IntersectionObserver(this.intersectionObserverCallback,this.intersectionOption),this.observer.observe(this.el.$el)},unmounted:function(){var t,e;this.el&&(null===(t=this.observer)||void 0===t||t.unobserve(this.el.$el),null===(e=this.observer)||void 0===e||e.disconnect(),this.observer=null)}}),c=r,u=(a("0f09"),a("2877")),d=Object(u["a"])(c,l,s,!1,null,"5572d435",null),f=d.exports,m={components:{ElSelectLoading:f},props:{modelValue:{type:Boolean,default:!0},role:{type:Boolean,default:!1},data:{type:Object,default:function(){}}},data:function(){return{form:{jx3box_battle_id:null,jx3box_jcl_id:null},battleList:[],battleQuery:{title:"",total:0,BattleLoading:!1,BattlePage:1,BattleHasMore:!1},jclList:[],jclQuery:{title:"",total:0,JclLoading:!1,JclPage:1,JclHasMore:!1}}},computed:{id:function(){return this.data.ID},title:function(){return this.role?"关联角色（"+this.data.role+"）战斗数据":"关联团队（"+this.data.team_info.name+"）战斗数据"}},watch:{data:{immediate:!0,deep:!0,handler:function(){this.form.jx3box_battle_id=this.data.jx3box_battle_id,this.form.jx3box_jcl_id=this.data.jx3box_jcl_id}}},created:function(){this.loadJcl(),this.loadBattle()},methods:{close:function(){this.$emit("update",!1)},loadBattle:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e!==this.battleQuery.title&&(a=1),this.battleQuery.title=e,this.battleQuery.BattleLoading=!0,Object(o["a"])({pageIndex:a,type:"tinymins",title:e}).then((function(e){var i,n,o,l,s=(null===(i=e.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list)||[];t.battleList=1===a?s:t.battleList.concat(s);var r=(null===(o=e.data)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.page)||{},c=r.index,u=r.pageTotal;t.battleQuery.BattlePage=c,t.battleQuery.BattleHasMore=c<u})).finally((function(){t.battleQuery.BattleLoading=!1}))},loadMoreBattle:function(t){this.loadBattle(this.battleQuery.title,t)},loadJcl:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e!==this.jclQuery.title&&(a=1),this.jclQuery.title=e,this.jclQuery.JclLoading=!0,Object(o["a"])({pageIndex:a,type:"jcl",subject:"team",title:e}).then((function(e){var i,n,o,l,s=(null===(i=e.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list)||[];t.jclList=1===a?s:t.jclList.concat(s);var r=(null===(o=e.data)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.page)||{},c=r.index,u=r.pageTotal;t.jclQuery.JclPage=c,t.jclQuery.JclHasMore=c<u})).finally((function(){t.jclQuery.JclLoading=!1}))},loadMoreJcl:function(t){this.loadJcl(this.jclQuery.title,t)},submit:function(){var t=this;Object(o["e"])(this.id,this.form).then((function(){t.$message.success("关联审核提交成功"),t.$emit("update"),t.close()}))}}},b=m,v=(a("e372"),Object(u["a"])(b,i,n,!1,null,null,null));e["a"]=v.exports},"489d":function(t,e,a){},8829:function(t,e,a){"use strict";a("c950")},"8ba4":function(t,e,a){"use strict";var i=a("23e7"),n=a("eac50");i({target:"Number",stat:!0},{isInteger:n})},9485:function(t,e,a){"use strict";var i=a("23e7"),n=a("2266"),o=a("59ed"),l=a("825a"),s=a("46c4"),r=TypeError;i({target:"Iterator",proto:!0,real:!0},{reduce:function(t){l(this),o(t);var e=s(this),a=arguments.length<2,i=a?void 0:arguments[1],c=0;if(n(e,(function(e){a?(a=!1,i=e):i=t(i,e,c),c++}),{IS_RECORD:!0}),a)throw new r("Reduce of empty iterator with no initial value");return i}})},"9c0d":function(t,e,a){"use strict";a("b0c0");var i=function(){var t,e,a,i,n,o,l,s,r=this,c=r._self._c;return c("div",{staticClass:"u-battle-team"},[c("img",{staticClass:"u-team-logo",attrs:{src:r.showIcon}}),c("div",{staticClass:"u-team-info"},[c("span",{staticClass:"u-team-meta"},[c("em",[r._v("首领")]),r._v(" "+r._s((null===(t=r.item.boss_info)||void 0===t?void 0:t.name)||r.item.aid_info.name||"未知"))]),c("span",{staticClass:"u-team-meta"},[c("em",[r._v("团长")]),r._v(" "+r._s(r.item.leader||"未知"))]),c("span",{staticClass:"u-team-meta"},[c("em",[r._v("上报时间")]),r._v(" "+r._s(r.showTime(r.item.created)))]),0===(null===(e=r.item.boss_info)||void 0===e?void 0:e.is_rank_boss)?c("el-tag",{staticClass:"u-rank-tag",attrs:{type:"info"}},[r._v("非赛事")]):r._e(),1===(null===(a=r.item.boss_info)||void 0===a?void 0:a.is_rank_boss)||null!==(i=r.item.aid_info)&&void 0!==i&&i.event_id?c("el-tag",{staticClass:"u-rank-tag",attrs:{type:"success"}},[r._v("第 "+r._s(r.item.boss_info.rank_id||(null===(n=r.item.aid_info)||void 0===n?void 0:n.event_id))+" 届")]):r._e(),2===(null===(o=r.item.boss_info)||void 0===o?void 0:o.is_rank_boss)?c("el-tag",{staticClass:"u-rank-tag",attrs:{type:"warning"}},[r._v("预选赛")]):r._e(),1==r.item.status?c("i",{staticClass:"u-team-status",attrs:{title:"成绩正常"}},[c("svg",{attrs:{height:"512",viewBox:"0 0 511.375 511.375",width:"512",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[c("path",{attrs:{d:"M511.375 255.688l-57.89-64.273 9.064-86.046-84.651-17.92-43.18-75.012-79.03 35.321-10.667 207.93 10.667 207.929 79.031 35.321 43.179-75.011 84.651-17.921-9.064-86.046z",fill:"#0ed678"}}),c("path",{attrs:{d:"M176.656 12.437l-43.179 75.012-84.651 17.921 9.064 86.045L0 255.688l57.89 64.272-9.064 86.046 84.651 17.921 43.18 75.011 79.031-35.321V47.758z",fill:"#04eb84"}}),c("g",[c("path",{attrs:{d:"M362.878 199.702l-22.381-19.977-84.809 95.016-10.667 23.613 10.667 21.439z",fill:"#f7f0eb"}}),c("path",{attrs:{d:"M166.56 233.095l-21.212 21.213 89.185 89.186 21.155-23.701v-45.052l-22.393 25.088z",fill:"#fffbf5"}})])])]):r._e()],1),c("div",{staticClass:"u-team-setting"},[c("span",{staticClass:"u-team-meta"},[c("em",[r._v("角色")]),r._v(" "),c("img",{attrs:{loading:"lazy",width:"16",src:r.showLeaderMount()}}),r._v(" "+r._s(r.item.role))]),c("span",{staticClass:"u-team-meta"},[c("em",[r._v("服务器")]),r._v(" "+r._s(r.item.team_info.server))]),c("span",{staticClass:"u-team-meta"},[c("em",[r._v("团队")]),r._v(" "),c("b",[r._v(r._s(r.item.team_info.name))])]),c("span",{staticClass:"u-team-meta"},[c("em",[r._v("统计")]),r.item.jx3box_battle_id?c("a",{staticClass:"u-link",attrs:{href:r.getBattleLink(r.item.jx3box_battle_id)},on:{click:function(t){t.stopPropagation()}}},[r._v("已绑定")]):c("span",[r._v("-")])]),c("span",{staticClass:"u-team-meta"},[c("em",[r._v("日志")]),r.item.jx3box_jcl_id?c("a",{staticClass:"u-link",attrs:{href:r.getJclLink(r.item.jx3box_jcl_id)},on:{click:function(t){t.stopPropagation()}}},[r._v("已绑定")]):c("span",[r._v("-")])]),(null===(l=r.item.boss_info)||void 0===l?void 0:l.is_rank_boss)>0||null!==(s=r.item.aid_info)&&void 0!==s&&s.event_id?c("span",{staticClass:"u-team-meta"},[c("em",[r._v("榜单")]),c("a",{staticClass:"u-link",attrs:{href:r.RankLink,target:"_blank"},on:{click:function(t){t.stopPropagation()}}},[r._v("点击查看")])]):r._e()]),c("div",{staticClass:"u-team-op"},[c("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),r.uploadBattle(r.item)}}},[r._v("关联战斗"),c("i",{staticClass:"el-icon-upload el-icon--right"})])],1)])},n=[],o=(a("99af"),a("e9f5"),a("7d54"),a("a9e3"),a("8ba4"),a("d3b7"),a("159b"),a("65c2")),l=a("85e4"),s=a("e4f1"),r={components:{},props:{item:{type:Object,default:function(){}}},computed:{showIcon:function(){var t,e,a,i,n;return null!==(t=this.item.boss_info)&&void 0!==t&&t.img&&Number.isInteger(Number(null===(e=this.item.boss_info)||void 0===e?void 0:e.img))?this.bossIcon(Number(null===(i=this.item.boss_info)||void 0===i?void 0:i.img)):null!==(a=this.item.boss_info)&&void 0!==a&&a.img?null===(n=this.item.boss_info)||void 0===n?void 0:n.img:this.bossIcon(this.item.aid_info.achievement_id)},RankLink:function(){var t=this.item.boss_info,e=this.item.aid_info;return t?"/rank/#/".concat(t.rank_id,"/rank?aid=").concat(t.aid):e?"/rank/#/".concat(e.event_id,"/rank?aid=").concat(e.achievement_id):""}},methods:{showLeaderMount:function(){var t=0,e=this.item.role;this.item.team_members.forEach((function(a){a.Name==e&&(t=a.XFId)}));var a=o["__imgPath"]+"image/xf/"+t+".png";return a},bossIcon:function(t){return o["__imgPath"]+"image/rank/boss/".concat(t,".png")},teamLogo:function(t){return Object(l["l"])(t,108,!0)},teamLink:function(t){return Object(l["i"])("org",t)},showTime:function(t){return Object(s["d"])(new Date(1e3*t))},showTC:function(t){var e=t/1e3;return~~(e/60)+"分"+~~(e%60)+"秒"},uploadBattle:function(t){this.$emit("uploadBattle",t)},getBattleLink:function(t){return"/battle/#/combat/".concat(t)},getJclLink:function(t){return"/jcl/view?id=".concat(t)}}},c=r,u=(a("8829"),a("2877")),d=Object(u["a"])(c,i,n,!1,null,null,null);e["a"]=d.exports},aace:function(t,e,a){},c950:function(t,e,a){},d58f:function(t,e,a){"use strict";var i=a("59ed"),n=a("7b0b"),o=a("44ad"),l=a("07fa"),s=TypeError,r="Reduce of empty array with no initial value",c=function(t){return function(e,a,c,u){var d=n(e),f=o(d),m=l(d);if(i(a),0===m&&c<2)throw new s(r);var b=t?m-1:0,v=t?-1:1;if(c<2)while(1){if(b in f){u=f[b],b+=v;break}if(b+=v,t?b<0:m<=b)throw new s(r)}for(;t?b>=0:m>b;b+=v)b in f&&(u=a(u,f[b],b,d));return u}};t.exports={left:c(!1),right:c(!0)}},e356:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"c",(function(){return s}));var i=a("41cb");function n(t){return Object(i["g"])().get("/api/team/battle/my-list",{params:t})}function o(t,e){return Object(i["g"])().post("/api/team/my-race-rank/records/item/".concat(t,"/bind-battle"),e)}function l(t){return Object(i["g"])().get("/api/team/my-team/race-rank/records",{params:t})}function s(t){return Object(i["g"])().get("/api/team/my-race-rank/records",{params:t})}function r(t){return Object(i["a"])().get("/api/cms/team/boss_aid",{params:t})}},e372:function(t,e,a){"use strict";a("aace")},eac50:function(t,e,a){"use strict";var i=a("861d"),n=Math.floor;t.exports=Number.isInteger||function(t){return!i(t)&&isFinite(t)&&n(t)===t}}}]);