(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cdc76b60"],{"08a5":function(t,e,a){},"08cf":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-combat"},[t.showAnalysis?e("div",[e("subheader",{staticClass:"m-upload-header",attrs:{title:"战斗统计",desc:"Battle Statistical Analysis"}}),e("analysis",{attrs:{id:t.id,battleId:t.battleId},on:{success:function(e){t.showAnalysis=!1}}})],1):[e(t.component,{tag:"component",attrs:{allowAdd:!t.id},on:{save:t.save}}),t.id?[e("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"battle",postTitle:t.current.title,adminBoxcoinEnable:!0,userBoxcoinEnable:!0}}),e("Comment",{staticClass:"m-comment",attrs:{id:t.id,category:"battle"}})]:t._e()]],2)},n=[],r=a("5530"),i=(a("14d9"),a("a9e3"),a("2f62")),o=a("7beb"),l=a("f921"),c=(a("b0c0"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-combat-stat"},[e("subheader",{staticClass:"m-upload-header",attrs:{title:"统计分析",desc:"Battle Statistical Analysis"}},[e("el-button",{staticClass:"u-back",attrs:{plain:"",size:"small",icon:"el-icon-arrow-left"},on:{click:t.back}},[t._v(" 后退 ")]),t.allowAdd?e("el-button",{staticClass:"u-save",attrs:{type:"success",size:"small"},on:{click:t.save}},[e("svg",{class:"i-btn-save",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M493.254 77.255l-58.508-58.51A64 64 0 00389.49 0H352v112c0 8.836-7.164 16-16 16H80c-8.836 0-16-7.164-16-16V0H32C14.328 0 0 14.326 0 32v448c0 17.673 14.328 32 32 32h448c17.672 0 32-14.327 32-32V122.51a63.992 63.992 0 00-18.746-45.255zM448 448H64V256h384v192z"}}),e("path",{attrs:{d:"M224 0h64v96h-64z"}})]),t._v("云端保存 ")]):t._e()],1),e("div",{staticClass:"p-combat-main"},[e("div",{staticClass:"p-combat-primary"},[e("div",{staticClass:"m-stat-header"},[e("h1",{staticClass:"m-battle-title"},[t._v(t._s(t.current.title))]),t.current.desc?e("div",{staticClass:"m-battle-desc"},[t._v(t._s(t.current.desc))]):t._e(),e("div",{staticClass:"m-tags"},t._l(t.tags,(function(a){return e("a",{key:a.name,attrs:{href:t.tagLink(a),target:"_blank"}},[e("el-tag",{staticClass:"u-tag",attrs:{type:"success"}},[t._v(" "+t._s(a.name)+" ")])],1)})),0),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.tabChange},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(t){return e("el-tab-pane",{key:t.name,attrs:{label:t.label,name:t.name}})})),1)],1),e(t.component,{tag:"component",attrs:{info:t.info,data:t.data},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}})],1)])],1)}),u=[],d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-stat-damage"},["list"===t.mode?[e("list-header",{staticClass:"m-stat-damage-header",attrs:{info:t.info,overview:t.overview}}),e("list-common",{attrs:{data:t.listData,teammates:t.teammates},on:{view:t.view}},[e("template",{slot:"header"},[e("svg",{class:"u-title-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"467.374",height:"467.374",viewBox:"0 0 467.374 467.374","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M459.657 82.222c0-5.136-1.704-9.419-5.133-12.843l-56.531-56.531c-3.425-3.427-7.706-5.14-12.847-5.14-5.144 0-9.421 1.713-12.847 5.14L5.14 380.005C1.709 383.434 0 387.719 0 392.858c0 5.141 1.709 9.418 5.14 12.847l56.529 56.527c3.431 3.429 7.708 5.141 12.85 5.141 5.137 0 9.419-1.704 12.847-5.141l367.162-367.16c3.425-3.43 5.129-7.708 5.129-12.85zm-127.619 83.655l-30.546-30.55 83.651-83.654 30.546 30.549-83.651 83.655zM65.384 73.087l8.564-27.978 27.977-8.564-27.977-8.566L65.384.001l-8.566 27.978-27.978 8.566 27.978 8.564zM139.61 108.494l17.133 55.961 17.133-55.961 55.959-17.133-55.959-17.131-17.133-55.961L139.61 74.23 83.651 91.361zM439.392 210.7l-8.563-27.977-8.562 27.977-27.98 8.565 27.98 8.565 8.562 27.975 8.563-27.975 27.982-8.565zM248.106 73.087l8.566-27.978 27.976-8.564-27.976-8.566L248.106.001l-8.562 27.978-27.98 8.566 27.98 8.564z"}})]),t._v(t._s(t.summaryTitle))])],2)]:[e("single",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.current,info:t.info}})]],2)},f=[],m=a("c7eb"),p=a("1da1"),h=(a("b64b"),a("2a7b")),b=function(){var t=this,e=t._self._c;return t.list&&t.list.length?e("fold-wrapper",[e("div",{staticClass:"m-stat-list-title",attrs:{slot:"header"},slot:"header"},[t._t("header")],2),e("el-table",{staticClass:"m-stat-list",attrs:{data:t.list,"default-sort":{prop:"total",order:"descending"},stripe:!0,border:"",size:"mini","highlight-current-row":!0},on:{"row-click":t.view}},[e("el-table-column",{attrs:{type:"index",label:"排名",sortable:""}}),e("el-table-column",{attrs:{prop:"forceID",label:"门派",sortable:"","column-key":"forceID",filters:t.localforces,"filter-method":t.filterForce},scopedSlots:t._u([{key:"default",fn:function(a){return[e("img",{staticClass:"u-force-icon",attrs:{src:t._f("showForceIcon")(a.row["forceID"])}}),e("span",[t._v(t._s(a.row["forceName"]))])]}}],null,!1,2308764479)}),e("el-table-column",{attrs:{prop:"name",label:"玩家",sortable:""}}),e("el-table-column",{attrs:{prop:"total",label:"总计",sortable:"",width:"220px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"u-progress-container"},[e("i",{staticClass:"u-progress",style:t.getProgressStyles(a.row,a.$index)})])]}}],null,!1,1271045578)}),e("el-table-column",{attrs:{prop:"total",label:t.totalText,sortable:""}}),e("el-table-column",{attrs:{prop:"dps",label:t.dpsText,sortable:""}}),e("el-table-column",{attrs:{prop:"more",label:"详情"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-data-line"},on:{click:function(e){return t.view(a.row)}}},[t._v("查看详情")])]}}],null,!1,4036255058)})],1)],1):t._e()},_=[],v=(a("a630"),a("e9f5"),a("7d54"),a("d3b7"),a("6062"),a("1e70"),a("79a4"),a("c1a1"),a("8b00"),a("a4e7"),a("1e5a"),a("72c3"),a("3ca3"),a("159b"),a("ddb0"),a("65c2")),g=a("2b04"),w=a("1726"),y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-fold-block"},[e("div",{staticClass:"u-title"},[t._t("header"),e("el-button",{staticClass:"u-folder",attrs:{plain:"",icon:t.isFold?"el-icon-caret-right":"el-icon-caret-top",size:"mini"},on:{click:t.execFold}},[t._v(t._s(t.isFold?"展开":"收起"))])],2),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isFold,expression:"!isFold"}]},[t._t("default")],2),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isFold,expression:"isFold"}],staticClass:"u-etc"},[e("p",[t._v("...")]),e("p",[t._v("当前数据被折叠")])])])},k=[],x={name:"foldWrapper",props:[],components:{},data:function(){return{isFold:!1}},computed:{},methods:{execFold:function(){this.isFold=!this.isFold}},filters:{},created:function(){},mounted:function(){}},C=x,D=(a("da574"),a("2877")),T=Object(D["a"])(C,y,k,!1,null,"5a2d2070",null),j=T.exports,O={name:"CommonList",props:["data","teammates"],components:{"fold-wrapper":j},data:function(){return{list:[],colors_by_school_name:w["colors_by_school_name"]}},computed:{type:function(){return this.$store.state.type},maxDamage:function(){var t=[];return this.list.forEach((function(e){t.push(e.total)})),Math.max.apply(Math,t)},localforces:function(){var t=new Set;this.list.forEach((function(e){t.add(e.forceID)}));var e=Array.from(t),a=[];return e.forEach((function(t){a.push({text:g[t]||"NPC",value:t})})),a},totalText:function(){switch(this.type){case"damage":return"总伤害";case"heal":return"总治疗";case"beHeal":return"总承疗";case"beDamage":return"总承伤";case"absorb":return"总化解";default:return"总计"}},dpsText:function(){switch(this.type){case"damage":return"秒伤";case"heal":return"秒疗";case"beHeal":return"秒承疗";case"beDamage":return"秒承伤";case"absorb":return"秒化解";default:return"秒伤"}}},watch:{data:{immediate:!0,deep:!0,handler:function(){this.init()}}},methods:{getProgressStyles:function(t,e){var a={width:0,"background-color":""};return a.width=e?t.total/this.maxDamage*100+"%":"100%",a["background-color"]=w["colors_by_school_name"][g[t.forceID]]||"#aaa",a},filterForce:function(t,e,a){return e["forceID"]===t},view:function(t){this.$emit("view",t)},init:function(){var t=[],e=this.data,a=this.teammates;for(var s in e)a[s]?t.push(Object.assign(e[s],a[s])):t.push(Object.assign(e[s],{forceID:0,forceName:"NPC",icon:0,id:s,name:s}));this.list=t}},filters:{showForceIcon:function(t){return v["__imgPath"]+"image/force/"+t+".png"}}},F=O,S=(a("237f"),Object(D["a"])(F,b,_,!1,null,null,null)),I=S.exports,z=function(){var t=this,e=t._self._c;return t.overview?e("div",{staticClass:"m-overview"},[e("ul",[e("li",[e("span",[t._v("战斗对象")]),e("b",[t._v(t._s(t.overview.bossname))])]),e("li",[e("span",[t._v("总"+t._s(t.totalText))]),"death"!==t.type?e("b",[t._v(t._s(t._f("showNumber")(t.overview.total)))]):e("b",[t._v(t._s(t.overview.total))])]),e("li",[e("span",[t._v("战斗时长")]),e("b",[t._v(" "+t._s(t.time_during)+" "),e("em",[t._v("秒")])])]),t.perText?e("li",[e("span",[t._v("团队秒"+t._s(t.perText))]),e("b",[t._v(t._s(t._f("showNumber")(t.overview.dps)))])]):t._e(),t._t("default"),e("li",[e("time",[t._v("开始时间："+t._s(t._f("showTime")(t.time_begin)))]),e("time",[t._v("结束时间："+t._s(t._f("showTime")(t.time_end)))])])],2)]):t._e()},$=[],M=(a("b680"),a("e4f1")),N={name:"listHeader",props:["overview","info"],data:function(){return{}},filters:{showNumber:function(t){return(t/1e4).toFixed(2)+"万"},showTime:function(t){return Object(M["d"])(new Date(t))}},computed:{type:function(){return this.$store.state.type},time_begin:function(){return 1e3*this.info.time_begin},time_end:function(){return 1e3*this.info.time_end},time_during:function(){return this.info.time_during},totalText:function(){switch(this.type){case"damage":return"伤害";case"heal":return"治疗";case"beHeal":return"承疗";case"beDamage":return"承伤";case"absorb":return"化解";case"death":return"死亡";default:return""}},perText:function(){switch(this.type){case"damage":return"伤";case"heal":return"治疗";case"beHeal":return"承疗";case"beDamage":return"承伤";case"absorb":return"化解";default:return""}}}},B=N,E=(a("41d0"),Object(D["a"])(B,z,$,!1,null,"8c8047d0",null)),H=E.exports,L=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-stat-damage-single"},[e("single-header",{attrs:{data:t.data,info:t.info}}),t.data?e("fold-wrapper",[e("div",{attrs:{slot:"header"},slot:"header"},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"467.374",height:"467.374",viewBox:"0 0 467.374 467.374","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M459.657 82.222c0-5.136-1.704-9.419-5.133-12.843l-56.531-56.531c-3.425-3.427-7.706-5.14-12.847-5.14-5.144 0-9.421 1.713-12.847 5.14L5.14 380.005C1.709 383.434 0 387.719 0 392.858c0 5.141 1.709 9.418 5.14 12.847l56.529 56.527c3.431 3.429 7.708 5.141 12.85 5.141 5.137 0 9.419-1.704 12.847-5.141l367.162-367.16c3.425-3.43 5.129-7.708 5.129-12.85zm-127.619 83.655l-30.546-30.55 83.651-83.654 30.546 30.549-83.651 83.655zM65.384 73.087l8.564-27.978 27.977-8.564-27.977-8.566L65.384.001l-8.566 27.978-27.978 8.566 27.978 8.564zM139.61 108.494l17.133 55.961 17.133-55.961 55.959-17.133-55.959-17.131-17.133-55.961L139.61 74.23 83.651 91.361zM439.392 210.7l-8.563-27.977-8.562 27.977-27.98 8.565 27.98 8.565 8.562 27.975 8.563-27.975 27.982-8.565zM248.106 73.087l8.566-27.978 27.976-8.564-27.976-8.566L248.106.001l-8.562 27.978-27.98 8.566 27.98 8.564z"}})]),t._v("技能分析 ")]),e("div",{staticClass:"m-status"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("命中")]),e("b",[t._v(t._s(t.data.overview.hit||0))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("会心")]),e("b",[t._v(t._s(t.data.overview.critical||0))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("会心率")]),e("b",[t._v(t._s(t.total_critical_percent))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("偏离")]),e("b",[t._v(t._s(t.data.overview.miss||0))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("识破")]),e("b",[t._v(t._s(t.data.overview.insight||0))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("无效")]),e("b",[t._v(t._s(t.data.overview.shield||0))])])])],1)],1),e("skills",{attrs:{data:t.data._skills,attrs:t.attrs,total:t.data.total}})],1):t._e(),e("single-targets",{attrs:{data:t.data}})],1)},A=[],P=(a("d81d"),a("ab43"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-state-damage-single-header"},[e("header",{staticClass:"m-single-header"},[e("div",{staticClass:"u-basic"},[t.isUper?[e("img",{staticClass:"u-icon-xf",attrs:{src:t._f("showMountIcon")(t.info.player_mount)}})]:[e("img",{staticClass:"u-icon-xf",attrs:{src:t._f("showForceIcon")(t.data.forceID)}})],e("span",{staticClass:"u-name"},[t.isUper?[e("span",{staticClass:"u-player-name"},[t._v(t._s(t.info.player_name))])]:[e("span",{staticClass:"u-player-name"},[t._v(t._s(t.data.name))])]],2)],2)]),e("div",{staticClass:"m-overview"},[e("ul",[e("li",[e("span",[t._v("战斗名称")]),e("b",[t._v(t._s(t.info.bossname))])]),e("li",[e("span",[t._v(t._s(t.totalText))]),e("b",[t._v(t._s(t._f("showNumber")(t.total)))])]),e("li",[e("span",[t._v("战斗时长")]),e("b",[t._v(" "+t._s(t.info.time_during)+" "),e("em",[t._v("秒")])])]),e("li",[e("span",[t._v(t._s(t.dpsText))]),e("b",[t._v(t._s(t._f("showNumber")(t.dps)))])])])]),e("div",{staticClass:"m-meta"},[e("ul",[e("li",[e("span",[t._v("服务器")]),e("b",[t._v(t._s(t.info.server))])]),e("li",[e("span",[t._v("地图场景")]),e("b",[t._v(t._s(t.showMapName(t.info.map)))])]),e("li",[e("span",[t._v("数据类型")]),e("b",[t._v(t._s(t._f("showDataType")(t.info.type)))])]),e("li",[e("span",[t._v("数据版本号")]),e("b",[t._v("v"+t._s(t.info.version))])]),e("li",[e("span",[t._v("开始时间")]),e("time",[t._v(t._s(t._f("showTime")(t.info.time_begin)))])]),e("li",[e("span",[t._v("结束时间")]),e("time",[t._v(t._s(t._f("showTime")(t.info.time_end)))])])])])])}),J=[],R=a("ade3"),U=(a("e9c4"),a("82d1")),V=Object(R["a"])(Object(R["a"])(Object(R["a"])({name:"singleHeader",props:["data","info"],data:function(){return{maps:{}}},methods:{},computed:{type:function(){return this.$store.state.type},isUper:function(){return this.info.player_id==this.data.id},dps:function(){return this.isUper?this.info.dps:this.data.dps},total:function(){return this.isUper?this.info.damage:this.data.total},dpsText:function(){switch(this.type){case"damage":return"秒伤";case"heal":return"秒治疗";case"beHeal":return"秒承疗";default:return"秒伤"}},totalText:function(){switch(this.type){case"damage":return"总伤害";case"heal":return"总治疗";case"beHeal":return"总承疗";default:return"总伤害"}}},filters:{showForceIcon:function(t){return t&&v["__imgPath"]+"image/force/"+t+".png"},showMountIcon:function(t){return t&&v["__imgPath"]+"image/xf/"+t+".png"},showTime:function(t){return Object(M["d"])(new Date(1e3*t))},showNumber:function(t){return(t/1e4).toFixed(2)+"万"},showDataType:function(t){return U[t]}}},"methods",{getMaps:function(){var t=this;try{var e=sessionStorage.getItem("jx3maps");e?this.maps=JSON.parse(e):fetch("https://data.jx3box.com/map/data/map_index.json").then((function(t){return t.json()})).then((function(e){t.maps=e,sessionStorage.setItem("jx3maps",JSON.stringify(e))}))}catch(a){console.log(a)}},showMapName:function(t){var e;return null!==(e=this.maps[t])&&void 0!==e?e:"未知地图"}}),"created",(function(){})),"mounted",(function(){this.getMaps()})),W=V,q=(a("ca75"),Object(D["a"])(W,P,J,!1,null,"0999f014",null)),X=q.exports,G=(a("caad"),a("2532"),function(){var t=this,e=t._self._c;return e("el-table",{staticClass:"m-skills",attrs:{data:t.skills,"default-sort":{prop:"total",order:"descending"},stripe:!0,border:"",size:"mini","highlight-current-row":!0}},[e("el-table-column",{attrs:{type:"index",label:"排名",sortable:""}}),t.attrs.includes("name")?e("el-table-column",{attrs:{prop:"name",label:"技能名",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{staticClass:"u-skill-name",attrs:{href:t.getSkillLink(a.row),target:"_blank"}},[e("img",{staticClass:"u-skill-icon",attrs:{src:t._f("iconLink")(a.row.icon)}}),e("span",[t._v(t._s(a.row.name||a.row._name))])])]}}],null,!1,3840751241)}):t._e(),t.attrs.includes("_name")?e("el-table-column",{attrs:{prop:"_name",label:"实际子技能",sortable:""}}):t._e(),t.attrs.includes("count")?e("el-table-column",{attrs:{prop:"count",label:"技能数",sortable:""}}):t._e(),t.attrs.includes("min")?e("el-table-column",{attrs:{prop:"min",label:"最小值",sortable:""}}):t._e(),t.attrs.includes("avg")?e("el-table-column",{attrs:{prop:"avg",label:"平均值",sortable:""}}):t._e(),t.attrs.includes("max")?e("el-table-column",{attrs:{prop:"max",label:"最大值",sortable:""}}):t._e(),t.attrs.includes("hit")?e("el-table-column",{attrs:{prop:"hit",label:"命中",sortable:""}}):t._e(),t.attrs.includes("critical")?e("el-table-column",{attrs:{prop:"critical",label:"会心",sortable:""}}):t._e(),t.attrs.includes("miss")?e("el-table-column",{attrs:{prop:"miss",label:"偏离",sortable:""}}):t._e(),t.attrs.includes("insight")?e("el-table-column",{attrs:{prop:"insight",label:"识破",sortable:""}}):t._e(),t.attrs.includes("critical_percentage")?e("el-table-column",{attrs:{prop:"critical_percentage",label:"会心率",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("showPercentage")(a.row.critical_percentage)))])]}}],null,!1,576260168)}):t._e(),t.attrs.includes("damage_percentage")?e("el-table-column",{attrs:{prop:"damage_percentage",label:t.percentText,sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("showPercentage")(a.row.damage_percentage)))])]}}],null,!1,2961486920)}):t._e(),t.attrs.includes("total_bar")?e("el-table-column",{attrs:{prop:"total",label:t.totalText,sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"u-progress-container"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.total+"",placement:"top-start"}},[e("i",{staticClass:"u-progress",style:{width:a.row.total/t.max_skill_damage*100+"%"}},[e("em",[t._v(t._s(a.row.total))])])])],1)]}}],null,!1,267480289)}):t._e()],1)}),K=[],Q=a("2909"),Y=a("85e4"),Z={name:"skills",props:["data","attrs","total"],components:{},data:function(){return{}},computed:{type:function(){return this.$store.state.type},max_skill_damage:function(){var t=new Set;this.skills.forEach((function(e){t.add(e.total)}));var e=Math.max.apply(Math,Object(Q["a"])(Array.from(t)));return e},skills:function(){var t=this,e=[];return this.data.forEach((function(a,s){a.total&&(a.critical_percentage=a.critical/a.count,a.damage_percentage=a.total/t.total,e.push(a))})),e},percentText:function(){switch(this.type){case"damage":return"伤害占比";case"heal":return"治疗占比";case"beHeal":return"承疗占比";default:return"伤害占比"}},totalText:function(){switch(this.type){case"damage":return"伤害总量";case"heal":return"治疗总量";case"beHeal":return"承疗总量";default:return"伤害总量"}}},methods:{getPercentage:function(t,e){return(t/e*100).toFixed(2)+"%"},getSkillLink:function(t){return 1==t.type?Object(Y["i"])("skill",t.id):Object(Y["i"])("buff",t.id)}},filters:{iconLink:Y["n"],showPercentage:function(t){return(100*t).toFixed(2)+"%"}}},tt=Z,et=(a("89cb"),Object(D["a"])(tt,G,K,!1,null,"2d055230",null)),at=et.exports,st=function(){var t=this,e=t._self._c;return t.targets&&t.targets.length?e("fold-wrapper",{staticClass:"m-targets"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("i",{staticClass:"el-icon-aim"}),t._v(" 目标分析 "),e("span",{staticClass:"u-tip"},[t._v("(点击饼图目标查看目标技能详情)")])]),e("div",{staticClass:"m-status"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("目标总数")]),t.data._targets?e("b",[t._v(t._s(Object.keys(t.data._targets._targets).length||0))]):t._e()])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("技能总数")]),t.data._targets?e("b",[t._v(t._s(t.data._targets._count||0))]):t._e()])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("当前目标技能总数")]),e("b",[t._v(t._s(t.currentTarget.count||"-"))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("当前目标"+t._s(t.totalText))]),e("b",[t._v(t._s(t.currentTarget.total||"-"))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("当前目标ID(编号)")]),e("b",[t._v(t._s(t.currentTarget.id||"-"))])])]),e("el-col",{attrs:{span:4}},[e("li",[e("span",[t._v("当前目标名称")]),e("b",[t._v(t._s(t.title||"-"))])])])],1)],1),e("div",{staticClass:"m-targets-content"},[e("v-echart",{ref:"pie",staticClass:"m-chart-pie",attrs:{option:t.options,autoresize:""},on:{click:t.showSkillDetail}})],1),e("div",{staticClass:"m-targets-skill"},[t.currentTarget?e("skills",{attrs:{data:t.currentTarget.skills,attrs:t.attrs,total:t.currentTarget.total}}):t._e()],1)]):t._e()},nt=[],rt=a("b85c"),it={name:"singleTargets",props:["data"],components:{"fold-wrapper":j,skills:at},data:function(){return{currentTarget:"",title:"总览",attrs:["name","_name","count","max","hit","critical","miss","insight","total_bar"]}},computed:{type:function(){return this.$store.state.type},options:function(){return{title:{text:this.title,left:"center"},tooltip:{trigger:"item",formatter:"{b} <br/> 技能数 : {c} ({d}%)"},legend:{orient:"vertical",left:"left",type:"scroll",data:this.targets},series:[{name:this.title,type:"pie",radius:"55%",center:["50%","50%"],data:this.transformToPieData(this.data._targets.detail),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},targets:function(){var t=[];for(var e in null===(a=this.data)||void 0===a||null===(s=a._targets)||void 0===s?void 0:s._targets){var a,s,n,r,i=null===(n=this.data)||void 0===n||null===(r=n._targets)||void 0===r?void 0:r._targets[e];t.push((i||"未知")+"(".concat(e,")"))}return t},totalText:function(){switch(this.type){case"damage":return"伤害总量";case"heal":return"治疗总量";case"beHeal":return"承受疗总量";default:return"伤害总量"}}},methods:{showSkillDetail:function(t){var e,a,s=t.data.key,n=Object(rt["a"])(null===(e=this.data)||void 0===e?void 0:e._targets.detail);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(s==r.id){this.currentTarget=r,this.title=r.name;break}}}catch(i){n.e(i)}finally{n.f()}},transformToPieData:function(t){var e=[];for(var a in t)e.push({value:t[a]["count"],name:(t[a]["name"]||"未知")+"(".concat(t[a]["id"],")"),key:t[a]["id"]});return e}}},ot=it,lt=(a("61ff"),Object(D["a"])(ot,st,nt,!1,null,"ec2db3ba",null)),ct=lt.exports,ut={name:"single",props:["info","data"],components:{singleHeader:X,skills:at,foldWrapper:j,singleTargets:ct},data:function(){return{attrs:["name","_name","count","max","avg","min","hit","critical","miss","insight","critical_percentage","damage_percentage","total_bar"]}},computed:{total_critical_percent:function(){var t=0;for(var e in this.data.overview)t+=this.data.overview[e];return(this.data.overview.critical/t*100).toFixed(2)+"%"}}},dt=ut,ft=(a("6a4f"),Object(D["a"])(dt,L,A,!1,null,"c4c13706",null)),mt=ft.exports,pt={name:"list",props:["info","data","mode"],components:{listCommon:I,listHeader:H,single:mt},model:{prop:"mode",event:"update"},data:function(){return{current:"",loading:!1}},computed:{type:function(){return this.$store.state.type},combatRaw:function(){return this.$store.state.data},overview:function(){var t;return null===(t=this.data[this.type])||void 0===t?void 0:t["overview"]},listData:function(){var t;return null===(t=this.data[this.type])||void 0===t?void 0:t["playerData"]},teammates:function(){return this.data["teammates"]},summaryTitle:function(){switch(this.type){case"damage":return"伤害总览";case"heal":return"治疗总览";case"beHeal":return"承疗总览";case"beDamage":return"承伤总览";case"absorb":return"化解总览";default:return""}}},methods:{view:function(t){this.$emit("update","single"),this.renderSkills(t)},renderSkills:function(t){var e=this;return Object(p["a"])(Object(m["a"])().mark((function a(){var s;return Object(m["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,Object(h["a"])(t.skills);case 3:return t._skills=a.sent,s=JSON.parse(t.targets),a.next=7,Object(h["c"])(s.data,e.combatRaw);case 7:t._targets=a.sent,e.current=t,e.current&&(e.loading=!1);case 10:case"end":return a.stop()}}),a)})))()}}},ht=pt,bt=(a("3a2d"),Object(D["a"])(ht,d,f,!1,null,null,null)),_t=bt.exports,vt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-stat-damage"},["list"===t.mode?[e("list-header",{staticClass:"m-stat-damage-header",attrs:{info:t.info,overview:t.overview}}),e("fold-wrapper",[e("div",{staticClass:"m-stat-list-title",attrs:{slot:"header"},slot:"header"},[e("svg",{class:"u-title-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"467.374",height:"467.374",viewBox:"0 0 467.374 467.374","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M459.657 82.222c0-5.136-1.704-9.419-5.133-12.843l-56.531-56.531c-3.425-3.427-7.706-5.14-12.847-5.14-5.144 0-9.421 1.713-12.847 5.14L5.14 380.005C1.709 383.434 0 387.719 0 392.858c0 5.141 1.709 9.418 5.14 12.847l56.529 56.527c3.431 3.429 7.708 5.141 12.85 5.141 5.137 0 9.419-1.704 12.847-5.141l367.162-367.16c3.425-3.43 5.129-7.708 5.129-12.85zm-127.619 83.655l-30.546-30.55 83.651-83.654 30.546 30.549-83.651 83.655zM65.384 73.087l8.564-27.978 27.977-8.564-27.977-8.566L65.384.001l-8.566 27.978-27.978 8.566 27.978 8.564zM139.61 108.494l17.133 55.961 17.133-55.961 55.959-17.133-55.959-17.131-17.133-55.961L139.61 74.23 83.651 91.361zM439.392 210.7l-8.563-27.977-8.562 27.977-27.98 8.565 27.98 8.565 8.562 27.975 8.563-27.975 27.982-8.565zM248.106 73.087l8.566-27.978 27.976-8.564-27.976-8.566L248.106.001l-8.562 27.978-27.98 8.566 27.98 8.564z"}})]),t._v(" 死亡总览 ")]),e("el-table",{staticClass:"m-stat-list",attrs:{data:t.list,"default-sort":{prop:"total",order:"descending"},"highlight-current-row":!0,stripe:!0,border:"",size:"mini"}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.arr,(function(a,s){return e("div",{key:s,staticClass:"u-death-item"},[e("span",[t._v("死亡类型："+t._s(t.deathType(a.type)))]),e("span",[t._v("触发时间："+t._s(t.formatTime(a.trigger)))]),e("span",[t._v("结束时间："+t._s(t.formatTime(a.stop)))])])}))}}],null,!1,2842413017)}),e("el-table-column",{attrs:{type:"index",label:"排名",sortable:""}}),e("el-table-column",{attrs:{prop:"forceID",label:"门派",sortable:"","column-key":"forceID",filters:t.localforces,"filter-method":t.filterForce},scopedSlots:t._u([{key:"default",fn:function(a){return[e("img",{staticClass:"u-force-icon",attrs:{src:t._f("showForceIcon")(a.row["forceID"]),alt:""}}),e("span",[t._v(t._s(a.row["forceName"]))])]}}],null,!1,1880541584)}),e("el-table-column",{attrs:{prop:"name",label:"玩家",sortable:""}}),e("el-table-column",{attrs:{prop:"total",label:"总计",sortable:"",width:"220px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.arr.length)+" ")]}}],null,!1,1952644046)})],1)],1)]:t._e()],2)},gt=[],wt={name:"death_summary",props:["info","data","mode"],components:{listHeader:H,foldWrapper:j},model:{prop:"mode",event:"update"},computed:{overview:function(){return this.data["death"]["overview"]},list:function(){var t,e=null===(t=this.data)||void 0===t?void 0:t["death"]["playerData"];if(!e)return[];var a=this.data.teammates;return e.map((function(t){return Object(r["a"])(Object(r["a"])({},t),{},{total:t.arr.length,forceID:a[t.id].forceID,forceName:g[a[t.id].forceID]})}))},localforces:function(){var t=new Set;this.list.forEach((function(e){t.add(e.forceID)}));var e=Array.from(t),a=[];return e.forEach((function(t){a.push({text:g[t]||"NPC",value:t})})),a}},methods:{filterForce:function(t,e,a){return e["forceID"]===t},deathType:function(t){return{0:"死亡",1:"离线",2:"暂离"}[t]},formatTime:function(t){return t?new Date(1e3*t).toLocaleString():"未知"}},filters:{showForceIcon:function(t){return v["__imgPath"]+"image/force/"+t+".png"}}},yt=wt,kt=(a("d746"),Object(D["a"])(yt,vt,gt,!1,null,"d8b616f2",null)),xt=kt.exports,Ct=(a("99af"),a("7db0"),a("f665"),a("5ab5")),Dt=a("91d4"),Tt={data:function(){return{ranks:[]}},computed:{current:function(){return this.$store.state.current},tags:function(t){var e=t.current,a=t.ranks,s=[];if(null!==e&&void 0!==e&&e.rank_id){var n=a.find((function(t){return t.ID==e.rank_id}));n&&s.push({name:n.name,id:n.ID,type:"rank"})}if(null!==e&&void 0!==e&&e.boss_id){var r=a.find((function(t){return t.ID==e.rank_id})),i=null===r||void 0===r?void 0:r.boss_map,o=null===i||void 0===i?void 0:i.find((function(t){return t.achievement_id==e.boss_id}));o&&s.push({name:o.name,id:o.achievement_id,type:"boss",rank_id:e.rank_id})}return null!==e&&void 0!==e&&e.mount_id&&s.push({name:Dt[e.mount_id],id:e.mount_id,type:"mount",boss_id:e.boss_id,rank_id:e.rank_id}),s}},mounted:function(){this.getRanks()},methods:{getRanks:function(){var t=this;try{var e=sessionStorage.getItem("jbRanks");if(e)return void(this.ranks=JSON.parse(e));var a={pageIndex:1,pageSize:100};Object(Ct["h"])(a).then((function(e){sessionStorage.setItem("jbRanks",JSON.stringify(e.data.data.list||[])),t.ranks=e.data.data.list||[]}))}catch(s){console.log(s)}},tagLink:function(t){var e=t.id,a=t.type,s=t.rank_id,n=t.boss_id;return"rank"===a?"/rank/race/#/".concat(e,"/dps"):"boss"===a?"/rank/race/#/".concat(s,"/dps?aid=").concat(e):"mount"===a?"/rank/race/#/".concat(s,"/dps?aid=").concat(n,"&mount=").concat(e):void 0}}},jt=[{label:"伤害分析",name:"damage"},{label:"治疗分析",name:"heal"},{label:"承疗分析",name:"beHeal"},{label:"承伤分析",name:"beDamage"},{label:"化解分析",name:"absorb"},{label:"死亡分析",name:"death"}],Ot={name:"",components:{subheader:o["a"],list:_t,deathSummary:xt},props:{allowAdd:{type:Boolean,default:!1}},mixins:[Tt],data:function(){return{tab:"damage",mode:"list",components:{damage:_t,heal:_t,beHeal:_t,beDamage:_t,absorb:_t,death:xt},tabs:jt}},computed:{isChecked:function(){var t;return null===(t=this.$store.state.current)||void 0===t?void 0:t.is_checked},component:function(){return this.components[this.tab]},data:function(){return this.$store.state.analysis},info:function(){return this.$store.state.info}},watch:{tab:function(t){this.$store.commit("set",{key:"type",val:t})}},methods:{save:function(){this.$emit("save")},back:function(){"list"===this.mode?(this.$store.commit("RESET"),window.history.length>1?this.$router.go(-1):this.$router.push("/")):this.mode="list"},tabChange:function(){this.mode="list"}},mounted:function(){this.tab="damage",this.$store.commit("set",{key:"type",val:"damage"})}},Ft=Ot,St=(a("cdd5"),Object(D["a"])(Ft,c,u,!1,null,null,null)),It=St.exports,zt=a("23d8"),$t={name:"Combat",props:[],components:{tinymins:It,analysis:l["a"],Comment:zt["a"],subheader:o["a"]},data:function(){return{battleId:"",id:"",showAnalysis:!1,components:{official:It,tinymins:It}}},computed:Object(r["a"])(Object(r["a"])({},Object(i["d"])(["analysis"])),{},{type:function(){return"pvp"===this.$store.state.info.subject?"jcl-pvp":this.$store.state.info.type},component:function(){return this.components[this.type]},current:function(){return this.$store.state.current}}),watch:{id:function(){this.$store.commit("RESET")}},methods:{save:function(){this.$router.push({name:"add",params:{type:this.type}})},init:function(){var t=this.$route.query,e=this.$route.params.id;this.analysis||window.$store||e||t.battle_id||this.$router.push({name:"upload"}),(e||t.battle_id)&&(this.id=Number(e),this.battleId=decodeURIComponent(t.battle_id),this.showAnalysis=!0)}},mounted:function(){this.init()}},Mt=$t,Nt=(a("266a"),Object(D["a"])(Mt,s,n,!1,null,null,null));e["default"]=Nt.exports},"0cc7":function(t,e,a){},"0d43":function(t,e,a){},1726:function(t){t.exports=JSON.parse('{"colors_by_school_name":{"江湖":"#c3c5c1","天策":"#EC4B2C","万花":"#BA9BE4","纯阳":"#37C0E2","七秀":"#FF7DAD","少林":"#E6BC31","藏剑":"#FDDD70","丐帮":"#D6A16F","明教":"#f16040","五毒":"#4B9BFB","唐门":"#90CC50","苍云":"#6568ad","长歌":"#6DDFE2","霸刀":"#8D90D8","蓬莱":"#94C7DC","凌雪":"#872F37","衍天":"#b9c1ff","药宗":"#16708a","刀宗":"#6bb7f2","万灵":"#ffde7b","段氏":"#96b4cc"},"colors_by_mount_name":{"通用":"#c3c5c1","冰心诀":"#FF7DAD","云裳心经":"#ffadcb","花间游":"#BA9BE4","离经易道":"#d8c4ff","毒经":"#4B9BFB","补天诀":"#7db8ff","莫问":"#6DDFE2","相知":"#78f0f3","傲血战意":"#EC4B2C","铁牢律":"#d43618","易筋经":"#E6BC31","洗髓经":"#b58f12","焚影圣诀":"#f16040","明尊琉璃体":"#c55036","分山劲":"#6568ad","铁骨衣":"#4f5186","紫霞功":"#37C0E2","太虚剑意":"#48d6f9","天罗诡道":"#90CC50","惊羽诀":"#a2e05f","问水诀":"#FDDD70","山居剑意":"#FDDD70","笑尘诀":"#D6A16F","北傲诀":"#8D90D8","凌海诀":"#94C7DC","隐龙诀":"#872F37","太玄经":"#b9c1ff","无方":"#16708a","灵素":"#39bf9b","孤锋诀":"#6bb7f2","山海心诀":"#ffde7b","周天功":"#96b4cc"}}')},"237f":function(t,e,a){"use strict";a("abfb")},"266a":function(t,e,a){"use strict";a("08a5")},"2ca1":function(t,e,a){},"32b1":function(t,e,a){},3558:function(t,e,a){},"3a2d":function(t,e,a){"use strict";a("3558")},"41d0":function(t,e,a){"use strict";a("32b1")},4447:function(t,e,a){},"61ff":function(t,e,a){"use strict";a("4447")},"6a4f":function(t,e,a){"use strict";a("7f7a")},7832:function(t,e,a){},"7f7a":function(t,e,a){},"82d1":function(t){t.exports=JSON.parse('{"tinymins":"茗伊战斗统计","official":"官方战斗统计"}')},"89cb":function(t,e,a){"use strict";a("2ca1")},"907f":function(t,e,a){},abfb:function(t,e,a){},ca75:function(t,e,a){"use strict";a("0cc7")},cdd5:function(t,e,a){"use strict";a("7832")},d746:function(t,e,a){"use strict";a("0d43")},da574:function(t,e,a){"use strict";a("907f")}}]);