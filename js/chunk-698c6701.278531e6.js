(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-698c6701"],{"05da":function(e,t,n){!function(t,n){e.exports=n()}(0,(function(){return function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=".",t(t.s=10)}([function(e,t,n){n(7);var i=n(5)(n(2),n(6),null,null);e.exports=i.exports},function(e,t,n){"use strict";e.exports=function(e){function t(t){t.preventDefault(),"function"==typeof e&&e(t)}function n(e){27===e.keyCode&&t(e)}var i=!1;return{get isListening(){return i},start:function(e){window.addEventListener("click",t,!0),window.addEventListener("keyup",n,!0),i=!0,"function"==typeof e&&e()},stop:function(e){window.removeEventListener("click",t,!0),window.removeEventListener("keyup",n,!0),i=!1,"function"==typeof e&&e()}}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),r=i(a);t.default={name:"context-menu",props:{id:{type:String,default:"default-ctx"}},data:function(){var e=this;return{locals:{},align:"left",ctxTop:0,ctxLeft:0,ctxVisible:!1,bodyClickListener:(0,r.default)((function(t){var n=!!e.ctxVisible,i=n&&!e.$el.contains(t.target);if(i){if(1!==t.which)return t.preventDefault(),t.stopPropagation(),!1;e.ctxVisible=!1,e.$emit("ctx-cancel",e.locals),t.stopPropagation()}else e.ctxVisible=!1,e.$emit("ctx-close",e.locals)}))}},methods:{setPositionFromEvent:function(e){var t=this;e=e||window.event;var n=document.scrollingElement||document.documentElement;return e.pageX||e.pageY?(this.ctxLeft=e.pageX,this.ctxTop=e.pageY-n.scrollTop):(e.clientX||e.clientY)&&(this.ctxLeft=e.clientX+n.scrollLeft,this.ctxTop=e.clientY+n.scrollTop),this.$nextTick((function(){var e=t.$el,n=(e.style.minHeight||e.style.height).replace("px","")||32,i=(e.style.minWidth||e.style.width).replace("px","")||32,a=e.scrollHeight||n,r=e.scrollWidth||i,s=window.innerHeight-a-25,o=window.innerWidth-r-25;t.ctxTop>s&&(t.ctxTop=s),t.ctxLeft>o&&(t.ctxLeft=o)})),e},open:function(e,t){return this.ctxVisible&&(this.ctxVisible=!1),this.ctxVisible=!0,this.$emit("ctx-open",this.locals=t||{}),this.setPositionFromEvent(e),this.$el.setAttribute("tab-index",-1),this.bodyClickListener.start(),this}},watch:{ctxVisible:function(e,t){!0===t&&!1===e&&this.bodyClickListener.stop((function(e){}))}},computed:{ctxStyle:function(){return{display:this.ctxVisible?"block":"none",top:(this.ctxTop||0)+"px",left:(this.ctxLeft||0)+"px"}}}}},function(e,t,n){t=e.exports=n(4)(void 0),t.push([e.i,'.ctx{position:relative}.ctx-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;font-size:.9rem;color:#373a3c;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid rgba(0,0,0,.15);border-radius:.25rem;-moz-box-shadow:0 0 5px #ccc;-webkit-box-shadow:0 0 5px #ccc;box-shadow:0 0 5px #ccc}.ctx-divider{height:1px;margin:.5rem 0;overflow:hidden;background-color:#e5e5e5}.ctx-item{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.5;color:#373a3c;text-align:inherit;white-space:nowrap;background:none;border:0;cursor:default}.ctx-item:focus,.ctx-item:hover{color:#2b2d2f;text-decoration:none;background-color:#f5f5f5;cursor:normal}.ctx-item.active,.ctx-item.active:focus,.ctx-item.active:hover{color:#fff;text-decoration:none;background-color:#0275d8;outline:0}.ctx-item.disabled,.ctx-item.disabled:focus,.ctx-item.disabled:hover{color:#818a91}.ctx-item.disabled:focus,.ctx-item.disabled:hover{text-decoration:none;cursor:not-allowed;background-color:transparent;background-image:none;filter:"progid:DXImageTransform.Microsoft.gradient(enabled = false)"}.open>.ctx-menu{display:block}.open>a{outline:0}.ctx-menu-right{right:0;left:auto}.ctx-menu-left{right:auto;left:0}.ctx-header{display:block;padding:3px 20px;font-size:.9rem;line-height:1.5;color:#818a91;white-space:nowrap}.ctx-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:990}.pull-right>.ctx-menu{right:0;left:auto}.ctx-menu-container{position:fixed;padding:0;border:1px solid #bbb;background-color:#f5f5f5;z-index:99999;box-shadow:0 5px 11px 0 rgba(0,0,0,.18),0 4px 15px 0 rgba(0,0,0,.15)}',""])},function(e,t){function n(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=i(a),s=a.sources.map((function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"}));return[n].concat(s).concat([r]).join("\n")}return[n].join("\n")}function i(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,"+t;return"/*# "+n+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=n(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},a=0;a<this.length;a++){var r=this[a][0];"number"==typeof r&&(i[r]=!0)}for(a=0;a<e.length;a++){var s=e[a];"number"==typeof s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(e,t){e.exports=function(e,t,n,i){var a,r=e=e||{},s=typeof e.default;"object"!==s&&"function"!==s||(a=e,r=e.default);var o="function"==typeof r?r.options:r;if(t&&(o.render=t.render,o.staticRenderFns=t.staticRenderFns),n&&(o._scopeId=n),i){var c=o.computed||(o.computed={});Object.keys(i).forEach((function(e){var t=i[e];c[e]=function(){return t}}))}return{esModule:a,exports:r,options:o}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"contextMenu",staticClass:"ctx-menu-container",style:e.ctxStyle,attrs:{id:e.id},on:{click:function(e){e.stopPropagation()},contextmenu:function(e){e.stopPropagation()}}},[n("div",{staticClass:"ctx open",staticStyle:{"background-color":"transparent"}},[n("ul",{staticClass:"ctx-menu",class:{"ctx-menu-right":"right"===e.align,"ctx-menu-left":"left"===e.align},attrs:{role:"menu"}},[e._t("default")],2)])])},staticRenderFns:[]}},function(e,t,n){var i=n(3);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),n(8)("0df30a58",i,!0)},function(e,t,n){function i(e){for(var t=0;t<e.length;t++){var n=e[t],i=u[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(s(n.parts[a]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{var r=[];for(a=0;a<n.parts.length;a++)r.push(s(n.parts[a]));u[n.id]={id:n.id,refs:1,parts:r}}}}function a(e,t){for(var n=[],i={},a=0;a<t.length;a++){var r=t[a],s=r[0],o=r[1],c=r[2],l=r[3],u={css:o,media:c,sourceMap:l};i[s]?(u.id=e+":"+i[s].parts.length,i[s].parts.push(u)):(u.id=e+":0",n.push(i[s]={id:s,parts:[u]}))}return n}function r(){var e=document.createElement("style");return e.type="text/css",d.appendChild(e),e}function s(e){var t,n,i=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]'),a=null!=i;if(a&&h)return p;if(b){var s=f++;i=m||(m=r()),t=o.bind(null,i,s,!1),n=o.bind(null,i,s,!0)}else i=i||r(),t=c.bind(null,i),n=function(){i.parentNode.removeChild(i)};return a||t(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;t(e=i)}else n()}}function o(e,t,n,i){var a=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=v(t,a);else{var r=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function c(e,t){var n=t.css,i=t.media,a=t.sourceMap;if(i&&e.setAttribute("media",i),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a=n(9),u={},d=l&&(document.head||document.getElementsByTagName("head")[0]),m=null,f=0,h=!1,p=function(){},b="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(e,t,n){h=n;var r=a(e,t);return i(r),function(t){for(var n=[],s=0;s<r.length;s++){var o=r[s],c=u[o.id];c.refs--,n.push(c)}t?(r=a(e,t),i(r)):r=[];for(s=0;s<n.length;s++){c=n[s];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete u[c.id]}}}};var v=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports=function(e,t){for(var n=[],i={},a=0;a<t.length;a++){var r=t[a],s=r[0],o=r[1],c=r[2],l=r[3],u={id:e+":"+a,css:o,media:c,sourceMap:l};i[s]?i[s].parts.push(u):n.push(i[s]={id:s,parts:[u]})}return n}},function(e,t,n){"use strict";var i=n(0);i.install=function(e){var t=e.component("context-menu",i);return t},window.VueContextMenu=i,e.exports=e.exports.default=i}])}))},"0621":function(e,t,n){var i=n("9e69"),a=n("d370"),r=n("6747"),s=i?i.isConcatSpreadable:void 0;function o(e){return r(e)||a(e)||!!(s&&e&&e[s])}e.exports=o},"07ac":function(e,t,n){"use strict";var i=n("23e7"),a=n("6f53").values;i({target:"Object",stat:!0},{values:function(e){return a(e)}})},"104f":function(e,t,n){"use strict";n("d396")},"159a":function(e,t,n){var i=n("32b3"),a=n("e2e4"),r=n("c0983"),s=n("1a8c"),o=n("f4d6");function c(e,t,n,c){if(!s(e))return e;t=a(t,e);var l=-1,u=t.length,d=u-1,m=e;while(null!=m&&++l<u){var f=o(t[l]),h=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(l!=d){var p=m[f];h=c?c(p,f,m):void 0,void 0===h&&(h=s(p)?p:r(t[l+1])?[]:{})}i(m,f,h),m=m[f]}return e}e.exports=c},"15f3":function(e,t,n){var i=n("89d9"),a=n("8604");function r(e,t){return i(e,t,(function(t,n){return a(e,n)}))}e.exports=r},"18d8":function(e,t,n){var i=n("234d"),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,s=i((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(a,(function(e,n,i,a){t.push(i?a.replace(r,"$1"):n||e)})),t}));e.exports=s},"1c3c":function(e,t,n){var i=n("9e69"),a=n("2474"),r=n("9638"),s=n("a2be"),o=n("edfa"),c=n("ac41"),l=1,u=2,d="[object Boolean]",m="[object Date]",f="[object Error]",h="[object Map]",p="[object Number]",b="[object RegExp]",v="[object Set]",g="[object String]",x="[object Symbol]",M="[object ArrayBuffer]",_="[object DataView]",k=i?i.prototype:void 0,w=k?k.valueOf:void 0;function C(e,t,n,i,k,C,y){switch(n){case _:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case M:return!(e.byteLength!=t.byteLength||!C(new a(e),new a(t)));case d:case m:case p:return r(+e,+t);case f:return e.name==t.name&&e.message==t.message;case b:case g:return e==t+"";case h:var I=o;case v:var O=i&l;if(I||(I=c),e.size!=t.size&&!O)return!1;var j=y.get(e);if(j)return j==t;i|=u,y.set(e,t);var A=s(I(e),I(t),i,k,C,y);return y["delete"](e),A;case x:if(w)return w.call(e)==w.call(t)}return!1}e.exports=C},"1d3b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA2LTE0VDA5OjEwOjAxKzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNi0xNFQxMzozMDo1NSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNi0xNFQxMzozMDo1NSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyODZlNDFiNS01OGZkLWU2NGItOGJlOS1mZDQ2YjkzNDQ3MDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozZTI4YmMyNS00Yzc5LWE4NDktYWJiMi03MDNkNzEyNmY0ZmEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozMTUxMmFiZi0yOWEzLWE4NDEtOGRlMy0xYzEwZmZiNGU2Y2YiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjMxNTEyYWJmLTI5YTMtYTg0MS04ZGUzLTFjMTBmZmI0ZTZjZiIgc3RFdnQ6d2hlbj0iMjAyMS0wNi0xNFQwOToxMDowMSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1NmJkN2M1NC1jNjc0LTJjNGEtYjQwZC1kNGNhYzcwMWVlYTgiIHN0RXZ0OndoZW49IjIwMjEtMDYtMTRUMTM6MTI6NTcrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6Mjg2ZTQxYjUtNThmZC1lNjRiLThiZTktZmQ0NmI5MzQ0NzA0IiBzdEV2dDp3aGVuPSIyMDIxLTA2LTE0VDEzOjMwOjU1KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8++Bq/JQAAAflJREFUKBVjYEAAaSkNpdrwypyLebPaf2Uv7P3vXZx2g1tQIBkox8GABlSc44LOr313/X/vme3/o/srH6TNbnmx+s7Z/wtvn/wva6q9GqiGD6aY1zY+4Or6/w//+xeknAPyQ4CYGYgFOQX5CupXzHi7/s/d/1L6GmuBYqwMvFqy02qeLvtvmu0PUiwCNoKdz52BnccJaqBzxY4pH0tOzvnPzsEezKDeFPDfdk3iH6CEN0iWUUFsnnqf5x/tPt/fLAriE0FiXBqiUxKvdf4Xddc/y6Db5v1PrsDxCVCcCYgtbHvD/k/4v/T/rP8b/tvXB/xhYGURZNSVzzBZGftfpsT9D4N6qe1buVqXV0DFAkCsa13v/2PX/6P/d/w/8d+s2PMVAyMjJxM/b5Lp+tj/Ypm2bxjEQ7SOGe+L+Q90TBnYxXxchfqV3u+1M+weAdmR4FCxENvodjX/P7eu5HwGViHOTIeD6f/NZ/m9BMq5ghQwy0rKsHHzsIENEGFrjLtV+998ftB/RmYmB0iYGMltTfzW9D9yc/pvJUvtfmFD7WxxK91S80ivLVMe7PtfdnP+f3Y+zgbkiOMXMpVZlHSh4//094f+d1xY97/5ysr/C75f+F+0cup/HmHhZgYsgJWJiytcyd1iuXNL9kubuuQXsqYaMxk42RyRFQEAHNm207cuuVAAAAAASUVORK5CYII="},2286:function(e,t,n){var i=n("85e3"),a=Math.max;function r(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){var r=arguments,s=-1,o=a(r.length-t,0),c=Array(o);while(++s<o)c[s]=r[t+s];s=-1;var l=Array(t+1);while(++s<t)l[s]=r[s];return l[t]=n(c),i(e,this,l)}}e.exports=r},"234d":function(e,t,n){var i=n("e380"),a=500;function r(e){var t=i(e,(function(e){return n.size===a&&n.clear(),e})),n=t.cache;return t}e.exports=r},2593:function(e,t,n){var i=n("15f3"),a=n("c6cf"),r=a((function(e,t){return null==e?{}:i(e,t)}));e.exports=r},"26e8":function(e,t){function n(e,t){return null!=e&&t in Object(e)}e.exports=n},"2d838":function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"j",(function(){return h})),n.d(t,"c",(function(){return r}));var i=n("41cb");function a(e){return Object(i["g"])().get("/api/team/my-game-roles",{params:e})}function r(){return Object(i["g"])().get("/api/team/my-game-roles?nopage")}function s(e){return Object(i["g"])().get("/api/team/role-unbind/"+e)}function o(){return Object(i["g"])().get("/api/team/role-bind-token")}function c(e,t){return Object(i["g"])().put("/api/team/role-update-note/".concat(e),{note:t})}function l(e){return Object(i["g"])().post("/api/team/custom-role",e)}function u(e,t){return Object(i["g"])().put("/api/team/custom-role/".concat(e),t)}function d(e){return Object(i["g"])().get("/api/team/custom-role/".concat(e))}function m(e){return Object(i["g"])().delete("/api/team/custom-role/".concat(e))}function f(e){return Object(i["g"])().put("/api/team/role-priority/".concat(e,"/top"))}function h(e){return Object(i["g"])().put("/api/team/role-priority/".concat(e,"/untop"))}},3791:function(e,t,n){},3835:function(e,t,n){"use strict";function i(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return o}));n("a4d3"),n("e01a"),n("d28b"),n("14d9"),n("d3b7"),n("3ca3"),n("ddb0");function a(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r,s,o=[],c=!0,l=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=r.call(n)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n["return"]&&(s=n["return"](),Object(s)!==s))return}finally{if(l)throw a}}return o}}var r=n("06c5");n("d9e2");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){return i(e)||a(e,t)||Object(r["a"])(e,t)||s()}},"3b1a":function(e,t,n){"use strict";n("5763")},4284:function(e,t){function n(e,t){var n=-1,i=null==e?0:e.length;while(++n<i)if(t(e[n],n,e))return!0;return!1}e.exports=n},4627:function(e,t,n){},"46d4":function(e){e.exports=JSON.parse('{"冰心诀":{"name":"冰心诀","id":10081,"force":5,"kungfuId":10,"school":4,"client":["all","std","origin"]},"云裳心经":{"name":"云裳心经","id":10080,"force":5,"kungfuId":9,"school":4,"client":["all","std","origin"]},"花间游":{"name":"花间游","id":10021,"force":2,"kungfuId":5,"school":2,"client":["all","std","origin"]},"离经易道":{"name":"离经易道","id":10028,"force":2,"kungfuId":7,"school":2,"client":["all","std","origin"]},"毒经":{"name":"毒经","id":10175,"force":6,"kungfuId":13,"school":9,"client":["all","std","origin"]},"补天诀":{"name":"补天诀","id":10176,"force":6,"kungfuId":14,"school":9,"client":["all","std","origin"]},"莫问":{"name":"莫问","id":10447,"force":22,"kungfuId":22,"school":19,"client":["all","std"]},"相知":{"name":"相知","id":10448,"force":22,"kungfuId":23,"school":19,"client":["all","std"]},"无方":{"name":"无方","id":10627,"force":212,"kungfuId":29,"school":24,"client":["all","std"]},"灵素":{"name":"灵素","id":10626,"force":212,"kungfuId":28,"school":24,"client":["all","std"]},"傲血战意":{"name":"傲血战意","id":10026,"force":3,"kungfuId":6,"school":1,"client":["all","std","origin"]},"铁牢律":{"name":"铁牢律","id":10062,"force":3,"kungfuId":8,"school":1,"client":["all","std","origin"]},"易筋经":{"name":"易筋经","id":10003,"force":1,"kungfuId":2,"school":5,"client":["all","std","origin"]},"洗髓经":{"name":"洗髓经","id":10002,"force":1,"kungfuId":1,"school":5,"client":["all","std","origin"]},"焚影圣诀":{"name":"焚影圣诀","id":10242,"force":10,"kungfuId":17,"school":8,"client":["all","std","origin"]},"明尊琉璃体":{"name":"明尊琉璃体","id":10243,"force":10,"kungfuId":18,"school":8,"client":["all","std","origin"]},"分山劲":{"name":"分山劲","id":10390,"force":21,"kungfuId":21,"school":18,"client":["all","std","origin"]},"铁骨衣":{"name":"铁骨衣","id":10389,"force":21,"kungfuId":20,"school":18,"client":["all","std","origin"]},"紫霞功":{"name":"紫霞功","id":10014,"force":4,"kungfuId":3,"school":3,"client":["all","std","origin"]},"太虚剑意":{"name":"太虚剑意","id":10015,"force":4,"kungfuId":4,"school":3,"client":["all","std","origin"]},"天罗诡道":{"name":"天罗诡道","id":10225,"force":7,"kungfuId":16,"school":10,"client":["all","std","origin"]},"惊羽诀":{"name":"惊羽诀","id":10224,"force":7,"kungfuId":15,"school":10,"client":["all","std","origin"]},"问水诀":{"name":"问水诀","id":10144,"force":8,"kungfuId":11,"school":6,"client":["all","std","origin"]},"山居剑意":{"name":"山居剑意","id":10145,"force":8,"kungfuId":11,"school":6,"client":["all","std","origin"]},"笑尘诀":{"name":"笑尘诀","id":10268,"force":9,"kungfuId":19,"school":7,"client":["all","std","origin"]},"北傲诀":{"name":"北傲诀","id":10464,"force":23,"kungfuId":24,"school":20,"client":["all","std"]},"凌海诀":{"name":"凌海诀","id":10533,"force":24,"kungfuId":25,"school":21,"client":["all","std"]},"隐龙诀":{"name":"隐龙诀","id":10585,"force":25,"kungfuId":26,"school":22,"client":["all","std"]},"太玄经":{"name":"太玄经","id":10615,"force":211,"kungfuId":27,"school":23,"client":["all","std"]},"孤锋诀":{"name":"孤锋诀","id":10698,"force":213,"kungfuId":30,"school":26,"client":["all","std"]},"山海心诀":{"name":"山海心诀","id":10756,"force":214,"kungfuId":32,"school":29,"client":["all","std"]},"周天功":{"name":"周天功","id":10786,"force":215,"kungfuId":33,"school":38,"client":["all","std"]},"通用":{"name":"通用","id":0,"force":0,"kungfuId":0,"school":0,"client":["all","std","origin"]}}')},"4b41":function(e,t,n){"use strict";n("9f1c")},"4d8c":function(e,t,n){var i=n("5c69");function a(e){var t=null==e?0:e.length;return t?i(e,1):[]}e.exports=a},"4fadc":function(e,t,n){"use strict";var i=n("23e7"),a=n("6f53").entries;i({target:"Object",stat:!0},{entries:function(e){return a(e)}})},"533b":function(e){e.exports=JSON.parse('{"mount_group":{"外攻":[10026,10015,10144,10145,10224,10268,10390,10464,10533,10585,10698,10756],"内攻":[10003,10021,10175,10014,10081,10225,10242,10447,10615,10627,10786],"坦克":[10002,10062,10243,10389],"治疗":[10448,10176,10028,10080,10626]},"mount_types":{"外功":[10026,10015,10062,10144,10145,10224,10268,10389,10390,10464,10533,10585,10698,10756],"内功":[10002,10003,10021,10175,10014,10081,10225,10242,10243,10447,10615,10627,10786,10448,10176,10028,10080,10626]}}')},5763:function(e,t,n){},"5c69":function(e,t,n){var i=n("087d"),a=n("0621");function r(e,t,n,s,o){var c=-1,l=e.length;n||(n=a),o||(o=[]);while(++c<l){var u=e[c];t>0&&n(u)?t>1?r(u,t-1,n,s,o):i(o,u):s||(o[o.length]=u)}return o}e.exports=r},"63ea":function(e,t,n){var i=n("c05f");function a(e,t){return i(e,t)}e.exports=a},"656b":function(e,t,n){var i=n("e2e4"),a=n("f4d6");function r(e,t){t=i(t,e);var n=0,r=t.length;while(null!=e&&n<r)e=e[a(t[n++])];return n&&n==r?e:void 0}e.exports=r},6648:function(e,t,n){"use strict";n("3791")},"6ccf":function(e,t,n){"use strict";n.r(t);n("b0c0");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"v-raid-view"},[t("div",{ref:"teamImage",class:e.hideBtn?"m-teamImage":"",style:e.boxsize},[t("h1",{staticClass:"m-title"},[t("i",{staticClass:"el-icon-s-flag"}),t("span",{staticClass:"u-txt"},[e._v("【"+e._s(e.data.team_name)+"】"+e._s(e.data.name))]),t("div",{staticClass:"u-op"},[e.isAdmin||e.canManage?t("el-button",{staticClass:"u-edit",attrs:{size:"mini",type:"warning",icon:"el-icon-edit",disabled:e.isOldVersion},on:{click:e.editRaid}},[e._v("编辑活动")]):e._e(),t("el-button",{staticClass:"u-back",attrs:{size:"mini",icon:"el-icon-arrow-left"},on:{click:e.goBack}},[e._v("返回列表")])],1)]),t("div",{staticClass:"m-raid-view-header"},[t("team-info",{attrs:{info:e.info,isRaid:!0,team_id:e.team_id}})],1),t("el-divider",{attrs:{"content-position":"left"}},[t("i",{staticClass:"el-icon-data-board"}),e._v(" 活动详情 ")]),e.isOldVersion?t("el-alert",{attrs:{title:"2022年4月28日起，v1旧版排表仅可读。",type:"warning","show-icon":"",closable:!1,center:""}}):e._e(),t("div",{staticClass:"m-raid-view-meta"},[t("ul",[t("li",[t("em",[e._v("开团时间")]),t("span",{staticClass:"u-time"},[e._v(e._s(e._f("showTime")(e.data.start_time)))])]),t("li",[t("em",[e._v("队长指挥")]),t("span",{staticClass:"u-leader"},[e._v(e._s(e.data.leader))])])])]),t("div",{staticClass:"m-raid-view-info"},[t("h2",{staticClass:"u-title"},[t("i",{staticClass:"el-icon-s-flag"}),e._v(" "+e._s(e.data.title)+" ")]),t("p",{staticClass:"u-desc"},[t("i",{staticClass:"el-icon-collection-tag"}),e._v(" "+e._s(e.data.desc||"无任何补充说明")+" ")])]),e.lackMounts.length?t("div",{staticClass:"m-raid-lackmount"},[e._m(0),t("div",{staticClass:"u-list"},e._l(e.lackMounts,(function(n){return t("li",{key:n.id,staticClass:"u-item"},[t("img",{staticClass:"u-icon",attrs:{src:e._f("showMountIcon")(n.id),alt:n.name}}),t("span",[e._v(e._s(n.name))]),t("span",[e._v("✔️")])])})),0)]):e._e(),e.flag?[e.isOldVersion?e._e():t("div",{staticClass:"m-raid-view-join"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-right",disabled:!e.canJoin},on:{click:e.handleShowDialog}},[e._v("预约报名")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-full-screen",disabled:!e.canJoin},on:{click:e.showMiniprogramCode}},[e._v("微信小程序")]),t("div",{staticClass:"u-tip",class:{isError:!e.canJoin}},[t("i",{staticClass:"el-icon-s-check"}),e._v(" "+e._s(e._f("showAuth")(e.data.auth))+" ")])],1),t("el-divider",{attrs:{"content-position":"left"}},[t("i",{staticClass:"el-icon-user"}),e._v(" 活动排表 ")]),t("Raid",{attrs:{count:e.data.count,"team-id":e.team_id,leader:e.data.leader,content:e.data.content,row:e.data.row,col:e.data.col,"is-public":e.data.is_public,isForceMatch:e.data.force_match},on:{updateMembers:e.handleUpdate}}),t("join-pop",{attrs:{title:"预约报名",auth:e.data.auth,client:e.client},on:{confirm:e.handleConfrim},model:{value:e.joinShow,callback:function(t){e.joinShow=t},expression:"joinShow"}})]:e._e(),t("el-dialog",{staticClass:"m-wx-dialog",attrs:{visible:e.miniprogramCode,width:"255px",center:"",top:"30vh"},on:{"update:visible":function(t){e.miniprogramCode=t}}},[t("el-image",{staticClass:"wx-code",attrs:{src:e.miniprogramCodeUrl}})],1)],2),e.hideBtn?t("div",{style:e.boxsize}):e._e()])},a=[function(){var e=this,t=e._self._c;return t("h2",{staticClass:"u-title"},[t("i",{staticClass:"el-icon-success"}),e._v(" 以下职业无冲突")])}],r=n("c7eb"),s=n("ade3"),o=n("1da1"),c=n("5530"),l=(n("4de4"),n("caad"),n("d81d"),n("14d9"),n("e9f5"),n("910d"),n("ab43"),n("a9e3"),n("b64b"),n("d3b7"),n("07ac"),n("6062"),n("1e70"),n("79a4"),n("c1a1"),n("8b00"),n("a4e7"),n("1e5a"),n("72c3"),n("2532"),n("3ca3"),n("ddb0"),n("c0e9")),u=n.n(l),d=n("d174"),m=n("681e"),f=n("c9d2"),h=n("3682"),p=n("0e81"),b=n("65c2"),v=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"m-raid-core"},[e.isPublic||e.isTeammate?[e.content?t("raid-normal-v1",{staticClass:"m-raid-normal",attrs:{header:"正式队员",mode:"normal",teamId:e.teamId,leader:e.leader,row:e.row,col:e.col},on:{updateMembers:e.updateMembers},model:{value:e.members,callback:function(t){e.members=t},expression:"members"}}):t("raid-normal-v2",{attrs:{header:"正式队员",mode:"normal",teamId:e.teamId,leader:e.leader,row:e.row,col:e.col,id:e.id},on:{update:e.loadMembers,updateMembers:e.updateMembers},model:{value:e.members,callback:function(t){e.members=t},expression:"members"}}),e.id&&!e.content?t("raid-sub",{ref:"subRaid",staticClass:"m-raid-sub",attrs:{header:"替补队员",mode:"sub",teamId:e.teamId,id:e.id,isForceMatch:e.isForceMatch,canAdd:e.canAdd,canReplace:e.canReplace},on:{pass:e.handlePass}}):e._e(),e.id&&!e.content?t("raid-tobe",{staticClass:"m-raid-tobe",attrs:{header:"候选名单",mode:"tobe",teamId:e.teamId,id:e.id,isForceMatch:e.isForceMatch,canAdd:e.canAdd,canReplace:e.canReplace},on:{pass:e.handlePass,pending:e.handlePending}}):e._e()]:t("el-alert",{attrs:{title:"当前活动为私有活动，仅团队成员可见",type:"warning",center:"","show-icon":""}})],2)},g=[],x=(n("c740"),n("4e82"),n("2ef0")),M=n.n(x),_=n("9313"),k=n("79bb"),w=function(){var e=this,t=e._self._c;return t("div",{on:{"!blur":function(t){return e.spanBlur.apply(null,arguments)}}},[e._m(0),e.members&&e.members.length?t("div",{staticClass:"m-raid-corebox",class:{qkmode:e.canManage}},[t("div",{staticClass:"m-raid-flag"},e._l(e.col,(function(n){return t("i",{key:n,staticClass:"i-flag"},[e._v(e._s(n))])})),0),t("draggable",e._b({staticClass:"m-raid-members",class:"row-"+e.row,attrs:{tag:"ul",handle:".u-member",animation:100,draggable:!1},model:{value:e.members,callback:function(t){e.members=t},expression:"members"}},"draggable",Object(c["a"])(Object(c["a"])({},e.drag_options),{},{sort:e.canManage}),!1),[e._l(e.members,(function(i,a){return t("div",{key:a,staticClass:"u-member",class:{"is-group-start":e.isGroupStart(a)},on:{contextmenu:function(t){return t.preventDefault(),function(t){return e.handleContextMenuOpen(t,{member:i,i:a})}.apply(null,arguments)}}},[e.isGroupStart(a,e.row)?t("i",{staticClass:"u-group-start"},[e._v(e._s(e.isGroupStart(a,e.row)))]):e._e(),t("span",{staticClass:"u-member-func"},[e._v(e._s(e.roleFunc(i.role_func)))]),e.isLeader(i)||!e.leader&&0===a?t("img",{staticClass:"u-member-leader",attrs:{src:n("8535"),alt:"leader",title:"队长"}}):e._e(),e.isCore(i)?t("img",{staticClass:"u-member-core",attrs:{src:n("1d3b"),alt:"core",title:"阵眼"}}):e._e(),t("span",{staticClass:"u-member-primary"},[e.canManage?t("el-popover",{attrs:{"popper-class":"m-raid-members-xfbox",placement:"top",trigger:"click","popper-options":{boundariesElement:"body"}}},[t("div",{staticClass:"u-xf-content"},e._l(e.xf_map,(function(n){return t("span",{key:n.id,on:{click:function(t){return e.changeMemberXf(i,n.id)}}},[t("img",{staticClass:"u-member-icon",class:{"u-selected-member-icon":i.mount===n.id},attrs:{src:e._f("showMountIcon")(n.id),alt:n.name,title:n.name}})])})),0),t("img",{staticClass:"u-member-icon",attrs:{slot:"reference",src:e._f("showMountIcon")(i["mount"]),alt:e._f("showMountName")(i["mount"])},slot:"reference"})]):t("img",{staticClass:"u-member-icon",attrs:{src:e._f("showMountIcon")(i["mount"]),alt:e._f("showMountName")(i["mount"])}}),t("span",{staticClass:"u-member-role"},[i.role_id&&!e.editing[a]&&e.linkVisible?t("router-link",{staticClass:"u-member-name-link",attrs:{tag:"a",target:"_blank",to:"/role/".concat(i.role_id)}},[t("i",{staticClass:"el-icon-link"})]):e._e(),e.editing[a]?e._e():t("span",{staticClass:"u-member-name"},[e._v(e._s(e.showMemberName(i["name"])))]),t("el-select",{directives:[{name:"show",rawName:"v-show",value:e.editing[a],expression:"editing[i]"}],ref:"name"+a,refInFor:!0,staticStyle:{width:"160px"},attrs:{placeholder:"请选择或输入团员名","allow-create":"",filterable:"",remote:"",clearable:"",size:"mini","remote-method":e.remoteMethod,loading:e.loading},on:{change:e.handleMemberChange},model:{value:e.tempMember.name,callback:function(t){e.$set(e.tempMember,"name",t)},expression:"tempMember.name"}},e._l(e.roles,(function(n,i){return t("el-option",{key:i,attrs:{label:n.name,value:n.ID}},[t("div",{staticStyle:{display:"inline-flex","align-items":"center"}},[t("img",{staticStyle:{"margin-right":"8px"},attrs:{width:"24",height:"24",src:e._f("showSchoolIcon")(n.mount)}}),t("span",[e._v(e._s(n.name))])])])})),1)],1),i["remark"]&&!e.editing[a]?t("span",{staticClass:"u-member-remark"},[e._v("["+e._s(i["remark"])+"]")]):e._e()],1)])})),e.members.length>0&&e.members.length<e.row*e.col?t("div",{staticClass:"u-member u-member-add",attrs:{title:"新增队员"},on:{click:function(t){return e.handleAdd("add")}}},[t("i",{staticClass:"el-icon-plus u-member-add-icon"})]):e._e()],2)],1):t("div",{staticClass:"m-raid-null"},[t("i",{staticClass:"el-icon-warning-outline"}),e._v(" 当前没有任何名单 ")]),t("member-setting",{attrs:{title:e.title,visible:e.visible,data:e.selectedMember,teamId:e.teamId,mode:"normal"},on:{close:e.handleDialogCancel,updateRole:e.handleSave}}),t("contextMenu",{ref:"ctxMenu",staticClass:"m-raid-contextmenu",attrs:{id:"cotext-menu"},on:{"ctx-open":e.onCtxOpen}},[t("div",{staticClass:"item",on:{click:e.setEdit}},[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 编辑角色 ")]),t("div",{staticClass:"item",on:{click:e.setCore}},[t("i",{staticClass:"el-icon-star-off"}),e._v(" "+e._s(e.selectedMember&&e.selectedMember.is_core?"取消阵眼":"设为阵眼")+" ")]),t("div",{staticClass:"item",on:{click:e.setRemark}},[t("i",{staticClass:"el-icon-edit"}),e._v(" "+e._s(e.selectedMember&&e.selectedMember.remark?"修改备注":"添加备注")+" ")])])],1)},C=[function(){var e=this,t=e._self._c;return t("h5",{staticClass:"u-title"},[t("span",[t("i",{staticClass:"el-icon-s-flag"}),e._v(" 正式队员 ")])])}],y=n("3835"),I=(n("fb6a"),n("a434"),n("a732"),function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,visible:e.dialogVisivble,width:"720px"},on:{close:e.handleCancel}},[t("el-form",{ref:"roleForm",staticClass:"u-role-setting",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":e.position}},[t("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[["normal","sub"].includes(e.mode)?e._e():t("el-input",{staticClass:"u-name",attrs:{placeholder:"请输入角色名称",disabled:!e.canEdit},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),t("el-input",{staticClass:"u-role-setting-member",attrs:{placeholder:"请输入团员名称",disabled:!!e.form.role_id||!e.canEdit},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[t("el-select",{attrs:{slot:"append","popper-class":"m-raid-pop-member-select","popper-append-to-body":"",disabled:!!e.form.role_id||!e.canEdit},on:{change:e.handleChange},slot:"append",model:{value:e.tmpVal,callback:function(t){e.tmpVal=t},expression:"tmpVal"}},e._l(e.roles,(function(n,i){return t("el-option",{key:i,attrs:{label:n.name,value:n.ID}},[t("div",{staticStyle:{display:"inline-flex","align-items":"center"}},[t("img",{staticStyle:{"margin-right":"8px"},attrs:{width:"24",height:"24",src:e._f("showSchoolIcon")(n.mount)}}),t("span",[e._v(e._s(n.name))])])])})),1)],1),e.form.role_id?t("el-button",{staticClass:"u-remove-role",attrs:{disabled:!e.canEdit,type:"text",icon:"el-icon-circle-close"},on:{click:e.removeRole}}):e._e()],1),t("el-form-item",{attrs:{label:"指定心法",prop:"mount"}},[t("el-select",{attrs:{placeholder:"请选择心法",filterable:""},model:{value:e.form.mount,callback:function(t){e.$set(e.form,"mount",t)},expression:"form.mount"}},e._l(e.xfMaps,(function(n){return t("el-option",{key:n.id,attrs:{value:n.id,label:n.name}},[t("div",{staticStyle:{display:"inline-flex","align-items":"center"}},[t("img",{staticStyle:{"margin-right":"8px"},attrs:{width:"24",height:"24",src:e._f("showMountIcon")(n.id)}}),t("span",[e._v(e._s(n.name))])])])})),1)],1),t("el-form-item",{attrs:{label:"备注内容",prop:"remark"}},[t("el-input",{attrs:{"show-word-limit":"",maxlength:20,placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),"normal"===e.mode?void 0:e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:e.handleSave}},[e._v("保存")]),t("el-button",{on:{click:e.handleCancel}},[e._v("取消")])],1)],2)],1)}),O=[],j=(n("7db0"),n("f665"),n("46d4")),A=n("533b"),R=n("0644"),S=n.n(R),N=n("2593"),D=n.n(N),G={role_func:"",name:"",mount:"",is_core:!1,pending:[],remark:"",role_id:0},T={name:"MemberSetting",props:["data","teamId","mode","title","visible","members","max"],data:function(){return{position:window.innerWidth<768?"top":"left",form:{role_func:"",name:"",mount:"",is_core:!1,pending:[],remark:"",role_id:0},rules:{},roles:[],substitute:[],loading:!1,addLoading:!1,selectedSchool:0,tmpVal:"",mountg:A}},computed:{dialogVisivble:function(){return this.visible},xfMaps:function(e){var t=e.selectedSchool;if(t){var n={};for(var i in j)j[i].school===this.selectedSchool&&(n[i]=j[i]);return Object.values(n)}return Object.values(j)},allRoles:function(){return this.$store.state.roles},isMaxCount:function(){var e;return(null===(e=this.members)||void 0===e?void 0:e.filter((function(e){return e.remark||e.mount||e.role_id||e.name})).length)>=this.max},raidId:function(){return this.$route.params.id},canEdit:function(){var e;return this.data&&0===(null===(e=this.data)||void 0===e?void 0:e.is_member_request)||!this.data}},watch:{data:{deep:!0,handler:function(e){if(e)for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];this.form[i]=e[i]}}},dialogVisivble:function(e){e&&(this.roles=S()(this.allRoles))}},methods:{handleSave:function(){var e=this;if(this.data)if(this.data.id){var t=D()(this.form,["name","mount","remark"]);t.role_id=this.form.role_id||null,t.order=this.data.order,Object(h["A"])(this.raidId,this.data.id,t).then((function(){e.$emit("updateRole",t)}))}else{var n;this.add(null===(n=this.data)||void 0===n?void 0:n.order)}else this.isMaxCount?this.$notify({title:"提示",message:"成员数已达模板上限，不能继续添加",type:"warning"}):(this.addLoading=!0,this.add())},add:function(e){var t=this,n="normal"===this.mode?h["a"]:h["d"],i=D()(this.form,["name","remark"]);if(this.form.role_id&&(i.role_id=this.form.role_id),"normal"===this.mode){var a,r=null===(a=this.members)||void 0===a?void 0:a.find((function(e){return e.is_virtual}));if(r)i.order=e||r.order;else{var s,o=null===(s=this.members)||void 0===s?void 0:s.find((function(e){return 0===e.is_valid}));o&&(i.order=o.order)}}i.mount=~~this.form.mount,n(this.raidId,i).then((function(e){t.$emit("updateRole",e.data.data),t.form=S()(G),t.selectedSchool=0})).finally((function(){t.addLoading=!1}))},handleCancel:function(){this.roles=S()(this.allRoles),this.form=S()(G),this.$emit("close")},handleChange:function(e){this.form.role_id=0;var t=this.roles?this.roles.filter((function(t){return t.ID===e})):[],n=Object(y["a"])(t,1),i=n[0];i&&(this.form.name=i.name,this.form.role_id=i.ID,this.selectedSchool=~~i.mount,this.form.mount=this.xfMaps[0].id)},remoteMethod:function(e){var t,n=this;""!==e?(Object(h["p"])(this.teamId,e).then((function(e){n.roles=e.data.data.list,n.loading=!1})),null!==(t=this.roles)&&void 0!==t&&t.some((function(e){return e.name===n.form.name}))&&(this.selectedSchool=0)):(this.roles=S()(this.allRoles),this.selectedSchool=0)},handleClear:function(){this.roles=S()(this.allRoles),this.selectedSchool=0},handleNameInput:function(e){this.remoteMethod(e)},removeRole:function(){this.form.role_id="",this.form.name="",this.form.mount="",this.selectedSchool=0}}},E=T,Z=(n("ad32"),n("2877")),L=Object(Z["a"])(E,I,O,!1,null,null,null),$=L.exports,Y=n("33a5"),z=n("b76a"),B=n.n(z),W=n("05da"),F=n.n(W),V={role_func:"",name:"",mount:"",is_core:!1,pending:[],remark:"",role_id:0},P={name:"RaidNormal",props:["data","teamId","leader","row","col"],components:{MemberSetting:$,draggable:B.a,contextMenu:F.a},data:function(){return{members:[],visible:!1,title:"新增队员",selectedMember:null,selectedIndex:void 0,action:"",drag_options:{handle:".u-member"},roles:[],editing:{},tempMember:{role_func:"",name:"",mount:"",is_core:!1,pending:[],remark:"",role_id:0},xf_map:j,loading:!1}},computed:{isEditing:function(){return Object.values(this.editing).some((function(e){return e}))},routerName:function(){return this.$route.name},canManage:function(){return this.$store.state.canManage},linkVisible:function(){return this.$store.state.isTeammate},allRoles:function(){return this.$store.state.roles}},methods:{handleSetting:function(e,t){this.title="角色设置",this.selectedMember=e,this.selectedIndex=t,this.visible=!0},handleDialogCancel:function(){this.visible=!1,this.selectedMember=null,this.action=""},handleReset:function(e){this.$set(this.members,e,S()(V))},handleDelete:function(e){this.members.splice(e,1)},pending:function(e,t){this.$bus.$emit("pending",e),this.$set(this.members,t,S()(V))},handleAdd:function(){this.members.push(S()(V))},handleButtonAdd:function(e){this.title="新增队员",this.action=e,this.selectedMember=null,this.visible=!0},handleDraggableUpdate:function(){this.$emit("updateMembers",this.members)},isLeader:function(e){return this.leader&&this.leader===e.name},isCore:function(e){return e.is_core},roleFunc:function(e){switch(e){case"内攻":return"内";case"外攻":return"外";case"坦克":return"坦";case"治疗":return"奶";default:return""}},isGroupStart:function(e,t){if((e+t)%t==0)return(e+t)/t},showMemberName:function(e){return this.linkVisible||!e?e:e.slice(0,1)+"******"},onCtxOpen:function(e){var t=e.member,n=e.i;this.selectedMember=t,this.selectedIndex=n},handleContextMenuOpen:function(e,t){!this.isEditing&&this.canManage&&this.$refs.ctxMenu.open(e,Object(c["a"])({},t))},setEdit:function(){this.title="角色设置",this.visible=!0},setCore:function(){this.selectedMember.is_core=!this.selectedMember.is_core,this.$set(this.members,this.selectedIndex,this.selectedMember),this.selectedMember=null},setRemark:function(){var e=this;this.$prompt("请输入备注","",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.selectedMember.remark,inputValidator:function(e){if(e.length>20)return"备注内容应不超过20个字符"}}).then((function(t){var n=t.value;e.selectedMember.remark=n,e.$set(e.members,e.selectedIndex,e.selectedMember),e.handleTranform(e.selectedMember,e.selectedIndex,"remark"),e.selectedMember=null}))},changeMemberXf:function(e,t){e.mount=String(t)},handleChangeName:function(e,t){this.canManage&&(this.tempMember=S()(e),this.selectedIndex=t,this.$set(this.editing,t,!0))},handleChangeNameBlur:function(e){this.$set(this.editing,e,!1),this.roles=S()(this.allRoles)},handleMemberChange:function(e){var t=this;if(this.tempMember.name){this.tempMember.role_id=0;var n=this.roles?this.roles.filter((function(t){return t.ID===e})):[],i=Object(y["a"])(n,1),a=i[0];a&&(this.tempMember.name=a.name,this.tempMember.role_id=a.ID,this.tempMember.mount=String(Y[a.mount][0])),this.$set(this.members,this.selectedIndex,this.tempMember),this.$nextTick((function(){t.tempMember=V,t.$refs["name".concat(t.selectedIndex)][0].blur(),t.editing[t.selectedIndex]=!1,t.selectedIndex=void 0}))}},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,Object(h["p"])(this.teamId,e).then((function(e){t.roles=e.data.data.list,t.loading=!1}))):this.roles=S()(this.allRoles)},spanBlur:function(){this.editing={}},handleSave:function(e){var t=this.action;"add"===t&&(this.members.length<this.col*this.row?this.members.push(e):this.$message({type:"warning",message:"成员数已达模板上限，不能继续添加"})),t||this.$set(this.members,this.selectedIndex,e),this.selectedMember=null,this.visible=!1}},model:{prop:"data",event:"updateMembers"},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.members=e}},members:{deep:!0,handler:function(e){this.$emit("updateMembers",e)}},col:function(e){this.$forceUpdate()},allRoles:{deep:!0,handler:function(e){e&&(this.roles=S()(e))}}}},U=P,J=Object(Z["a"])(U,w,C,!1,null,null,null),X=J.exports,Q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-raid-tobebox m-raid-normalbox",on:{"!blur":function(t){return e.spanBlur.apply(null,arguments)}}},[t("h5",{staticClass:"u-title"},[t("span",[t("i",{staticClass:"el-icon-s-flag"}),e._v(" 正式队员 "),t("span",{staticClass:"u-count"},[e._v("("+e._s(e.count)+")")]),t("span",{staticClass:"u-mount-group"},e._l(e.raidMountGroup,(function(n,i){return t("span",{key:i,staticClass:"u-count u-item"},[e._v(e._s(i)+"："+e._s(n.length||0))])})),0)]),t("div",[e.canManage?t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleButtonAdd("add")}}},[e._v("添加队员")]):e._e()],1)]),e.members&&e.members.length?t("div",{staticClass:"m-raid-corebox m-raid-normal",class:{qkmode:e.canManage}},[t("div",{staticClass:"m-raid-flag"},e._l(e.col,(function(n){return t("i",{key:n,staticClass:"i-flag"},[e._v(e._s(n))])})),0),t("draggable",e._b({staticClass:"m-raid-members",class:"row-"+e.row,attrs:{tag:"ul",handle:".u-member",animation:100},model:{value:e.members,callback:function(t){e.members=t},expression:"members"}},"draggable",Object(c["a"])(Object(c["a"])({},e.drag_options),{},{sort:e.canManage}),!1),[e._l(e.members,(function(i,a){return t("div",{key:a,staticClass:"u-member",class:{"is-group-start":e.isGroupStart(a)},on:{contextmenu:function(t){return t.preventDefault(),function(t){return e.handleContextMenuOpen(t,{member:i,i:a})}.apply(null,arguments)}}},[t("span",{staticClass:"u-member-func"},[e._v(e._s(e.roleFunc(i.role_func)))]),e.isLeader(i)||!e.leader&&0===a?t("img",{staticClass:"u-member-leader",attrs:{src:n("8535"),alt:"leader",title:"队长"}}):e._e(),e.isCore(i)?t("img",{staticClass:"u-member-core",attrs:{src:n("1d3b"),alt:"core",title:"阵眼"}}):e._e(),t("span",{staticClass:"u-member-primary"},[t("img",{staticClass:"u-member-icon",attrs:{src:e._f("showMountIcon")(i["mount"]),alt:e._f("showMountName")(i["mount"])}}),t("span",{staticClass:"u-member-role"},[i.role_id&&!e.editing[a]&&e.linkVisible?t("router-link",{staticClass:"u-member-name-link",attrs:{tag:"a",target:"_blank",to:"/role/".concat(i.role_id)}},[t("i",{staticClass:"el-icon-link"})]):e._e(),e.editing[a]?e._e():t("span",{staticClass:"u-member-name"},[e._v(e._s(e.showMemberName(i["name"])))]),t("el-select",{directives:[{name:"show",rawName:"v-show",value:e.editing[a],expression:"editing[i]"}],ref:"name"+a,refInFor:!0,staticStyle:{width:"160px"},attrs:{placeholder:"请选择或输入团员名","allow-create":"",filterable:"",remote:"",clearable:"",size:"mini","remote-method":e.remoteMethod,loading:e.loading},on:{change:e.handleMemberChange},model:{value:e.tempMember.name,callback:function(t){e.$set(e.tempMember,"name",t)},expression:"tempMember.name"}},e._l(e.roles,(function(n,i){return t("el-option",{key:i,attrs:{label:n.name,value:n.ID}},[t("div",{staticStyle:{display:"inline-flex","align-items":"center"}},[t("img",{staticStyle:{"margin-right":"8px"},attrs:{width:"24",height:"24",src:e._f("showSchoolIcon")(n.mount)}}),t("span",[e._v(e._s(n.name))])])])})),1)],1),i["remark"]&&!e.editing[a]?t("span",{staticClass:"u-member-remark"},[e._v("["+e._s(i["remark"])+"]")]):e._e()]),e.canManage?t("span",{staticClass:"u-member-op"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置",placement:"top-start"}},[t("i",{staticClass:"u-member-setting el-icon-setting",on:{click:function(t){return e.handleSetting(i,a)}}})]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设为替补队员",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否将该角色转为替补成员？"},on:{confirm:function(t){return e.pending(i,a)}}},[t("i",{staticClass:"u-member-reset el-icon-first-aid-kit",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否删除该角色？"},on:{confirm:function(t){return e.remove(i,a)}}},[t("i",{staticClass:"u-member-delete el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1)],1):e._e()])})),e.members.length>0&&e.members.length<e.row*e.col?t("div",{staticClass:"u-member u-member-add",attrs:{title:"新增队员"},on:{click:function(t){return e.handleAdd("add")}}},[t("i",{staticClass:"el-icon-plus u-member-add-icon"})]):e._e()],2)],1):t("div",{staticClass:"m-raid-null"},[t("i",{staticClass:"el-icon-warning-outline"}),e._v(" 当前没有任何名单")]),t("member-setting",{attrs:{title:e.title,visible:e.visible,data:e.selectedMember,teamId:e.teamId,members:e.members,max:e.col*e.row,mode:"normal"},on:{close:e.handleDialogCancel,updateRole:e.handleSave}}),t("contextMenu",{ref:"ctxMenu",staticClass:"m-raid-contextmenu",attrs:{id:"cotext-menu"},on:{"ctx-open":e.onCtxOpen}},[t("div",{staticClass:"item",on:{click:e.setEdit}},[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 编辑 ")]),t("div",{staticClass:"item",on:{click:function(t){return e.pending(e.selectedMember,e.selectedIndex)}}},[t("i",{staticClass:"el-icon-first-aid-kit"}),e._v(" 替补 ")]),t("div",{staticClass:"item",on:{click:function(t){return e.remove(e.selectedMember,e.selectedIndex)}}},[t("i",{staticClass:"el-icon-delete"}),e._v(" 删除 ")])])],1)},H=[],K=(n("a630"),n("7d54"),n("4fadc"),n("159b"),n("63ea")),q=n.n(K),ee={role_func:"",name:"",mount:"",remark:"",role_id:null,order:0,is_virtual:!0,is_member_request:0},te={name:"RaidNormal",props:["data","teamId","leader","row","col","id"],components:{MemberSetting:$,draggable:B.a,contextMenu:F.a},data:function(){return{members:[],visible:!1,title:"新增队员",selectedMember:null,selectedIndex:void 0,action:"",drag_options:{handle:".u-member"},order:[],roles:[],editing:{},tempMember:{role_func:"",name:"",mount:"",is_core:!1,pending:[],remark:"",role_id:0},xf_map:j,loading:!1,canDrag:!1}},computed:{raid_id:function(){return this.id},isEditing:function(){return Object.values(this.editing).some((function(e){return e}))},routerName:function(){return this.$route.name},canManage:function(){return this.$store.state.canManage},linkVisible:function(){return this.$store.state.isTeammate},allRoles:function(){return this.$store.state.roles},memberOrder:function(){return this.$store.state.memberOrder},count:function(){return this.data.filter((function(e){return e.is_valid})).length},raidMountGroup:function(){var e=this,t={};return Object.entries(A["mount_group"]).forEach((function(n){var i=Object(y["a"])(n,2),a=i[0],r=i[1];e.members.forEach((function(e){e.mount&&e.is_valid&&r.includes(e.mount)&&(t[a]=t[a]||[],t[a].push(e))}))})),t}},methods:{handleSetting:function(e,t){this.title="角色设置",this.selectedMember=e,this.selectedIndex=t,this.visible=!0},handleDialogCancel:function(){this.visible=!1,this.selectedMember=null,this.action=""},remove:function(e,t){var n=this;if(e.is_virtual&&(null===e||void 0===e||!e.id))return this.$notify({title:"操作成功",message:"删除成功",type:"success"}),void this.members.splice(t,1,S()(ee));Object(h["v"])(this.raid_id,null===e||void 0===e?void 0:e.id).then((function(){n.$notify({title:"操作成功",message:"删除成功",type:"success"}),n.members.splice(t,1,S()(ee))}))},pending:function(e,t){var n=this;e.is_virtual||(this.$bus.$emit("pending",e),Object(h["f"])(this.raid_id,e.id).then((function(){n.members.splice(t,1,S()(ee))})))},handleAdd:function(){this.members.push(S()(ee))},handleButtonAdd:function(e){this.title="新增队员",this.action=e,this.selectedMember=null,this.visible=!0},handleSort:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h["z"])(e.raid_id,e.order);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},isLeader:function(e){return this.leader&&this.leader===e.name},isCore:function(e){return e.is_core},roleFunc:function(e){switch(e){case"内攻":return"内";case"外攻":return"外";case"坦克":return"坦";case"治疗":return"奶";default:return""}},isGroupStart:function(e,t){if((e+t)%t==0)return(e+t)/t},showMemberName:function(e){return this.linkVisible||!e?e:e.slice(0,1)+"******"},onCtxOpen:function(e){var t=e.member,n=e.i;this.selectedMember=t,this.selectedIndex=n},handleContextMenuOpen:function(e,t){!this.isEditing&&this.canManage&&this.$refs.ctxMenu.open(e,Object(c["a"])({},t))},setEdit:function(){this.title="角色设置",this.visible=!0},setCore:function(){this.selectedMember.is_core=!this.selectedMember.is_core,this.$set(this.members,this.selectedIndex,this.selectedMember),this.selectedMember=null},setRemark:function(){var e=this;this.$prompt("请输入备注","",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.selectedMember.remark,inputValidator:function(e){if(e.length>20)return"备注内容应不超过20个字符"}}).then((function(t){var n=t.value;e.selectedMember.remark=n,e.$set(e.members,e.selectedIndex,e.selectedMember),e.handleTransform(e.selectedMember,e.selectedIndex,"remark"),e.selectedMember=null}))},changeMemberXf:function(e,t){e.mount=String(t)},handleChangeName:function(e,t){this.canManage&&(this.tempMember=S()(e),this.selectedIndex=t,this.$set(this.editing,t,!0))},handleChangeNameBlur:function(e){this.$set(this.editing,e,!1),this.roles=S()(this.allRoles)},handleMemberChange:function(e){var t=this;if(this.tempMember.name){this.tempMember.role_id=0;var n=this.roles?this.roles.filter((function(t){return t.ID===e})):[],i=Object(y["a"])(n,1),a=i[0];a&&(this.tempMember.name=a.name,this.tempMember.role_id=a.ID,this.tempMember.mount=String(Y[a.mount][0])),this.$set(this.members,this.selectedIndex,this.tempMember),this.$nextTick((function(){t.tempMember=ee,t.$refs["name".concat(t.selectedIndex)][0].blur(),t.editing[t.selectedIndex]=!1,t.selectedIndex=void 0}))}},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,Object(h["p"])(this.teamId,e).then((function(e){t.roles=e.data.data.list,t.loading=!1}))):this.roles=S()(this.allRoles)},spanBlur:function(){this.editing={}},handleSave:function(e){var t=this.action;if("add"===t){var n=this.members.findIndex((function(e){return e.is_virtual}));if(n>-1)this.$set(this.members,n,e);else{var i=this.members.findIndex((function(e){return 0===e.is_valid}));i&&this.$set(this.members,i,e)}}t||this.$set(this.members,this.selectedIndex,e),this.$emit("update"),this.selectedMember=null,this.visible=!1}},model:{prop:"data",event:"updateMembers"},watch:{data:{immediate:!0,deep:!0,handler:function(e){if(e){var t=Array.from({length:this.col*this.row},(function(e,t){return Object(c["a"])(Object(c["a"])({},ee),{},{order:t+1})})).map((function(t,n){var i=e[n];return i||t}));this.members=t}}},members:{immediate:!0,deep:!0,handler:function(e){if(e&&e.length){var t=e.map((function(e,t){return Object(c["a"])(Object(c["a"])({},e),{},{order:t+1})})).filter((function(e){return e.id})).map((function(e){return{id:e.id,order:e.order}}));this.order=t}}},order:{deep:!0,handler:function(){!q()(this.order,this.memberOrder)&&this.canManage&&this.handleSort()}},col:function(){this.$forceUpdate()},allRoles:{deep:!0,handler:function(e){e&&(this.roles=S()(e))}}}},ne=te,ie=Object(Z["a"])(ne,Q,H,!1,null,null,null),ae=ie.exports,re=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-raid-tobebox m-raid-subbox"},[t("h5",{staticClass:"u-title"},[t("span",[t("i",{staticClass:"el-icon-first-aid-kit"}),e._v(" 替补队员 "),t("span",{staticClass:"u-count"},[e._v("("+e._s(e.count)+")")])]),e.canManage?t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleButtonAdd("add")}}},[e._v("添加替补")]):e._e()],1),e.data&&e.data.length?t("div",{staticClass:"m-raid-corebox"},[t("ul",{staticClass:"m-raid-members"},e._l(e.data,(function(n,i){return t("div",{key:i,staticClass:"u-member",on:{contextmenu:function(t){return t.preventDefault(),function(t){return e.handleContextMenuOpen(t,{member:n,i:i})}.apply(null,arguments)}}},[t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover","popper-class":"m-raid-members__sub-item"}},[t("member-pop",{attrs:{member:n}}),t("span",{staticClass:"u-member-primary",attrs:{slot:"reference"},slot:"reference"},[t("img",{staticClass:"u-member-icon",attrs:{src:e._f("showMountIcon")(n["mount"]),alt:e._f("showMountName")(n["mount"])}}),t("span",{staticClass:"u-member-role"},[n.role_id&&e.linkVisible?t("router-link",{staticClass:"u-member-name-link",attrs:{tag:"a",target:"_blank",to:"/role/".concat(n.role_id)}},[t("i",{staticClass:"el-icon-link"})]):e._e(),t("span",{staticClass:"u-member-name"},[e._v(e._s(e.showMemberName(n["name"])))])],1),n["remark"]?t("span",{staticClass:"u-member-remark"},[e._v("["+e._s(n["remark"])+"]")]):e._e()])],1),e.canManage?t("span",{staticClass:"u-member-op"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置",placement:"top-start"}},[t("i",{staticClass:"u-member-setting el-icon-setting",on:{click:function(t){return e.handleSetting(n,i)}}})]),t("el-tooltip",{attrs:{clss:"item",effect:"dark",content:"转为正式成员",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否将该角色转为正式成员？"},on:{confirm:function(t){return e.pass(n,i)}}},[t("i",{staticClass:"u-member-reset el-icon-check",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否删除该角色？"},on:{confirm:function(t){return e.remove(n,i)}}},[t("i",{staticClass:"u-member-delete el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1)],1):e._e()],1)})),0)]):t("div",{staticClass:"m-raid-null"},[t("i",{staticClass:"el-icon-warning-outline"}),e._v(" 当前没有任何名单")]),t("member-setting",{attrs:{title:e.title,visible:e.visible,data:e.selectedMember,teamId:e.teamId,mode:"sub"},on:{close:e.handleDialogCancel,updateRole:e.handleSave}}),t("contextMenu",{ref:"ctxMenu",staticClass:"m-raid-contextmenu",attrs:{id:"cotext-menu"},on:{"ctx-open":e.onCtxOpen}},[t("div",{staticClass:"item",on:{click:e.setEdit}},[t("i",{staticClass:"el-icon-edit-outline"}),e._v(" 编辑 ")]),t("div",{staticClass:"item",on:{click:e.setPass}},[t("i",{staticClass:"el-icon-check"}),e._v(" 转正 ")]),t("div",{staticClass:"item",on:{click:function(t){return e.remove(e.selectedMember,e.selectedIndex)}}},[t("i",{staticClass:"el-icon-delete"}),e._v(" 删除 ")])])],1)},se=[],oe=n("2909"),ce=(n("99af"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"u-member-pop"},[t("a",{staticClass:"u-member-user",attrs:{href:e.showMemberLink(e.member),target:"_blank"}},[t("img",{staticClass:"u-member-avatar",attrs:{src:e.showMemberAvatar(e.member)}}),t("span",{staticClass:"u-member-username"},[e._v(e._s(e.showMemberUsername(e.member)))])]),t("div",{staticClass:"u-member-time"},[t("i",{staticClass:"el-icon-time"}),t("span",{staticClass:"u-member-time-label"},[e._v("申请时间")]),e._v(e._s(e.formatApplyTime(e.member))+" ")]),t("div",{staticClass:"u-member-desc"},[e._v(e._s(e.member["remark"]))])])}),le=[],ue=n("85e4"),de=n("1619"),me={name:"MemberPop",props:["member"],components:{},data:function(){return{}},computed:{},watch:{},methods:{formatApplyTime:function(e){return Object(de["showTime"])(null===e||void 0===e?void 0:e.created_at)},showMemberUsername:function(e){var t;return(null===e||void 0===e||null===(t=e.raid_member_info)||void 0===t?void 0:t.display_name)||"匿名"},showMemberAvatar:function(e){var t;return Object(ue["t"])(null===e||void 0===e||null===(t=e.raid_member_info)||void 0===t?void 0:t.user_avatar)},showMemberLink:function(e){return Object(ue["a"])(null===e||void 0===e?void 0:e.user_id)}},filters:{},created:function(){},mounted:function(){}},fe=me,he=(n("104f"),Object(Z["a"])(fe,ce,le,!1,null,"aeaed6f0",null)),pe=he.exports,be={name:"RaidSub",props:["id","teamId","isForceMatch","canAdd","canReplace"],components:{MemberSetting:$,contextMenu:F.a,"member-pop":pe},data:function(){return{data:[],visible:!1,title:"新增替补",selectedMember:null,selectedIndex:void 0,action:"",roles:[],editing:{},tempMember:{name:"",mount:"",is_core:!1,pending:[],remark:"",role_id:0},xf_map:j,loading:!1,isMax:!1}},computed:{raid_id:function(){return this.id},canManage:function(){return this.$store.state.canManage},linkVisible:function(){return this.$store.state.isTeammate},isEditing:function(){return Object.values(this.editing).some((function(e){return e}))},allRoles:function(){return this.$store.state.roles},members:function(){return this.$store.state.subMembers},normalMembers:function(){return this.$store.state.normalMembers},count:function(){return this.members.length}},watch:{allRoles:{deep:!0,handler:function(e){e&&(this.roles=S()(e))}},members:{deep:!0,immediate:!0,handler:function(e){this.data=e}}},methods:{handleSetting:function(e,t){this.title="角色设置",this.selectedMember=e,this.selectedIndex=t,this.visible=!0},handleDialogCancel:function(){this.visible=!1,this.selectedMember=null,this.action=""},pass:function(e,t){var n=this;return Object(o["a"])(Object(r["a"])().mark((function i(){var a,s,o,c,l;return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=n.canAdd,s=n.canReplace,o=null===e||void 0===e?void 0:e.id,i.prev=2,!a){i.next=26;break}if(!s){i.next=20;break}if(c=n.isForceMatch?n.normalMembers.find((function(t){return t.mount==e.mount&&!t.is_valid})):n.normalMembers.find((function(t){return t.mount==e.mount&&!t.is_valid}))||n.normalMembers.find((function(e){return!e.is_valid})),!c){i.next=14;break}return l=null===c||void 0===c?void 0:c.id,n.$emit("pass",{member:e,from:"sub",isReplace:!0}),i.next=11,Object(h["g"])(n.raid_id,o,l);case 11:n.data.splice(t,1),i.next=18;break;case 14:return n.$emit("pass",{member:e,from:"sub",isReplace:!1}),i.next=17,Object(h["g"])(n.raid_id,o);case 17:n.data.splice(t,1);case 18:i.next=24;break;case 20:return n.$emit("pass",{member:e,from:"sub"}),i.next=23,Object(h["g"])(n.raid_id,o);case 23:n.data.splice(t,1);case 24:i.next=27;break;case 26:n.$notify({type:"warning",title:"提示",message:"当前团队人数已满或无匹配职责空位"});case 27:i.next=32;break;case 29:i.prev=29,i.t0=i["catch"](2),console.log("covertSub2Normal",i.t0);case 32:case"end":return i.stop()}}),i,null,[[2,29]])})))()},remove:function(e,t){var n=this;Object(h["v"])(this.raid_id,null===e||void 0===e?void 0:e.id).then((function(){n.$notify({title:"操作成功",message:"删除成功",type:"success"}),n.data.splice(t,1)}))},handleButtonAdd:function(e){this.title="新增替补",this.action=e,this.selectedMember=null,this.visible=!0},add:function(e){var t=this;Object(h["d"])(this.id,Object(c["a"])(Object(c["a"])({},e),{},{type:"sub"})).then((function(e){t.data.push(e.data.data)}))},onCtxOpen:function(e){var t=e.member,n=e.i;this.selectedMember=t,this.selectedIndex=n},handleContextMenuOpen:function(e,t){!this.isEditing&&this.canManage&&this.$refs.ctxMenu.open(e,Object(c["a"])({},t))},setEdit:function(){this.title="角色设置",this.visible=!0},setPass:function(){this.pass(this.selectedMember)},setRemark:function(){var e=this;this.$prompt("请输入备注","",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.selectedMember.remark,inputValidator:function(e){if(e.length>20)return"备注内容应不超过20个字符"}}).then((function(t){var n=t.value;e.selectedMember.remark=n,e.$set(e.data,e.selectedIndex,e.selectedMember),e.remark(e.selectedMember),e.selectedMember=null}))},remark:function(e){var t=e.id,n=e.remark;updateRaidApply(t,{remark:n})},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,Object(h["p"])(this.teamId,e).then((function(e){t.roles=e.data.data.list,t.loading=!1}))):this.roles=S()(this.copy_roles)},showMemberName:function(e){return this.linkVisible?e:e.slice(0,1)+"******"},edit:function(e){var t=this,n=e.member,i=e.index,a=null===n||void 0===n?void 0:n.id;updateRaidApply(a,Object(c["a"])(Object(c["a"])({},n),{},{type:"sub"})).then((function(e){t.$set(t.data,i,n)}))},handleSave:function(e){var t=this.action;"add"===t&&this.data.push(e),t||this.$set(this.members,this.selectedIndex,e),this.selectedMember=null,this.visible=!1}},mounted:function(){var e=this;this.$bus.$on("withoutPos",(function(t){"sub"===t&&(e.$notify({type:"warning",title:"提醒",message:"此角色职能位已不足，请检查后再试"}),e.isMax=!0)})),this.$bus.$on("pending",(function(t){e.data=[].concat(Object(oe["a"])(e.data),[t])}))},beforeDestroy:function(){this.$bus.$off("withoutPos"),this.$bus.$off("pending")}},ve=be,ge=(n("ea12"),Object(Z["a"])(ve,re,se,!1,null,null,null)),xe=ge.exports,Me=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-raid-tobebox"},[t("h5",{staticClass:"u-title"},[t("span",[t("i",{staticClass:"el-icon-news"}),e._v(" 申请名单 "),t("span",{staticClass:"u-count"},[e._v("("+e._s(e.count)+")")])])]),e.data&&e.data.length?t("div",{staticClass:"m-raid-corebox"},[t("ul",{staticClass:"m-raid-members"},e._l(e.data,(function(n,i){return t("div",{key:i,staticClass:"u-member",on:{contextmenu:function(t){return t.preventDefault(),function(t){return e.handleContextMenuOpen(t,{member:n,i:i})}.apply(null,arguments)}}},[t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover","popper-class":"m-raid-members__tobe-item"}},[t("member-pop",{attrs:{member:n}}),t("span",{staticClass:"u-member-primary",attrs:{slot:"reference"},slot:"reference"},[n["mount"]?t("img",{staticClass:"u-member-icon",attrs:{src:e._f("showMountIcon")(n["mount"]),alt:e._f("showMountName")(n["mount"])}}):e._e(),t("span",{staticClass:"u-member-role"},[n.role_id&&e.linkVisible?t("router-link",{staticClass:"u-member-name-link",attrs:{tag:"a",target:"_blank",to:"/role/".concat(n.role_id)}},[t("i",{staticClass:"el-icon-link"})]):e._e(),t("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.showMemberName(n["name"]),expression:"showMemberName(member['name'])",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],staticClass:"u-member-name"},[e._v(e._s(e.showMemberName(n["name"])))])],1),n["remark"]?t("span",{staticClass:"u-member-remark"},[e._v("["+e._s(n["remark"])+"]")]):e._e()])],1),e.canManage?t("span",{staticClass:"u-member-op"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设为正式队员",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否将该角色转为正式成员？"},on:{confirm:function(t){return e.pass(n,i)}}},[t("i",{staticClass:"u-member-reset el-icon-check",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设为替补队员",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否将该角色转为替补成员？"},on:{confirm:function(t){return e.pending(n,i)}}},[t("i",{staticClass:"u-member-reset el-icon-first-aid-kit",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"拒绝申请",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"是否拒绝申请？"},on:{confirm:function(t){return e.reject(n,i)}}},[t("i",{staticClass:"u-member-delete el-icon-close",attrs:{slot:"reference"},slot:"reference"})])],1)],1):e._e()],1)})),0)]):t("div",{staticClass:"m-raid-null"},[t("i",{staticClass:"el-icon-warning-outline"}),e._v(" 当前没有任何名单")]),t("contextMenu",{ref:"ctxMenu",staticClass:"m-raid-contextmenu",attrs:{id:"context-menu"},on:{"ctx-open":e.onCtxOpen}},[t("div",{staticClass:"item",on:{click:function(t){return e.pass(e.selectedMember,e.selectedIndex)}}},[t("i",{staticClass:"el-icon-check"}),e._v(" 批准 ")]),t("div",{staticClass:"item",on:{click:function(t){return e.pending(e.selectedMember,e.selectedIndex)}}},[t("i",{staticClass:"el-icon-first-aid-kit"}),e._v(" 待定 ")]),t("div",{staticClass:"item",on:{click:function(t){return e.reject(e.selectedMember,e.selectedIndex)}}},[t("i",{staticClass:"el-icon-close"}),e._v(" 拒绝 ")])])],1)},_e=[],ke={name:"RaidTobe",props:["id","teamId","isForceMatch","canAdd","canReplace"],components:{contextMenu:F.a,"member-pop":pe},data:function(){return{data:[],selectedMember:null,selectedIndex:void 0,xf_map:j}},computed:{raid_id:function(){return this.id},canManage:function(){return this.$store.state.canManage},linkVisible:function(){return this.$store.state.isTeammate},count:function(){var e;return null===(e=this.data)||void 0===e?void 0:e.length},members:function(){return this.$store.state.tobeMembers},normalMembers:function(){return this.$store.state.normalMembers}},watch:{members:{deep:!0,immediate:!0,handler:function(e){this.data=e}}},mounted:function(){var e=this;this.$bus.$on("updateTobe",(function(t){e.data=[].concat(Object(oe["a"])(e.data),[t])}))},beforeDestroy:function(){this.$bus.$off("updateTobe")},methods:{pass:function(e,t){var n=this;return Object(o["a"])(Object(r["a"])().mark((function i(){var a,s,o,c,l;return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=n.canAdd,s=n.canReplace,o=null===e||void 0===e?void 0:e.id,i.prev=2,!a){i.next=26;break}if(!s){i.next=20;break}if(c=n.isForceMatch?n.normalMembers.find((function(t){return t.mount==e.mount&&!t.is_valid})):n.normalMembers.find((function(t){return t.mount==e.mount&&!t.is_valid}))||n.normalMembers.find((function(e){return!e.is_valid})),!c){i.next=14;break}return l=null===c||void 0===c?void 0:c.id,n.$emit("pass",{member:e,from:"tobe",isReplace:!0}),i.next=11,Object(h["h"])(n.raid_id,o,l);case 11:n.data.splice(t,1),i.next=18;break;case 14:return n.$emit("pass",{member:e,from:"tobe",isReplace:!1}),i.next=17,Object(h["h"])(n.raid_id,o);case 17:n.data.splice(t,1);case 18:i.next=24;break;case 20:return n.$emit("pass",{member:e,from:"tobe"}),i.next=23,Object(h["h"])(n.raid_id,o);case 23:n.data.splice(t,1);case 24:i.next=27;break;case 26:n.$notify({type:"warning",title:"提示",message:"当前团队人数已满或无匹配职责空位"});case 27:i.next=32;break;case 29:i.prev=29,i.t0=i["catch"](2),console.log("covertTobe2Normal",i.t0);case 32:case"end":return i.stop()}}),i,null,[[2,29]])})))()},pending:function(e,t){var n=this;Object(h["i"])(this.raid_id,null===e||void 0===e?void 0:e.id).then((function(){n.$emit("pending",e),n.data.splice(t,1)}))},reject:function(e,t){var n=this;Object(h["u"])(this.raid_id,null===e||void 0===e?void 0:e.id).then((function(){n.$notify({title:"操作成功",message:"已拒绝".concat((null===e||void 0===e?void 0:e.name)||"","的申请"),type:"success"}),n.data.splice(t,1)}))},onCopy:function(e){this.$notify({title:"复制成功",message:"复制内容 : "+e.text,type:"success"})},onError:function(){this.$notify.error({title:"复制失败",message:"请手动复制"})},onCtxOpen:function(e){var t=e.member,n=e.i;this.selectedMember=t,this.selectedIndex=n},handleContextMenuOpen:function(e,t){var n,i;!this.isEditing&&this.canManage&&(null===(n=this.$refs)||void 0===n||null===(i=n.ctxMenu)||void 0===i||i.open(e,Object(c["a"])({},t)))},showMemberName:function(e){return this.linkVisible?e:e.slice(0,1)+"******"}}},we=ke,Ce=(n("4b41"),Object(Z["a"])(we,Me,_e,!1,null,null,null)),ye=Ce.exports,Ie={name:"Raid",props:["preset","count","teamId","leader","templateId","content","row","col","isPublic","isForceMatch"],components:{"raid-normal-v1":X,"raid-normal-v2":ae,RaidSub:xe,RaidTobe:ye},data:function(){return{members:[],subMembers:[],tobeMembers:[],substitutes:[],drag_options:{handle:".u-member-icon"},action:"",loading:!1}},watch:{preset:{immediate:!0,handler:function(e){this.id||(this.members=_[e]["data"]||[])}},count:function(e){this.id||"custom"!=this.preset||this.fulfill(e)},members:{deep:!0,handler:function(e){this.$emit("updateMembers",e)}},content:{deep:!0,handler:function(e){null!==e&&void 0!==e&&e.length&&(this.members=e||[])}},teamId:{immediate:!0,handler:function(e){e&&this.$store.dispatch("loadAllRoles",{teamId:this.teamId})}},isPublic:{immediate:!0,handler:function(){(this.isPublic||!this.isPublic&&this.isTeammate)&&this.loadMembers()}},isTeammate:{immediate:!0,handler:function(){}}},computed:{id:function(){return this.$route.params.id},isTeammate:function(){return this.$store.state.isTeammate},canAdd:function(){return this.members.length<=this.row*this.col},canReplace:function(){return this.members.filter((function(e){return!e.is_valid})).length>0}},methods:{fulfill:function(e){for(var t=[],n=0;n<this.count;n++)t.push(M.a.cloneDeep(k));this.members=t},updateMembers:function(e){this.members=e},handlePass:function(e){var t=e.member,n=e.from,i=e.isReplace,a=this.canAdd,r=this.canReplace;a?r?"sub"===n?(this.subMembers=this.subMembers.filter((function(e){return e.id!==t.id})),i?this.handleReplace(t):(this.members.push(t),this.notify("【".concat(t.name,"】已成为正式队员")))):"tobe"===n&&(this.tobeMembers=this.tobeMembers.filter((function(e){return e.id!==t.id})),i?this.handleReplace(t):(this.members.push(t),this.notify("【".concat(t.name,"】已成为正式队员")))):"sub"===n?(this.subMembers=this.subMembers.filter((function(e){return e.id!==t.id})),this.members.push(t),this.notify("【".concat(t.name,"】已成为正式队员"))):"tobe"===n&&(this.tobeMembers=this.tobeMembers.filter((function(e){return e.id!==t.id})),this.members.push(t),this.notify("【".concat(t.name,"】已成为正式队员"))):this.$notify({title:"提示",message:"正式队员已满",type:"warning"})},handleReplace:function(e){var t=this.members.findIndex((function(t){return t.mount==e.mount&&!t.is_valid}));if(t>-1)this.$set(this.members,t,e),this.notify("【".concat(e.name,"】已成为正式队员"));else{var n=this.members.findIndex((function(e){return!e.is_valid}));n&&(this.$set(this.members,n,e),this.notify("【".concat(e.name,"】已成为正式队员")))}},notify:function(e){this.$notify({title:"提示",message:e,type:"success"})},handlePending:function(e){var t=this.$refs.subRaid,n=M.a.cloneDeep(t.data);n.push(e),t.data=n},loadMembers:function(){var e=this;this.content||(this.loading=!0,Object(h["n"])(this.id).then((function(t){var n=t.data.data,i=void 0===n?[]:n;e.members=i.filter((function(e){return"normal"===e.type})).sort((function(e,t){return e.order-t.order})),e.$store.commit("SET_NORMAL_MEMBERS",e.members),e.$store.commit("SET_MEMBER_ORDER",e.members.map((function(e){return{id:e.id,order:e.order}}))),e.subMembers=i.filter((function(e){return"sub"===e.type})),e.$store.commit("SET_SUB_MEMBERS",e.subMembers),e.tobeMembers=i.filter((function(e){return"tobe"===e.type})),e.$store.commit("SET_TOBE_MEMBERS",e.tobeMembers)})).finally((function(){e.loading=!1})))}}},Oe=Ie,je=(n("3b1a"),Object(Z["a"])(Oe,v,g,!1,null,null,null)),Ae=je.exports,Re=n("ebdf"),Se=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"m-team-joinpop m-raid-joinpop",attrs:{title:e.title,visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t}}},[e.isLogin&&1!==e.auth?[t("el-radio-group",{model:{value:e.custom,callback:function(t){e.custom=t},expression:"custom"}},[t("el-radio-button",{attrs:{label:0}},[t("i",{staticClass:"el-icon-user"}),e._v(" 已有角色")]),t("el-radio-button",{attrs:{label:1}},[t("i",{staticClass:"el-icon-edit"}),e._v(" 临时自定义")])],1)]:e._e(),!e.custom&e.isLogin?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"m-raid-joinpop-box"},[e.data&&e.data.length?t("div",{staticClass:"m-raid-joinpop-list"},[t("el-checkbox-group",{staticClass:"u-list",on:{change:e.checkIsAll},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}},e._l(e.data,(function(n){return t("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:1!==e.auth||!n.custom,expression:"auth !== 1 || !item.custom"}],key:n.ID,staticClass:"u-item",attrs:{label:n.ID,border:""}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:n.note||n.name,placement:"bottom"}},[t("div",[t("img",{staticClass:"u-item-avatar",attrs:{src:e.showAvatar(n.mount)}}),t("span",{staticClass:"u-item-name"},[e._v(e._s(n.name))]),t("span",{staticClass:"u-item-server"},[e._v(e._s(n.server))])])])],1)})),1)],1):t("div",{staticClass:"m-team-joinpop-null"},[t("el-alert",{attrs:{title:"暂无可用角色,请绑定角色或临时自定义",type:"warning","show-icon":""}})],1)]):e._e(),e.custom||!e.isLogin?t("div",{staticClass:"m-team-joinpop-block",class:{isFirstBlock:e.custom}},[t("p",{staticClass:"u-label"},[t("i",{staticClass:"el-icon-postcard"}),e._v(" 角色名称 "),t("b",[e._v("(*必填)")])]),t("el-input",{attrs:{placeholder:"请输入角色名",maxlength:12,"show-word-limit":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1):e._e(),e.custom||!e.custom&&e.data&&e.data.length?t("div",{staticClass:"m-team-joinpop-block is-mount-block"},[t("p",{staticClass:"u-label"},[t("i",{staticClass:"el-icon-orange"}),e._v(" 角色心法 "),t("b",[e._v("(*必选)")])]),t("div",{staticClass:"m-team-xf"},e._l(e.xfMaps,(function(n,i){return t("el-radio",{key:i,attrs:{label:String(n.id)},model:{value:e.form.mount,callback:function(t){e.$set(e.form,"mount",t)},expression:"form.mount"}},[t("img",{staticClass:"u-pic",attrs:{src:e._f("showMountIcon")(n.id),alt:n.name}}),t("span",{staticClass:"u-txt"},[e._v(e._s(n.name))])])})),1)]):e._e(),e.custom||!e.custom&&e.data&&e.data.length?t("div",{staticClass:"m-team-joinpop-block"},[t("p",{staticClass:"u-label"},[t("i",{staticClass:"el-icon-chat-line-square"}),e._v(" 备注信息")]),t("el-input",{attrs:{placeholder:"请输入备注",maxlength:20,"show-word-limit":""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],2)},Ne=[],De=n("2d838"),Ge={name:"RaidJoinPop",props:["title","show","auth","client"],data:function(){return{isLogin:f["a"].isLogin(),visible:!1,data:[],roles:[],form:{name:"",mount:"",remark:""},custom:1,checkAll:!1,isIndeterminate:!1,xf_map:j,loading:!1}},model:{prop:"show",event:"switchJoinPop"},watch:{show:function(e){var t=this;this.visible=e,this.resetForm(),this.$nextTick((function(){t.form.mount="0"}))},visible:function(e){var t=this;this.$emit("switchJoinPop",e),e&&(this.isLogin?(this.loading=!0,Object(De["c"])().then((function(e){t.data=e.data.data.list||[],t.custom=t.data.length?0:1})).finally((function(){t.loading=!1}))):this.custom=1)},custom:function(){this.form={name:"",mount:"0",remark:""},this.roles=[]},roles:{deep:!0,handler:function(e){var t;e.length&&(this.form.mount=String(null===(t=Object.values(this.xfMaps)[0])||void 0===t?void 0:t.id))}}},computed:{roleData:function(){return 1===this.auth?this.data.filter((function(e){return!(null!==e&&void 0!==e&&e.custom)})):this.data},params:function(){return{roles:this.roles,team_id:this.$route.params.id}},school:function(e){var t=e.roles,n=e.data,i=Object(y["a"])(t,1),a=i[0];return a?Number(n.find((function(e){return e.ID===a})).mount):0},xfMaps:function(e){var t=this,n=e.school,i=Object.values(j).filter((function(e){return e.client.includes(t.client)}));if(n){var a={};for(var r in i)i[r].school===n&&(a[r]=i[r]);return a}return i}},methods:{confirm:function(){var e,t,n=this.roles||[],i=Object(y["a"])(n,1),a=i[0],r={role_id:a,name:(null===(e=this.data.find((function(e){return e.ID===a})))||void 0===e?void 0:e.name)||this.form.name,mount:this.form.mount,server:null===(t=this.data.find((function(e){return e.ID===a})))||void 0===t?void 0:t.server,remark:this.form.remark};r.name?this.$emit("confirm",r):this.$message.warning("请输入角色名称")},checkIsAll:function(e){if(e.length){var t=e[e.length-1];this.roles=[t]}},showAvatar:function(e,t){return b["__imgPath"]+"image/school/"+e+".png"},resetForm:function(){this.form={name:"",mount:"",remark:""},this.custom=0,this.roles=[]}},mounted:function(){},components:{}},Te=Ge,Ee=(n("6648"),Object(Z["a"])(Te,Se,Ne,!1,null,null,null)),Ze=Ee.exports,Le=n("91d4"),$e=n("a59a"),Ye={name:"ViewRaid",props:[],components:{"team-info":Re["a"],Raid:Ae,JoinPop:Ze},data:function(){return{info:"",data:"",raid_auth:d,authority:0,auth_map:{r_raid:0},joinShow:!1,formData:{},flag:!1,isAdmin:f["a"].isAdmin(),visible:!1,imgUrl:"",showImage:!1,hideBtn:!1,boxsize:{},miniprogramCodeUrl:"",miniprogramCode:!1}},computed:{id:function(){return this.$route.params.id},client:function(){var e;return this.info?$e.includes(null===(e=this.info)||void 0===e?void 0:e.server)?"origin":"std":this.$store.state.client},team_id:function(){var e;return null===(e=this.data)||void 0===e?void 0:e.team_id},canJoin:function(){return 3!=this.data.auth&&(2==this.data.auth?this.authority>=2:1!=this.data.auth||this.authority>=1)},canManage:function(){return this.$store.state.canManage},isOldVersion:function(){var e;return!(null===(e=this.data)||void 0===e||!e.content)},chosenRole:function(e){var t=e.formData,n={name:t.name,mount:~~t.mount,order:0,remark:t.remark};return t.role_id&&(n.role_id=t.role_id),Object(c["a"])({},n)},routerName:function(){return this.$route.name},lackMounts:function(){var e,t,n=this,i=null===(e=this.data)||void 0===e||null===(t=e.content)||void 0===t?void 0:t.map((function(e){return Number(e.mount)})),a=new Set(i),r=Object.keys(Le).filter((function(e){return!a.has(Number(e))})).map((function(e){return Number(e)})),s=Object.values(j).filter((function(e){return e.client.includes(n.client)}));return s.filter((function(e){return e.id&&(null===r||void 0===r?void 0:r.includes(e.id))}))}},watch:{data:{deep:!0,handler:function(){var e=this;if("view_raid"===this.routerName&&this.flag){var t=this.data.content.filter((function(e){return e.name})).length,n=S()(this.data);n.count_normal=t,Object(h["B"])(this.id,n).then((function(){e.$message({message:"更新成功",type:"success"})}))}}},showImage:{deep:!0,handler:function(e){0==e&&(this.hideBtn=!1)}}},methods:{toCanvas:function(){var e=this,t=this.$refs.teamImage;this.boxsize.width=t.offsetWidth+"px",this.boxsize.height=t.offsetHeight+"px",this.hideBtn=!0,setTimeout((function(){u()(t).then(function(){var t=Object(o["a"])(Object(r["a"])().mark((function t(n){var i,a,o;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=n.toDataURL("image/png"),e.imgUrl=i,""===e.imgUrl){t.next=12;break}return e.showImage=!0,t.next=6,fetch(e.imgUrl);case 6:return a=t.sent,t.next=9,a.blob();case 9:return o=t.sent,t.next=12,navigator.clipboard.write([new ClipboardItem(Object(s["a"])({},o.type,o))]);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),500)},getRaid:function(){var e=this;return Object(h["m"])(this.id).then((function(t){e.data=t.data.data}))},getTeam:function(){var e=this;return Object(m["m"])(this.team_id).then((function(t){e.info=t.data.data}))},getAuthority:function(){var e=this;if(f["a"].isLogin())return Object(p["b"])(this.team_id).then((function(t){e.authority=t.data.data.authority,e.auth_map=t.data.data,e.$store.commit("setManageStatus",1===e.auth_map.r_raid||99===e.auth_map.authority),e.$store.commit("setIsTeammate",e.authority>=2)}))},init:function(){var e=this;this.getRaid().then((function(){e.getTeam(),e.getAuthority().then((function(){e.flag=!0}))}))},handleShowDialog:function(){this.joinShow=!0},handleConfrim:function(e){this.formData=e,this.Join()},Join:function(){var e=this;Object(h["e"])(this.id,this.chosenRole).then((function(t){e.$message({message:"申请成功,请等待团长审核",type:"success"}),e.joinShow=!1,e.$bus.$emit("updateTobe",t.data.data)}))},goBack:function(){var e;null!==(e=document.referrer)&&void 0!==e&&e.includes("manage")?this.$router.push("/raid/manage"):this.$router.push("/raid/list")},editRaid:function(){this.$router.push("/raid/edit/".concat(this.id))},rmRaid:function(){var e=this;Object(h["w"])(this.id).then((function(t){e.$message({message:"删除成功",type:"success"}),e.visible=!1,e.$router.push("/raid/list")}))},handleUpdate:function(e){},showMiniprogramCode:function(){var e=this;this.miniprogramCode=!0,this.miniprogramCodeUrl||Object(h["q"])(this.id).then((function(t){e.miniprogramCodeUrl=b["__ossMirror"]+t.data.data.meta_val}))}},filters:{showAuth:function(e){return d[e]}},created:function(){this.init()}},ze=Ye,Be=(n("f94b"),Object(Z["a"])(ze,i,a,!1,null,null,null));t["default"]=Be.exports},"6f53":function(e,t,n){"use strict";var i=n("83ab"),a=n("d039"),r=n("e330"),s=n("e163"),o=n("df75"),c=n("fc6a"),l=n("d1e7").f,u=r(l),d=r([].push),m=i&&a((function(){var e=Object.create(null);return e[2]=2,!u(e,2)})),f=function(e){return function(t){var n,a=c(t),r=o(a),l=m&&null===s(a),f=r.length,h=0,p=[];while(f>h)n=r[h++],i&&!(l?n in a:u(a,n))||d(p,e?[n,a[n]]:a[n]);return p}};e.exports={entries:f(!0),values:f(!1)}},"72f0":function(e,t){function n(e){return function(){return e}}e.exports=n},"76dd":function(e,t,n){var i=n("ce86");function a(e){return null==e?"":i(e)}e.exports=a},7948:function(e,t){function n(e,t){var n=-1,i=null==e?0:e.length,a=Array(i);while(++n<i)a[n]=t(e[n],n,e);return a}e.exports=n},"79bb":function(e){e.exports=JSON.parse('{"role_id":0,"name":"","remark":"","mount":"","is_core":false,"pending":[]}')},"7b97":function(e,t,n){var i=n("7e64"),a=n("a2be"),r=n("1c3c"),s=n("b1e5"),o=n("42a2"),c=n("6747"),l=n("0d24"),u=n("73ac"),d=1,m="[object Arguments]",f="[object Array]",h="[object Object]",p=Object.prototype,b=p.hasOwnProperty;function v(e,t,n,p,v,g){var x=c(e),M=c(t),_=x?f:o(e),k=M?f:o(t);_=_==m?h:_,k=k==m?h:k;var w=_==h,C=k==h,y=_==k;if(y&&l(e)){if(!l(t))return!1;x=!0,w=!1}if(y&&!w)return g||(g=new i),x||u(e)?a(e,t,n,p,v,g):r(e,t,_,n,p,v,g);if(!(n&d)){var I=w&&b.call(e,"__wrapped__"),O=C&&b.call(t,"__wrapped__");if(I||O){var j=I?e.value():e,A=O?t.value():t;return g||(g=new i),v(j,A,n,p,g)}}return!!y&&(g||(g=new i),s(e,t,n,p,v,g))}e.exports=v},"7ed2":function(e,t){var n="__lodash_hash_undefined__";function i(e){return this.__data__.set(e,n),this}e.exports=i},8535:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAARCAYAAAACCvahAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF+mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA2LTE0VDA5OjEwOjAxKzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNi0xNFQwOToxNjo0NyswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNi0xNFQwOToxNjo0NyswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmZGUxYmJlNS1hMDBjLWJjNDAtOGU0YS1iNDNhMTIzNjIyNzciIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxOTYwYzc1ZS01YTVmLWQyNDktODE2Yi0wYmRmZmY1YjViMjgiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyMGJiOWMxOC1mMzVkLTc4NDUtOGNjOS0wYmM5MjVhNGYyYmYiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjIwYmI5YzE4LWYzNWQtNzg0NS04Y2M5LTBiYzkyNWE0ZjJiZiIgc3RFdnQ6d2hlbj0iMjAyMS0wNi0xNFQwOToxMDowMSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmZGUxYmJlNS1hMDBjLWJjNDAtOGU0YS1iNDNhMTIzNjIyNzciIHN0RXZ0OndoZW49IjIwMjEtMDYtMTRUMDk6MTY6NDcrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4EQUqEAAACMUlEQVQ4EZXBW2iOcRzA8e/v9/yf93neOc8sO0ob0azFxbI7hzTnIudoodxRrrgRJSLlWpKScokLzIULiigK00pKGMWNxd559x6e//MztmIkfD5S21Bv/MZQM/ApgoEBwneGgAominTEGbv79h2WG+A7Myz1mPeIpZgZooKhIAwTgspKltQ14lKMofNnSN/1YYU8fiAH+SEsPwSlMmiAZCKIYySKkXFZtL4aEKS2od7c+Cw+lwfvUZ+gSRnxHvEpiGAqmAZYGGKqIIKpIsDkpih4+PTU4ebk+TMGX7xB+gchV4DEAwIuQLIRUUMV0ZrlrNp3hDul0loFPr0s+hOLDx4lu30PceSgkCDeo2YohqYpYp7MovngHCjfXHOMuCBwzgYHyHTMg493IUyAFAIBUXTGRML2paxevoE7hdIKwJQRSShC5/qtZBZ2orOqkJoYqkOodkhdBW5+G0nvI8JAGHaTYY5R976U4pbYPbFycU7Q3EQ6KYKkDM4hLsK1tLNpx166vxSXMUr5odhbSI5v3LCTcO4CgsbZuJZ2wnkL0ekN+PevCVUYdotRyliX3iS+h8AhYYawtQOdWoNOq6PrwGmu5Arr+Ikyln9WTA51de0naGpBMjFg2NBnHhbL94Gr/EXQFoU9xQfdlr9+1gq3L9uWCbEBK/mF8jv/tFg+2X/xGG5mK6l9oM+nj4Ab/CNdkM08Tj68sl1TKgzYxn9atXtyhXWOjx4Djv8UANeAzfzBVzcH19ubh8z9AAAAAElFTkSuQmCC"},"85e3":function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}e.exports=n},8604:function(e,t,n){var i=n("26e8"),a=n("e2c0");function r(e,t){return null!=e&&a(e,t,i)}e.exports=r},"89d9":function(e,t,n){var i=n("656b"),a=n("159a"),r=n("e2e4");function s(e,t,n){var s=-1,o=t.length,c={};while(++s<o){var l=t[s],u=i(e,l);n(u,l)&&a(c,r(l,e),u)}return c}e.exports=s},"8c3b":function(e,t,n){},9313:function(e){e.exports=JSON.parse('[{"key":"25std","label":"5×5 队伍规格","data":[],"count":25,"row":5,"col":5},{"key":"10std","label":"5×2 队伍规格","data":[],"count":10,"row":5,"col":2},{"key":"15std","label":"5×3 队伍规格","data":[],"count":10,"row":5,"col":3},{"key":"custom","label":"自定义规格","data":[],"count":"","row":5,"col":5}]')},"9f1c":function(e,t,n){},a2be:function(e,t,n){var i=n("d612"),a=n("4284"),r=n("c584"),s=1,o=2;function c(e,t,n,c,l,u){var d=n&s,m=e.length,f=t.length;if(m!=f&&!(d&&f>m))return!1;var h=u.get(e),p=u.get(t);if(h&&p)return h==t&&p==e;var b=-1,v=!0,g=n&o?new i:void 0;u.set(e,t),u.set(t,e);while(++b<m){var x=e[b],M=t[b];if(c)var _=d?c(M,x,b,t,e,u):c(x,M,b,e,t,u);if(void 0!==_){if(_)continue;v=!1;break}if(g){if(!a(t,(function(e,t){if(!r(g,t)&&(x===e||l(x,e,n,c,u)))return g.push(t)}))){v=!1;break}}else if(x!==M&&!l(x,M,n,c,u)){v=!1;break}}return u["delete"](e),u["delete"](t),v}e.exports=c},a454:function(e,t,n){var i=n("72f0"),a=n("3b4a"),r=n("cd9d"),s=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:i(t),writable:!0})}:r;e.exports=s},a59a:function(e){e.exports=JSON.parse('["缘起稻香","天宝盛世"]')},a732:function(e,t,n){"use strict";var i=n("23e7"),a=n("2266"),r=n("59ed"),s=n("825a"),o=n("46c4");i({target:"Iterator",proto:!0,real:!0},{some:function(e){s(this),r(e);var t=o(this),n=0;return a(t,(function(t,i){if(e(t,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},ac41:function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}e.exports=n},ad32:function(e,t,n){"use strict";n("8c3b")},b1e5:function(e,t,n){var i=n("a994"),a=1,r=Object.prototype,s=r.hasOwnProperty;function o(e,t,n,r,o,c){var l=n&a,u=i(e),d=u.length,m=i(t),f=m.length;if(d!=f&&!l)return!1;var h=d;while(h--){var p=u[h];if(!(l?p in t:s.call(t,p)))return!1}var b=c.get(e),v=c.get(t);if(b&&v)return b==t&&v==e;var g=!0;c.set(e,t),c.set(t,e);var x=l;while(++h<d){p=u[h];var M=e[p],_=t[p];if(r)var k=l?r(_,M,p,t,e,c):r(M,_,p,e,t,c);if(!(void 0===k?M===_||o(M,_,n,r,c):k)){g=!1;break}x||(x="constructor"==p)}if(g&&!x){var w=e.constructor,C=t.constructor;w==C||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof C&&C instanceof C||(g=!1)}return c["delete"](e),c["delete"](t),g}e.exports=o},c05f:function(e,t,n){var i=n("7b97"),a=n("1310");function r(e,t,n,s,o){return e===t||(null==e||null==t||!a(e)&&!a(t)?e!==e&&t!==t:i(e,t,n,s,r,o))}e.exports=r},c1c9:function(e,t,n){var i=n("a454"),a=n("f3c1"),r=a(i);e.exports=r},c584:function(e,t){function n(e,t){return e.has(t)}e.exports=n},c6cf:function(e,t,n){var i=n("4d8c"),a=n("2286"),r=n("c1c9");function s(e){return r(a(e,void 0,i),e+"")}e.exports=s},cd9d:function(e,t){function n(e){return e}e.exports=n},ce86:function(e,t,n){var i=n("9e69"),a=n("7948"),r=n("6747"),s=n("ffd6"),o=1/0,c=i?i.prototype:void 0,l=c?c.toString:void 0;function u(e){if("string"==typeof e)return e;if(r(e))return a(e,u)+"";if(s(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-o?"-0":t}e.exports=u},d174:function(e){e.exports=JSON.parse('{"0":"所有人可报名","1":"仅认证角色","2":"仅团员可报名","3":"仅管理员指定"}')},d396:function(e,t,n){},d612:function(e,t,n){var i=n("7b83"),a=n("7ed2"),r=n("dc0f");function s(e){var t=-1,n=null==e?0:e.length;this.__data__=new i;while(++t<n)this.add(e[t])}s.prototype.add=s.prototype.push=a,s.prototype.has=r,e.exports=s},dc0f:function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},e2c0:function(e,t,n){var i=n("e2e4"),a=n("d370"),r=n("6747"),s=n("c0983"),o=n("b218"),c=n("f4d6");function l(e,t,n){t=i(t,e);var l=-1,u=t.length,d=!1;while(++l<u){var m=c(t[l]);if(!(d=null!=e&&n(e,m)))break;e=e[m]}return d||++l!=u?d:(u=null==e?0:e.length,!!u&&o(u)&&s(m,u)&&(r(e)||a(e)))}e.exports=l},e2e4:function(e,t,n){var i=n("6747"),a=n("f608"),r=n("18d8"),s=n("76dd");function o(e,t){return i(e)?e:a(e,t)?[e]:r(s(e))}e.exports=o},e380:function(e,t,n){var i=n("7b83"),a="Expected a function";function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(a);var n=function(){var i=arguments,a=t?t.apply(this,i):i[0],r=n.cache;if(r.has(a))return r.get(a);var s=e.apply(this,i);return n.cache=r.set(a,s)||r,s};return n.cache=new(r.Cache||i),n}r.Cache=i,e.exports=r},ea12:function(e,t,n){"use strict";n("4627")},edfa:function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}e.exports=n},f3c1:function(e,t){var n=800,i=16,a=Date.now;function r(e){var t=0,r=0;return function(){var s=a(),o=i-(s-r);if(r=s,o>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}e.exports=r},f3f1:function(e,t,n){},f4d6:function(e,t,n){var i=n("ffd6"),a=1/0;function r(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}e.exports=r},f608:function(e,t,n){var i=n("6747"),a=n("ffd6"),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function o(e,t){if(i(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!a(e))||(s.test(e)||!r.test(e)||null!=t&&e in Object(t))}e.exports=o},f94b:function(e,t,n){"use strict";n("f3f1")},ffd6:function(e,t,n){var i=n("3729"),a=n("1310"),r="[object Symbol]";function s(e){return"symbol"==typeof e||a(e)&&i(e)==r}e.exports=s}}]);