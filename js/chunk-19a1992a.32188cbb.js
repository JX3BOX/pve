(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19a1992a"],{2604:function(e,t,i){"use strict";i("c060")},2709:function(e,t,i){},c060:function(e,t,i){},c576:function(e,t,i){"use strict";i.r(t);i("498a");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-pkg p-pkg-list"},[t("div",{staticClass:"m-pkg-toolbar w-filter-box"},[t("div",{staticClass:"m-pkg-toolbar__search"},[t("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:e.loadData},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadData.apply(null,arguments)}},model:{value:e.params._search,callback:function(t){e.$set(e.params,"_search","string"===typeof t?t.trim():t)},expression:"params._search"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("i",{staticClass:"el-icon-search"}),e._v(" 关键词")]),t("el-button",{attrs:{slot:"append",icon:"el-icon-position"},slot:"append"})],1)],1),t("div",{staticClass:"m-pkg-toolbar__filter m-conditions"},[t("clientBy",{model:{value:e.params.client,callback:function(t){e.$set(e.params,"client",t)},expression:"params.client"}}),t("div",{staticClass:"u-condition u-map u-author"},[t("span",{staticClass:"u-prepend el-input-group__prepend"},[e._v("类型")]),t("el-select",{attrs:{"popper-class":"u-author-pop",filterable:"",placeholder:"类型",size:"small",clearable:""},model:{value:e.params.type,callback:function(t){e.$set(e.params,"type",t)},expression:"params.type"}},e._l(e.pkg_types,(function(e,i){return t("el-option",{key:i,attrs:{label:e,value:i}})})),1)],1),t("el-checkbox",{staticClass:"u-only u-checkbox",attrs:{label:"只看云数据","true-label":0,"false-label":1,border:"",size:"small"},model:{value:e.params.is_raw,callback:function(t){e.$set(e.params,"is_raw",t)},expression:"params.is_raw"}}),t("topicBy",{attrs:{topics:e.pkg_tag,label:"标签"},model:{value:e.params._tag,callback:function(t){e.$set(e.params,"_tag",t)},expression:"params._tag"}}),e.data&&e.data.length?t("pkg-batch",{attrs:{data:e.data,selecting:e.selecting},on:{"update:selecting":function(t){e.selecting=t}}}):e._e()],1)]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"m-pkg-main w-filter-list"},[e.data&&e.data.length?[t("pkg-list",{attrs:{data:e.data,selecting:e.selecting},on:{update:e.onUpdate}}),t("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.per,"page-sizes":[15,30,60,100],total:e.total,"current-page":e.page},on:{"update:pageSize":function(t){e.per=t},"update:page-size":function(t){e.per=t},"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})]:t("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}})],2)])},n=[],s=i("c7eb"),c=i("1da1"),r=i("5530"),l=(i("a630"),i("a15b"),i("d81d"),i("14d9"),i("e9f5"),i("7d54"),i("ab43"),i("b64b"),i("d3b7"),i("3ca3"),i("159b"),i("c9d2")),o=i("dd42"),u=i("cc9a"),d=i("1f7f"),p=i("c375"),g=i("480d"),f=i("df0b"),m=i("9449"),h=(i("99af"),i("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-pkg-batch"},[t("el-switch",{attrs:{"active-color":"#13ce66","active-text":"选择模式"},model:{value:e.selectingModel,callback:function(t){e.selectingModel=t},expression:"selectingModel"}}),e.selectingModel?t("span",{staticClass:"u-count"},[e._v("("+e._s(e.dataSelectCount)+"/"+e._s(e.cloudData.length)+")")]):e._e(),e.selectingModel?t("el-checkbox",{staticClass:"u-check-all",attrs:{label:"全选",border:"",size:"mini"},on:{change:e.checkSwitch},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}}):e._e(),t("el-button",{attrs:{type:"primary",icon:"el-icon-setting",size:"mini"},on:{click:e.open}},[e._v(" 批量构建 ")]),t("el-drawer",{attrs:{title:"数据包批量构建",visible:e.visible,"append-to-body":"",size:"50%","custom-class":"m-pkg-batch__drawer","close-on-press-escape":!1,"wrapper-closable":!1,"show-close":!1},on:{"update:visible":function(t){e.visible=t}}},[t("div",{staticClass:"m-pkg-batch-details"},[t("div",{staticClass:"u-recipe-select"},[t("el-select",{attrs:{placeholder:"请选择批量构建方案",size:"small",clearable:"","popper-class":"m-recipe-select__popper"},on:{change:e.onRecipeSelect},model:{value:e.recipe_id,callback:function(t){e.recipe_id=t},expression:"recipe_id"}},e._l(e.recipes,(function(i,a){return t("el-option",{key:a,staticClass:"u-recipe-item",attrs:{label:i.name,value:i.id}},[t("span",[e._v(e._s(i.name))]),t("el-button",{attrs:{icon:"el-icon-delete",type:"text"},on:{click:function(t){return t.stopPropagation(),e.onRecipeDelete(i.id)}}})],1)})),1)],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"u-build-table"},[t("table",[t("thead",[t("tr",[e.building?t("th",{staticClass:"u-progress-td"}):e._e(),e.building?e._e():t("th",{staticClass:"u-op-column"},[e._v("操作")]),t("th",[e._v("数据包")]),t("th",{staticClass:"u-version-column"},[e._v("当前版本")]),t("th",{staticClass:"u-version-column"},[e._v("新版本名")]),t("th",{staticClass:"u-version-column"},[e._v("备注")]),e.building?t("th",{staticClass:"u-message-column"},[e._v("构建状态")]):e._e()])]),t("draggable",{attrs:{handle:".u-drag-arrow",tag:"tbody",animation:"200"},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:e.buildList,callback:function(t){e.buildList=t},expression:"buildList"}},e._l(e.buildList,(function(i,a){return t("tr",{key:a},[e.building?t("td",{staticClass:"u-progress-td"},[t("div",{key:"progress-".concat(a),staticClass:"u-build-progress__wrapper"},[t("div",{staticClass:"u-build-progress__inner",class:"is-".concat(i.status),style:e.progressStyle(i)})])]):e._e(),e.building?e._e():t("td",[t("div",{staticClass:"u-table-ops"},[t("i",{staticClass:"u-drag-arrow el-icon-rank"}),t("el-button",{staticClass:"u-btn-top",attrs:{icon:"el-icon-download",type:"text"},on:{click:function(t){return e.pkgToTop(a)}}}),t("el-button",{staticClass:"u-btn-bottom",attrs:{icon:"el-icon-download",type:"text"},on:{click:function(t){return e.pkgToTop(a,!0)}}}),t("el-button",{staticClass:"u-btn-close",attrs:{icon:"el-icon-close",type:"text"},on:{click:function(t){return e.removePkg(a)}}})],1)]),t("td",[t("el-tooltip",{attrs:{placement:"top",effect:"dark",content:"#".concat(i.id,"：").concat(i.title)}},[t("a",{attrs:{href:"/dbm/pkg/".concat(i.id,"/raw"),target:"_blank"}},[t("span",[e._v(e._s(i.key))])])])],1),t("td",[e._v(e._s(i.current))]),t("td",[e.building?t("span",[e._v(e._s(i.target))]):t("el-input",{attrs:{size:"mini",placeholder:"新版本名"},model:{value:i.target,callback:function(t){e.$set(i,"target",t)},expression:"pkg.target"}})],1),t("td",[e.building?t("span",[e._v(e._s(i.commit))]):t("el-input",{attrs:{size:"mini",placeholder:"新版本名"},model:{value:i.commit,callback:function(t){e.$set(i,"commit",t)},expression:"pkg.commit"}})],1),e.building?t("td",{staticClass:"u-message-column"},[e._v(e._s(i.message))]):e._e()])})),0)],1)]),e.building?e._e():t("div",{staticClass:"u-build-options"},[t("el-checkbox",{model:{value:e.updateModules,callback:function(t){e.updateModules=t},expression:"updateModules"}},[e._v("同步依赖包至最新版")])],1),t("div",{staticClass:"u-build-buttons"},[e.build_success?t("div",{staticClass:"u-build-buttons__confirm"},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-check"},on:{click:e.onConfirm}},[e._v("构建结束")])],1):e._e(),e.building?e._e():t("div",{staticClass:"u-build-buttons__left"},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:e.onRecipeSave}},[e._v("保存为新方案")]),this.recipe&&this.recipe_id===this.last_recipe_id?t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.onRecipeUpdate}},[e._v(" 更新方案 ")]):e._e()],1),e.building?e._e():t("el-button",{attrs:{plain:"",size:"small"},on:{click:e.cancel}},[e._v("取消")]),e.building?e._e():t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.start}},[e._v("开始构建")])],1)])])],1)}),b=[],v=i("2909"),_=i("b85c"),k=(i("4de4"),i("7db0"),i("fb6a"),i("a434"),i("d866"),i("910d"),i("f665"),i("a9e3"),i("ac1f"),i("00b4"),i("2ca0"),i("ddb0"),i("2f62")),y=i("b76a"),x=i.n(y),w=i("41cb"),j=function(){return Object(w["a"])().get("/api/cms/dbm/build/recipe")},O=function(e){return Object(w["a"])().post("/api/cms/dbm/build/recipe",e)},C=function(e,t){return Object(w["a"])().put("/api/cms/dbm/build/recipe/".concat(e),t)},B=function(e){return Object(w["a"])().delete("/api/cms/dbm/build/recipe/".concat(e))},L=i("d4e7"),D=i("5a0c"),P=i.n(D),M=i("2ef0"),E=i.n(M),$={name:"PkgBatch",props:["selecting","data"],components:{draggable:x.a},data:function(){return{loading:!1,building:!1,build_success:!1,visible:!1,checkAll:!1,progress:0,recipes:[],recipe_id:null,last_recipe_id:null,updateModules:!0,drag:!1,buildList:[]}},computed:Object(r["a"])(Object(r["a"])({},Object(k["d"])({selected:function(e){return e.pkg_selected}})),{},{selectingModel:{get:function(){return this.selecting},set:function(e){this.$emit("update:selecting",e)}},cloudData:function(){return this.data.filter((function(e){return!e.is_raw}))},dataSelectCount:function(){var e=this;return this.cloudData.filter((function(t){return e.selected.find((function(e){return e.id===t.id}))})).length},outputRecipe:function(){return this.buildList.map((function(e){return e.id}))},recipe:function(){var e=this;return this.recipes.find((function(t){return t.id===e.recipe_id}))}}),methods:{open:function(){this.visible=!0,!this.buildList.length&&this.selected.length&&this.initBuildList()},onConfirm:function(){this.build_success=!1,this.building=!1,this.buildList=[],this.$store.commit("REMOVE_PKG_SELECT",this.selected.map((function(e){return e.id}))),this.visible=!1},start:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var i,a,n,c,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.buildList.length){t.next=3;break}return e.$message({message:"请添加构建数据包",type:"warning"}),t.abrupt("return");case 3:e.building=!0,t.prev=4,i=new L["a"],e,a={},n=Object(_["a"])(e.buildList),t.prev=9,r=Object(s["a"])().mark((function t(){var n,r,l,o,u,p,g,f,m,h,b,v,k,y,x,w,j,O,C,B,L,D,P;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=c.value,l=r.pkg,o=[],e.updateBuildProgress(r,0,{status:"building"}),!l.pkg_module.length||!e.updateModules){t.next=14;break}return e.updateBuildProgress(r,0,{message:"更新依赖项"}),t.next=8,Object(d["c"])(r.id,l.pkg_module.map((function(e){return{id:e.module_id}})));case 8:return e.updateBuildProgress(r,10,{message:"依赖更新成功"}),t.next=11,Object(d["k"])(r.id);case 11:u=t.sent,p=u.data.data,l.pkg_module=p;case 14:if(!l.pkg_module.length){t.next=49;break}e.updateBuildProgress(r,10,{message:"获取依赖包"}),g=0,f=100/l.pkg_module.length,m=Object(_["a"])(l.pkg_module),t.prev=19,m.s();case 21:if((h=m.n()).done){t.next=41;break}if(b=h.value,!a[b.module_id]||!e.updateModules){t.next=27;break}b.raw=a[b.module_id],t.next=37;break;case 27:return v=b.record.file,t.next=30,Object(d["h"])(v).catch((function(e){return console.log(e)}));case 30:if(t.t0=t.sent,t.t0){t.next=33;break}t.t0={};case 33:k=t.t0,y=k.data,b.raw=y,o.push(y);case 37:g+=f,e.updateBuildProgress(r,10+g/100*30);case 39:t.next=21;break;case 41:t.next=46;break;case 43:t.prev=43,t.t1=t["catch"](19),m.e(t.t1);case 46:return t.prev=46,m.f(),t.finish(46);case 49:return e.updateBuildProgress(r,40,{message:"获取元数据"}),t.next=52,Object(d["r"])(r.id);case 52:return x=t.sent,w=x.data,e.updateBuildProgress(r,50,{message:"获取成功，共".concat(w.length,"项")}),t.next=57,new Promise((function(t,a){i.onmessage=function(i){var a=i.data,n=a.type,s=a.data;if("progress"===n){var c=s.progress;e.updateBuildProgress(r,50+(c-40)/40*30)}else"result"===n&&t(s)},e.updateBuildProgress(r,50,{message:"准备工作完成，构建中..."}),i.postMessage({cmd:"build",data:{pkg:l,items:w,modules:l.pkg_module}},o)}));case 57:if(j=t.sent,O=j.buffer,C=j.invalid_items,a[l.id]=O,e.updateBuildProgress(r,80,{message:"构建成功，上传构建结果..."}),!(C.length>0)){t.next=64;break}return t.next=64,Object(d["D"])(l.id,C);case 64:return B=new FormData,B.append("jx3dat",new Blob([O],{type:"application/octet-stream"})),B.append("version",r.target),t.next=69,Object(d["L"])(B).catch((function(t){throw e.updateBuildProgress(r,0,{message:"上传失败，流程终止，请检查网络环境或者重新登录..."}),e.build_success=!1,t}));case 69:return L=t.sent,e.updateBuildProgress(r,90,{message:"上传成功，自动发版..."}),D=null!==(n=null===L||void 0===L?void 0:L.data)&&void 0!==n?n:{},P=D.download_url,j.file=P,t.next=75,e.updatePkg(r,j);case 75:e.updateBuildProgress(r,100,{status:"success",message:"构建成功"});case 76:case"end":return t.stop()}}),t,null,[[19,43,46,49]])})),n.s();case 12:if((c=n.n()).done){t.next=16;break}return t.delegateYield(r(),"t0",14);case 14:t.next=12;break;case 16:t.next=21;break;case 18:t.prev=18,t.t1=t["catch"](9),n.e(t.t1);case 21:return t.prev=21,n.f(),t.finish(21);case 24:e.build_success=!0,t.next=30;break;case 27:t.prev=27,t.t2=t["catch"](4),console.log(t.t2);case 30:case"end":return t.stop()}}),t,null,[[4,27],[9,18,21,24]])})))()},updatePkg:function(e,t){var i=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var n,c,r,l,o,u,p;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e.pkg,c=E.a.pick(n,["name","client","lang","status","title","notice","desc","comment","comment_visible","allow_gift","pkg_tag","pkg_meta","pkg_tag","is_raw","modules","remark","type"]),r=t.file,l=t.total_items,o=t.items_snapshot,c.version=String(e.target),c.commit=e.commit,c.items=o,c.file=r,c.total_items=l,u=n.pkg_module.filter((function(e){return!e.record||!e.module})),!u.length){a.next=12;break}return a.next=12,Object(d["E"])(n.id,u.map((function(e){return e.module_id})).join(","));case 12:return p=n.pkg_module.filter((function(e){return e.record})),c.total_modules=p.length,c.modules=p,a.next=17,Object(d["J"])(n.id,c,{build:1});case 17:i.updateBuildProgress(e,100,{status:"success",message:"构建成功"});case 18:case"end":return a.stop()}}),a)})))()},updateBuildProgress:function(e,t){var i=arguments;return Object(c["a"])(Object(s["a"])().mark((function a(){var n,c,r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=i.length>2&&void 0!==i[2]?i[2]:{},c=n.status,r=n.message,void 0!==t&&(e.progress=t),c&&(e.status=c),r&&(e.message=r);case 4:case"end":return a.stop()}}),a)})))()},cancel:function(){this.visible=!1},initBuildList:function(){var e=this,t=this.recipe?this.recipe.recipe:this.selected.filter((function(e){return!e.is_raw})).map((function(e){return e.id}));t&&(this.loading=!0,Object(d["i"])(t.join(",")).then((function(i){var a=i.data.data,n=P()().format("YYYY-MM-DD HH:mm:ss 改动");e.buildList=t.map((function(t){var i=a.find((function(e){return e.id===t}));if(i){var s;e.selected.find((function(e){return e.id===t}))||e.selected.push(i);var c=(null===(s=i.pkg_record[0])||void 0===s?void 0:s.version)||0;return{pkg:i,id:i.id,title:i.title,key:i.key,current:c,target:c?e.nextVersion(c):P()().format("YYMMDDHHmm"),commit:n,progress:0,status:"success",message:""}}return null})).filter((function(e){return e}));var s=e.selected.map((function(e){return e.id}));e.$store.commit("REMOVE_PKG_SELECT",s.filter((function(t){return!e.buildList.find((function(e){return e.id===t}))})))})).finally((function(){e.loading=!1})))},nextVersion:function(e){var t=e.startsWith("v")?e.slice(1):e;if(/2\d{5,}/.test(t)&&t.length%2===0&&(t=6===t.length?P()().format("YYMMDD"):8===t.length?P()().format("YYMMDDHH"):10===t.length?P()().format("YYMMDDHHmm"):null,t))return e.startsWith("v")?"v".concat(t):t;if(/^v?(\d+\.)+\d+$/.test(e)){var i=e.split(".");return i[i.length-1]=Number(i[i.length-1])+1,i.join(".")}return/^\d+$/.test(e)?Number(e)+1:""},checkSwitch:function(){var e=this,t=this.cloudData.every((function(t){return e.selected.find((function(e){return e.id===t.id}))}));if(t){var i=this.cloudData.map((function(e){return e.id}));this.$store.commit("REMOVE_PKG_SELECT",i)}else{var a,n=this.cloudData.filter((function(t){return!e.selected.find((function(e){return e.id===t.id}))}));(a=this.selected).push.apply(a,Object(v["a"])(n))}this.checkAll=!t},pkgToTop:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){if(e<this.buildList.length-1){var i=this.buildList.splice(e,1)[0];this.buildList.push(i)}}else if(e>0){var a=this.buildList.splice(e,1)[0];this.buildList.unshift(a)}},removePkg:function(e){var t=this.buildList[e];this.$store.commit("REMOVE_PKG_SELECT",[t.id]),this.buildList.splice(e,1)},loadRecipes:function(){var e=this;j().then((function(t){e.recipes=t.data.data}))},onRecipeSave:function(){var e=this;this.$prompt("请输入方案名称","添加方案",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S+/,inputErrorMessage:"方案名称不能为空"}).then((function(t){var i=t.value;O({name:i,recipe:e.outputRecipe}).then((function(t){e.recipes.push(t.data.data),e.$message({message:"方案创建成功",type:"success"})}))})).catch((function(){}))},onRecipeUpdate:function(){var e=this;this.$confirm("确定更新该方案吗？","更新方案",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){C(e.recipe_id,e.outputRecipe).then((function(){var t=e.recipes.find((function(t){return t.id===e.recipe_id}));t.recipe=e.outputRecipe,e.$message({message:"方案更新成功",type:"success"})}))})).catch((function(){}))},onRecipeDelete:function(e){var t=this;this.$confirm("确定删除该方案吗？","删除方案",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){B(e).then((function(){t.recipes=t.recipes.filter((function(t){return t.id!==e})),t.recipe_id===e&&(t.recipe_id=null),t.$message({message:"方案删除成功",type:"success"})}))})).catch((function(){}))},onRecipeSelect:function(){var e=this;this.buildList.length?this.$confirm("切换方案将重置当前已调配好的构建顺序，是否清空？","切换方案",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.buildList=[],e.initBuildList(),e.last_recipe_id=e.recipe_id})).catch((function(){e.recipe_id=e.last_recipe_id})):(this.initBuildList(),this.last_recipe_id=this.recipe_id)},progressStyle:function(e){var t=e.progress;return{width:"".concat(t,"%")}}},watch:{selected:function(){var e=this;this.checkAll=this.cloudData.every((function(t){return e.selected.find((function(e){return e.id===t.id}))}))},data:function(){var e=this;this.checkAll=this.cloudData.every((function(t){return e.selected.find((function(e){return e.id===t.id}))}))}},mounted:function(){this.loadRecipes()}},T=$,R=(i("cfcc"),i("2877")),S=Object(R["a"])(T,h,b,!1,null,null,null),z=S.exports,Y=["is_jx3box","_star","_tag"],A={name:"List",props:[],components:{"pkg-list":g["a"],topicBy:f["a"],clientBy:m["a"],PkgBatch:z},data:function(){return{selecting:!1,loading:!1,params:{_search:"",_tag:"",client:"",is_raw:1,type:""},data:[],page:1,total:1,per:15,isLogin:l["a"].isLogin(),pkg_tag:[],pkg_types:p["pkg_types"]}},computed:{reset_params:function(){var e=this.params,t=e._search,i=e._tag,a=e.client;return[t,i,a]},page_options:function(){return[this.per,this.page]},query:function(){var e=Object(o["a"])(Object(r["a"])({},this.params));return Y.forEach((function(t){!e[t]&&delete e[t]})),"all"==e.client&&delete e.client,1==e.is_raw&&delete e.is_raw,e}},watch:{page_options:{deep:!0,handler:function(e,t){this.loadData()}},query:{deep:!0,handler:function(e,t){this.loadData()}},reset_params:{deep:!0,handler:function(){this.page=1}}},mounted:function(){var e=this;this.params.client=this.$store.state.client,this.loadTags(),this.loadData();var t=this.$route.query;Object.keys(t).forEach((function(i){i in e.params&&(e.params[i]=t[i])}))},methods:{loadData:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var i,a,n,c,l,o;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(d["o"])(Object(r["a"])(Object(r["a"])({},e.query),{},{page:e.page,per:e.per}));case 3:return n=t.sent,c=(null===(i=n.data.data)||void 0===i?void 0:i.list)||[],e.total=(null===(a=n.data.data)||void 0===a?void 0:a.total)||0,l=c.map((function(e){return e.id})).join(","),t.next=9,Object(d["t"])(l);case 9:o=t.sent,c.forEach((function(t){var i,a,n=(null===(i=o.data.data)||void 0===i||null===(a=i[t.id])||void 0===a?void 0:a.days)||Array.from({length:31},(function(){return 0}));e.$set(t,"trend",n)})),e.data=c,e.loading=!1;case 13:case"end":return t.stop()}}),t)})))()},toBuild:function(){this.$router.push({name:"pkg_create"})},loadTags:function(){var e=this;try{var t=sessionStorage.getItem("dbm_tags");t?this.pkg_tag=t.split(","):Object(u["a"])("dbm_tags").then((function(t){sessionStorage.setItem("dbm_tags",t),e.pkg_tag=t.split(",")}))}catch(i){console.log(i),this.pkg_tag=[]}},onClientChange:function(e){var t=e.val;this.params.client=t},onUpdate:function(){this.loadData()}}},H=A,V=(i("2604"),Object(R["a"])(H,a,n,!1,null,null,null));t["default"]=V.exports},cfcc:function(e,t,i){"use strict";i("2709")},d866:function(e,t,i){"use strict";var a=i("23e7"),n=i("c65b"),s=i("2266"),c=i("59ed"),r=i("825a"),l=i("46c4"),o=i("2a62"),u=i("f99f"),d=u("every",TypeError);a({target:"Iterator",proto:!0,real:!0,forced:d},{every:function(e){r(this);try{c(e)}catch(a){o(this,"throw",a)}if(d)return n(d,this,e);var t=l(this),i=0;return!s(t,(function(t,a){if(!e(t,i++))return a()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}}]);